<!doctype html><html lang=ko-kr>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Golang의 Concurrent pattern 중 하나로서 Channel을 바탕으로 커뮤니케이션하며 작업을 진행하는 패턴인
Pipeline pattern에 대해 간략해 소개해봤고, 언제 사용해야할지 그 use case에 대해 알아보았습니다. 
"><title>Go의 Pipeline pattern. 언제 사용해야할까? - Golang concurrent patterns</title>
<link rel=canonical href=https://umi0410.github.io/blog/golang/go-concurrent-pattern-pipeline/>
<link rel=stylesheet href=/scss/style.min.css><meta property="og:title" content="Go의 Pipeline pattern. 언제 사용해야할까? - Golang concurrent patterns">
<meta property="og:description" content="Golang의 Concurrent pattern 중 하나로서 Channel을 바탕으로 커뮤니케이션하며 작업을 진행하는 패턴인
Pipeline pattern에 대해 간략해 소개해봤고, 언제 사용해야할지 그 use case에 대해 알아보았습니다. 
">
<meta property="og:url" content="https://umi0410.github.io/blog/golang/go-concurrent-pattern-pipeline/">
<meta property="og:site_name" content="Jinsu Playground">
<meta property="og:type" content="article"><meta property="article:section" content="Blog"><meta property="article:published_time" content="2021-01-11T12:46:54+09:00"><meta property="article:modified_time" content="2021-01-11T12:46:54+09:00"><meta property="og:image" content="https://umi0410.github.io/blog/golang/go-concurrent-pattern-pipeline/illustration.png">
<meta name=twitter:title content="Go의 Pipeline pattern. 언제 사용해야할까? - Golang concurrent patterns">
<meta name=twitter:description content="Golang의 Concurrent pattern 중 하나로서 Channel을 바탕으로 커뮤니케이션하며 작업을 진행하는 패턴인
Pipeline pattern에 대해 간략해 소개해봤고, 언제 사용해야할지 그 use case에 대해 알아보았습니다. 
"><meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://umi0410.github.io/blog/golang/go-concurrent-pattern-pipeline/illustration.png">
<link rel="shortcut icon" href=https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/google/241/whale_1f40b.png>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-177403492-1','auto'),ga('send','pageview'))</script>
<link rel=preconnect href=https://fonts.googleapis.com>
<link rel=preconnect href=https://fonts.gstatic.com crossorigin>
<link href="https://fonts.googleapis.com/css2?family=East+Sea+Dokdo&family=Noto+Sans+KR:wght@400&display=swap" rel=stylesheet>
<style>:root{--body-background:#fafeff;--base-font-family:'Noto Sans KR', sans-serif}.site-name{--site-name-font-family:'East Sea Dokdo', cursive;font-family:var(--site-name-font-family);font-size:3.2rem!important}.left-sidebar{--sidebar-avatar-size:200px}figure.site-avatar{margin-left:auto!important;margin-right:auto!important}</style>
</head>
<body class="article-page has-toc">
<script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex
extended">
<div id=article-toolbar>
<a href=https://umi0410.github.io class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg>
<span>Back</span>
</a>
</div>
<main class="main full-width">
<article class="has-image main-article">
<header class=article-header>
<div class=article-image>
<a href=/blog/golang/go-concurrent-pattern-pipeline/>
<img src=/blog/golang/go-concurrent-pattern-pipeline/illustration_hu58467cd983dc70e6751a1d8a840dc2b9_64082_800x0_resize_box_3.png srcset="/blog/golang/go-concurrent-pattern-pipeline/illustration_hu58467cd983dc70e6751a1d8a840dc2b9_64082_800x0_resize_box_3.png 800w, /blog/golang/go-concurrent-pattern-pipeline/illustration_hu58467cd983dc70e6751a1d8a840dc2b9_64082_1600x0_resize_box_3.png 1600w" width=800 height=272 loading=lazy alt="Featured image of post Go의 Pipeline pattern. 언제 사용해야할까? - Golang concurrent patterns">
</a>
</div>
<div class=article-details>
<header class=article-category>
<a href=/categories/golang/>
Golang (Go 언어)
</a>
</header>
<h2 class=article-title>
<a href=/blog/golang/go-concurrent-pattern-pipeline/>Go의 Pipeline pattern. 언제 사용해야할까? - Golang concurrent patterns</a>
</h2>
<h3 class=article-subtitle>
Golang의 Concurrent pattern 중 하나로서 Channel을 바탕으로 커뮤니케이션하며 작업을 진행하는 패턴인
Pipeline pattern에 대해 간략해 소개해봤고, 언제 사용해야할지 그 use case에 대해 알아보았습니다.
</h3>
<footer class=article-time><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--published>Jan 11, 2021</time>
</footer></div>
</header>
<section class=article-content>
<h2 id=-시작하며>✋ 시작하며</h2>
<p><code>Go</code>를 공부하기 시작한 지도 벌써 몇 달이 지난 것 같다. 데브옵스 인턴을 마치면서 특히나 관심있었던 Go를 공부하기 시작했었고, 지난 몇 달간 AWS KRUG내의 소모임인 AUSG의 스터디 활동으로 Go를 주제로 공부해왔다. Golang의 꽃이라고 할 수 있는 요소들이 몇 개 있었는데 나는 그 중 <code>goroutine</code>과 <code>channel</code>에서 매력을 느꼈고 그를 바탕으로한 <code>concurrency pattern</code>들에 대해 이래 저래 많이 알아봐왔다.</p>
<p>하지만 concurrency pattern이 뭐고, 어떻게 사용하는지에 대해서는 여러 글을 찾아볼 수 있었지만 이게 왜 좋고 언제 쓰면 좋을지에 대한 내용은 찾아보기 힘들었다. 항상 어떤 기술을 접할 때 &ldquo;<em>왜 좋은데?</em>&ldquo;와 &ldquo;<em>언제 쓰면 좋은데?</em>&ldquo;를 많이 따지는 편이라서 늘 궁금증에 남아있었다.</p>
<p>그러던 중 얼마 전 나의 궁금증을 해소시켜주는 간단한 댓글을 보게 되었고, 그를 바탕으로 몇 가지 서치를 해본 결과 concurrency pattern 중 하나인 <code>pipeline pattern</code>을 언제 쓰면 좋을지 알아보았다.</p>
<h2 id=-pipeline-pattern이란>❓ Pipeline pattern이란?</h2>
<p><figure style=flex-grow:294;flex-basis:706px>
<a href=/blog/golang/go-concurrent-pattern-pipeline/illustration.png data-size=866x294><img src=/blog/golang/go-concurrent-pattern-pipeline/illustration.png srcset="/blog/golang/go-concurrent-pattern-pipeline/illustration_hu58467cd983dc70e6751a1d8a840dc2b9_64082_480x0_resize_box_3.png 480w, /blog/golang/go-concurrent-pattern-pipeline/illustration_hu58467cd983dc70e6751a1d8a840dc2b9_64082_1024x0_resize_box_3.png 1024w" width=866 height=294 loading=lazy alt=illustration.png>
</a>
<figcaption>illustration.png</figcaption>
</figure></p>
<p>Pipeline pattern은 golang의 Concurrency pattern 중 하나이다. 쉽게 말하자면 함수의 인자에 값을 전달해 작업하는 것이 아니라 <code>channel</code> 을 통해 실시간으로 <strong>함수(혹은 goroutine)들끼리 커뮤니케이션을 하며 작업을 진행</strong>하는 것이다. 실시간으로 함수들끼리 커뮤니케이션하며 data를 전송하기 때문에 data streaming 같은 느낌이라고 볼 수 있겠다.</p>
<p>일반적으로는 한 함수에서 작업이 모두 끝난 뒤 그 결과값을 리턴하고, 또 다시 그 결과 값을 인풋으로 어떤 함수가 작업을 하고 해당 작업이 모두 끝난 뒤 또 다른 결과값을 리턴하는 형태로 진행이 된다. 하지만 Pipeline pattern에서는 한 작업이 모두 완료되지 않았다하더라도 해당 작업의 부분 부분의 데이터를 담는 channel을 리턴하고, 다른 작업은 해당 channel을 인풋으로 하여 부분 부분의 데이터를 channel에서 꺼내 바로 바로 작업한다.</p>
<p><figure style=flex-grow:337;flex-basis:810px>
<a href=/blog/golang/go-concurrent-pattern-pipeline/python-generator.png data-size=1081x320><img src=/blog/golang/go-concurrent-pattern-pipeline/python-generator.png srcset="/blog/golang/go-concurrent-pattern-pipeline/python-generator_hu23ac500000a895e8df8d33d9e9dcd7af_62761_480x0_resize_box_3.png 480w, /blog/golang/go-concurrent-pattern-pipeline/python-generator_hu23ac500000a895e8df8d33d9e9dcd7af_62761_1024x0_resize_box_3.png 1024w" width=1081 height=320 loading=lazy alt=python-generator.png>
</a>
<figcaption>python-generator.png</figcaption>
</figure></p>
<p><em>generator을 이용한 lazy evaluation. 0, 1, 2를 모두 Insert한 뒤 square and print 하는 것이 아닌 하나씩 실시간으로 진행</em></p>
<p>이는 마치 <strong>Python의 <code>Generator</code>을 통한 <code>Lazy evaluation</code>을 이용할 때와 유사</strong>하게 볼 수는 있겠다. 하지만 많은 차이점이 존재하긴 할텐데 우선 generator는 thread-safe하지 않은(<a class=link href=https://stackoverflow.com/questions/1131430/are-generators-threadsafe target=_blank rel=noopener>stackoverflow 참고</a>) 반면 channel은 여러 goroutine에서 한 channel에 접근해도 thread-safe하다. &lsquo;thread-safe한가&rsquo;가 중요한 이유는 후에 잠깐 소개할 <code>fan-in fan-out pattern</code>이 바로 pipeline pattern이 여러 goroutine에서 이루어지는 경우이기 때문이다.</p>
<p>(<em>사실 내가 Pipeline pattern을 어디에 사용할 지 몰랐던 이유는 Lazy evaluation과 같은 개념이 없었기 때문이 아닐까싶기도 하다.</em>)</p>
<h3 id=pipeline-pattern의-흔한-예시로-square-하는-예제를-설명하는-글들>Pipeline pattern의 흔한 예시로 square 하는 예제를 설명하는 글들</h3>
<p>종종 Pipeline pattern의 예시를 알아보면서 square 작업을 하는 예제들을 몇 개 봤던 것 같은데, 그 중 참고할 수 있는 예시들을 제시해본다. square 작업이 pipeline pattern에 효율적이라기보다는 그냥 임의의 예시라고 생각한다.</p>
<p>이 글은 Pipeline pattern을 언제 사용하면 좋을지에 초점을 맞추었기에 Pipeline pattern이 뭔지, 그 사용법은 어떻게 되는지 등의 내용을 모르는 상태라면 아래 글들을 추천한다. (특히 Aidan Bae님의 블로그에는 pipeline pattern 외에도 다양한 Go 관련 내용을 잘 적혀있다.)</p>
<ul>
<li>Aidan Bae님의 아주 간단한 Pipeline pattern 예시 - <a class=link href=https://aidanbae.github.io/code/golang-design/pipeline/ target=_blank rel=noopener>https://aidanbae.github.io/code/golang-design/pipeline/</a></li>
<li>GoBlog의 간단한 내용부터 꽤나 어려운 내용까지 들어가는 것 같은데, 내용도 길고 짧은 코드에 억지로 많은 내용을 끼워넣은 느낌.. <a class=link href=https://blog.golang.org/pipelines target=_blank rel=noopener>https://blog.golang.org/pipelines</a></li>
</ul>
<h2 id=-언제-쓰는-게-좋을까>🤔 언제 쓰는 게 좋을까?</h2>
<p>앞선 lazy evaluation 관련된 내용과 <a class=link href=https://www.reddit.com/r/golang/comments/7rjdw6/go_go_go_stream_processing_for_go/ target=_blank rel=noopener>이 글의 댓글</a>(go로 작업을 stream하라는 글에 &ldquo;<em>너 정말 저렇게 stream하는 게 좋다고 생각해? 이 경우 아니면 그닥 잘 모르겠는데?</em>&ldquo;라는 댓글)이 나의 이해를 도와주었다. <a class=link href=https://labs.bawi.io/7-reasons-to-use-pipeline-architecture-93346f604b87 target=_blank rel=noopener>Pipeline architecture를 사용해야하는 7가지 이유라는 글</a>을 읽어보기도 했지만 여기의 내용은 실질적으로 왜 그 장점을 갖는지에 대한 설명이나 논리가 부족했다. (<em><del>다소 Go와 Pipeline pattern에 대한 무조건적 사랑으로 느껴짐..ㅎㅎ&mldr;</del></em>)</p>
<p>내 생각에는 아래 두 가지 경우에 Pipeline pattern을 이용하는 것이 좋을 것 같다.</p>
<ul>
<li><strong>Input 작업을 모두 수행하는 데에 오랜 시간이 걸리는 경우</strong></li>
<li><strong>작업하는 데이터의 양이 너무 커서 Memory를 많이 점유하므로 쪼개서 바로 바로 처리하고 싶은 경우</strong></li>
</ul>
<p>&lsquo;<em>디버깅하기 쉽다</em>&lsquo;거나 &lsquo;<em>코드를 알아보기 쉽다</em>&rsquo; 등등의 글을 보긴했던 것 같은데 개인적으로는 그냥 pipeline과 channel을 안 쓰고 그냥 반복문을 돌리면서 데이터를 통째로 작업하는 게 디버깅이나 가독성면으로 훨씬 유리하다고 생각한다. 즉 Concurrent pattern의 장점은 특정 use case에서의 성능적인 측면이라고 생각한다.</p>
<p>그리고 이건 여담인데 <strong>go의 channel을 통한 data 전달이 일반적으로 빠른 건 절대 아니다.</strong> channel은 우선 <code>thread safe</code>하기때문에 일반적인 작업에서는 <strong>thread-unsafe한 방식보다 느린 것이 당연</strong>하다. 또한 channel은 단순한 lock 기능 외에도 다른 goroutine(혹은 thread 혹은 function) 간의 데이터 전송, channel에 대한 반복, 열었는지 닫았는지에 대한 체크 등등 다양한 기능도 갖고있기때문에 <strong>mutex에 비해서도 훨씬 느린 듯하다</strong>. 그렇기 때문에 위에서 나열했듯 Input 작업이 오래 걸리거나 Memory 점유량을 줄이기 위한 경우에는 channel을 이용한 Pipeline pattern으로 실시간으로 작업하면 유리할 것이라고 생각한 것이다.</p>
<p>그리고 추가적으로 앞에서 <code>Fan-in Fan-out</code> pattern에서는 여러 Goroutine에 대한 Pipeline pattern이 적용된다고했는데, Fan-in Fan-out이란 여러 goroutine이 하나의 channel에 값을 넣거나 빼는 구조를 말한다. 이 구조의 장점은 일반적인 Pipeline Pattern에서 각 단계가 하나의 goroutine만을 이용하는 것이 아니라 여러 goroutine을 이용할 수 있다는 점이다. CPU bound한 작업이 아닌 IO Block이 주요 latency를 차지하는 경우는 Goroutine을 늘려주면 concurrent하게 작업할 수 있기때문에 성능이 좋아지더라. Fan-in Fan-out pattern에 대해서는 기회가 된다면 더 자세히 다뤄보겠다.</p>
<p><strong>참고</strong></p>
<ul>
<li>Mutex보다 channel이 느리다는 벤치마크 글 - <a class=link href=http://www.dogfootlife.com/archives/452 target=_blank rel=noopener>http://www.dogfootlife.com/archives/452</a></li>
<li>Mutex를 쓸 수 있는 상황이면 Mutex를 쓰는 것이 좋을 수도 있다 - <a class=link href=https://github.com/golang/go/wiki/MutexOrChannel target=_blank rel=noopener>https://github.com/golang/go/wiki/MutexOrChannel</a></li>
</ul>
<h2 id=예시-프로그램>예시 프로그램</h2>
<h3 id=프로그램-설명>프로그램 설명</h3>
<p>Input 작업을 수행하는 데에 오랜 시간이 걸리는 경우를 예시로 들기 위해 MySQL에서 Gopher에 대한 데이터를 조회한 뒤 Gopher들의 연령을 +10 증가시키는 예시를 만들어봤다.</p>
<p>Input 작업을 모두 수행하는 데에 오래 걸리고, 작업 내용을 조금씩 쪼갤 수 있다는 전제조건을 위해 DB Query를 할 때 전체를 한 번에 Select 하는 것이 아니라 1개씩 Select하는 다소 비효율적이고 비현실적인 상황을 이용하긴하지만 간단하게 Pipeline pattern의 효율을 극대화시켜보고자했던 이유이므로 양해를 부탁드린다.</p>
<p>예를 들어 Pipeline pattern을 통해 <strong>1000개의 Row를 Query하고 난 뒤 1000개를 Update하는 것이 아니라 1000개의 Row를 Query하면서 1개 1개의 Row를 얻어올 때 마다 바로바로 Update 작업에 Row를 넘겨줘 실시간으로 작업</strong>할 수 있게해주는 것이다.</p>
<ul>
<li>Pipeline pattern: 한 item 씩 실시간으로 전달하며 진행</li>
<li>Sequential pattern: 딱히 Pattern이라기엔 좀 그렇지만 그냥 일반적으로 Sequential하게 진행하는 경우를 의미. 이 예시에선 전체 Query 완료 후 전체 Update하는 방식.</li>
</ul>
<p>Docker를 이용해 간단하게 MySQL 서버를 띄웠고, Gorm을 이용해 DB Query와 update를 수행했다.</p>
<p><strong>예시 프로그램 코드</strong></p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kn>package</span> <span class=nx>main</span>

<span class=kn>import</span> <span class=p>(</span>
	<span class=s>&#34;fmt&#34;</span>
	<span class=s>&#34;github.com/brianvoe/gofakeit/v6&#34;</span>
	<span class=s>&#34;gorm.io/driver/mysql&#34;</span>
	<span class=c1>//&#34;gorm.io/driver/sqlite&#34;
</span><span class=c1></span>	<span class=s>&#34;gorm.io/gorm&#34;</span>
	<span class=s>&#34;gorm.io/gorm/logger&#34;</span>
	<span class=s>&#34;math/rand&#34;</span>
	<span class=s>&#34;time&#34;</span>
<span class=p>)</span>

<span class=kd>var</span> <span class=p>(</span>
	<span class=nx>NumTotalData</span>      <span class=kt>int</span> <span class=p>=</span> <span class=mi>100</span> <span class=c1>// 초기화할 데이터
</span><span class=c1></span>	<span class=nx>NumManipulateData</span> <span class=kt>int</span> <span class=p>=</span> <span class=mi>100</span> <span class=c1>// fetch 후 map을 적용할 데이터 수
</span><span class=c1></span><span class=p>)</span>

<span class=kd>type</span> <span class=nx>Gopher</span> <span class=kd>struct</span> <span class=p>{</span>
	<span class=nx>gorm</span><span class=p>.</span><span class=nx>Model</span>
	<span class=nx>Name</span> <span class=kt>string</span>
	<span class=nx>Age</span>  <span class=kt>int</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>initializeDB</span><span class=p>(</span><span class=nx>db</span> <span class=o>*</span><span class=nx>gorm</span><span class=p>.</span><span class=nx>DB</span><span class=p>)</span> <span class=p>{</span>
	<span class=c1>// Migrate the schema
</span><span class=c1></span>	<span class=nx>db</span><span class=p>.</span><span class=nf>AutoMigrate</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>Gopher</span><span class=p>{})</span>

	<span class=c1>// Create initial data
</span><span class=c1></span>	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nx>NumTotalData</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
		<span class=nx>gopher</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>Gopher</span><span class=p>{</span><span class=nx>Name</span><span class=p>:</span> <span class=nx>gofakeit</span><span class=p>.</span><span class=nf>Name</span><span class=p>(),</span> <span class=nx>Age</span><span class=p>:</span> <span class=nx>rand</span><span class=p>.</span><span class=nf>Intn</span><span class=p>(</span><span class=mi>60</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>}</span>
		<span class=nx>gopher</span><span class=p>.</span><span class=nx>ID</span> <span class=p>=</span> <span class=nb>uint</span><span class=p>(</span><span class=nx>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
		<span class=nx>db</span><span class=p>.</span><span class=nf>Save</span><span class=p>(</span><span class=nx>gopher</span><span class=p>)</span>
	<span class=p>}</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Initialized DB&#34;</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>type</span> <span class=nx>SequentialPattern</span> <span class=kd>struct</span> <span class=p>{</span>
	<span class=nx>DB</span> <span class=o>*</span><span class=nx>gorm</span><span class=p>.</span><span class=nx>DB</span>
<span class=p>}</span>
<span class=kd>type</span> <span class=nx>PipelinePattern</span> <span class=kd>struct</span> <span class=p>{</span>
	<span class=nx>DB</span> <span class=o>*</span><span class=nx>gorm</span><span class=p>.</span><span class=nx>DB</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=p>(</span><span class=nx>sp</span> <span class=o>*</span><span class=nx>SequentialPattern</span><span class=p>)</span> <span class=nf>Execute</span><span class=p>()</span> <span class=p>{</span>
	<span class=nx>start</span> <span class=o>:=</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>()</span>
	<span class=nx>sp</span><span class=p>.</span><span class=nf>Map</span><span class=p>(</span><span class=nx>sp</span><span class=p>.</span><span class=nf>FetchData</span><span class=p>())</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;sequential&#34;</span><span class=p>,</span> <span class=nx>sp</span><span class=p>)</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Elapsed:&#34;</span><span class=p>,</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>().</span><span class=nf>Sub</span><span class=p>(</span><span class=nx>start</span><span class=p>))</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Print</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>().</span><span class=nf>Sub</span><span class=p>(</span><span class=nx>start</span><span class=p>))</span>
	<span class=nx>gophers</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=nx>Gopher</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
	<span class=nx>sp</span><span class=p>.</span><span class=nx>DB</span><span class=p>.</span><span class=nf>Limit</span><span class=p>(</span><span class=nx>NumTotalData</span><span class=p>).</span><span class=nf>Find</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>gophers</span><span class=p>)</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Average age(Num: %d): %d\n&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>gophers</span><span class=p>),</span> <span class=kd>func</span><span class=p>()</span> <span class=kt>int</span><span class=p>{</span>
	  <span class=nx>totalAge</span> <span class=o>:=</span> <span class=mi>0</span>
	  <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>gopher</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>gophers</span><span class=p>{</span>
	      <span class=nx>totalAge</span> <span class=o>+=</span> <span class=nx>gopher</span><span class=p>.</span><span class=nx>Age</span>
	  <span class=p>}</span>
	  <span class=k>return</span> <span class=nx>totalAge</span><span class=o>/</span><span class=nb>len</span><span class=p>(</span><span class=nx>gophers</span><span class=p>)</span>
	<span class=p>}())</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=p>(</span><span class=nx>sp</span> <span class=o>*</span><span class=nx>SequentialPattern</span><span class=p>)</span> <span class=nf>FetchData</span><span class=p>()</span> <span class=p>[]</span><span class=o>*</span><span class=nx>Gopher</span> <span class=p>{</span>
	<span class=nx>gophers</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=o>*</span><span class=nx>Gopher</span><span class=p>,</span> <span class=nx>NumManipulateData</span><span class=p>)</span>
	<span class=k>for</span> <span class=nx>id</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>gophers</span> <span class=p>{</span>
		<span class=nx>gophers</span><span class=p>[</span><span class=nx>id</span><span class=p>]</span> <span class=p>=</span> <span class=o>&amp;</span><span class=nx>Gopher</span><span class=p>{}</span>
		<span class=nx>sp</span><span class=p>.</span><span class=nx>DB</span><span class=p>.</span><span class=nf>Where</span><span class=p>(</span><span class=s>&#34;id &gt; ?&#34;</span><span class=p>,</span> <span class=nx>id</span><span class=p>).</span><span class=nf>Limit</span><span class=p>(</span><span class=mi>1</span><span class=p>).</span><span class=nf>Find</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>gophers</span><span class=p>[</span><span class=nx>id</span><span class=p>])</span>
	<span class=p>}</span>

	<span class=k>return</span> <span class=nx>gophers</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=p>(</span><span class=nx>sp</span> <span class=o>*</span><span class=nx>SequentialPattern</span><span class=p>)</span> <span class=nf>Map</span><span class=p>(</span><span class=nx>gophers</span> <span class=p>[]</span><span class=o>*</span><span class=nx>Gopher</span><span class=p>)</span> <span class=p>{</span>
	<span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>gopher</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>gophers</span> <span class=p>{</span>
		<span class=nx>gopher</span><span class=p>.</span><span class=nx>Age</span> <span class=o>+=</span> <span class=mi>10</span>
		<span class=nx>sp</span><span class=p>.</span><span class=nx>DB</span><span class=p>.</span><span class=nf>Save</span><span class=p>(</span><span class=nx>gopher</span><span class=p>)</span>
	<span class=p>}</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=p>(</span><span class=nx>pp</span> <span class=o>*</span><span class=nx>PipelinePattern</span><span class=p>)</span> <span class=nf>Execute</span><span class=p>()</span> <span class=p>{</span>
	<span class=nx>start</span> <span class=o>:=</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>()</span>

	<span class=nx>pp</span><span class=p>.</span><span class=nf>Map</span><span class=p>(</span><span class=nx>pp</span><span class=p>.</span><span class=nf>FetchData</span><span class=p>())</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;pipeline&#34;</span><span class=p>,</span> <span class=nx>pp</span><span class=p>)</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Elapsed:&#34;</span><span class=p>,</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>().</span><span class=nf>Sub</span><span class=p>(</span><span class=nx>start</span><span class=p>))</span>
	<span class=nx>gophers</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=nx>Gopher</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
	<span class=nx>pp</span><span class=p>.</span><span class=nx>DB</span><span class=p>.</span><span class=nf>Limit</span><span class=p>(</span><span class=nx>NumTotalData</span><span class=p>).</span><span class=nf>Find</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>gophers</span><span class=p>)</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Average age(Num: %d): %d\n&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>gophers</span><span class=p>),</span> <span class=kd>func</span><span class=p>()</span> <span class=kt>int</span><span class=p>{</span>
	   <span class=nx>totalAge</span> <span class=o>:=</span> <span class=mi>0</span>
	   <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>gopher</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>gophers</span><span class=p>{</span>
	       <span class=nx>totalAge</span> <span class=o>+=</span> <span class=nx>gopher</span><span class=p>.</span><span class=nx>Age</span>
	   <span class=p>}</span>
	   <span class=k>return</span> <span class=nx>totalAge</span><span class=o>/</span><span class=nb>len</span><span class=p>(</span><span class=nx>gophers</span><span class=p>)</span>
	<span class=p>}())</span>
<span class=p>}</span>
<span class=kd>func</span> <span class=p>(</span><span class=nx>pp</span> <span class=o>*</span><span class=nx>PipelinePattern</span><span class=p>)</span> <span class=nf>FetchData</span><span class=p>()</span> <span class=o>&lt;-</span><span class=kd>chan</span> <span class=o>*</span><span class=nx>Gopher</span> <span class=p>{</span>
	<span class=nx>ch</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=o>*</span><span class=nx>Gopher</span><span class=p>)</span>
	<span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
		<span class=k>for</span> <span class=nx>id</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>id</span> <span class=p>&lt;</span> <span class=nx>NumManipulateData</span><span class=p>;</span> <span class=nx>id</span><span class=o>++</span> <span class=p>{</span>
			<span class=kd>var</span> <span class=nx>gopher</span> <span class=nx>Gopher</span>
			<span class=nx>pp</span><span class=p>.</span><span class=nx>DB</span><span class=p>.</span><span class=nf>Table</span><span class=p>(</span><span class=s>&#34;gophers&#34;</span><span class=p>).</span><span class=nf>Where</span><span class=p>(</span><span class=s>&#34;id &gt; ?&#34;</span><span class=p>,</span> <span class=nx>id</span><span class=p>).</span><span class=nf>Limit</span><span class=p>(</span><span class=mi>1</span><span class=p>).</span><span class=nf>Find</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>gopher</span><span class=p>)</span>
			<span class=nx>ch</span> <span class=o>&lt;-</span> <span class=o>&amp;</span><span class=nx>gopher</span>
		<span class=p>}</span>
		<span class=nb>close</span><span class=p>(</span><span class=nx>ch</span><span class=p>)</span>
	<span class=p>}()</span>

	<span class=k>return</span> <span class=nx>ch</span>
<span class=p>}</span>

<span class=c1>// 고퍼들을 모두 10살 더 먹게 함.
</span><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>pp</span> <span class=o>*</span><span class=nx>PipelinePattern</span><span class=p>)</span> <span class=nf>Map</span><span class=p>(</span><span class=nx>gophers</span> <span class=o>&lt;-</span><span class=kd>chan</span> <span class=o>*</span><span class=nx>Gopher</span><span class=p>)</span> <span class=p>{</span>
	<span class=k>for</span> <span class=nx>gopher</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>gophers</span> <span class=p>{</span>
		<span class=nx>gopher</span><span class=p>.</span><span class=nx>Age</span> <span class=o>+=</span> <span class=mi>10</span>
		<span class=nx>pp</span><span class=p>.</span><span class=nx>DB</span><span class=p>.</span><span class=nf>Save</span><span class=p>(</span><span class=nx>gopher</span><span class=p>)</span>
	<span class=p>}</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
	<span class=c1>// $ docker run -it --name mysql --rm -e MYSQL_ROOT_PASSWORD=root -e MYSQL_DATABASE=concurrency -p 3306:3306 mysql
</span><span class=c1></span>	<span class=c1>// 로 mysql 서버를 띄울 수 있다.
</span><span class=c1></span>	<span class=nx>db</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>gorm</span><span class=p>.</span><span class=nf>Open</span><span class=p>(</span><span class=nx>mysql</span><span class=p>.</span><span class=nf>Open</span><span class=p>(</span><span class=s>&#34;root:root@tcp(127.0.0.1:3306)/concurrency?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&#34;</span><span class=p>),</span>
		<span class=o>&amp;</span><span class=nx>gorm</span><span class=p>.</span><span class=nx>Config</span><span class=p>{</span><span class=nx>Logger</span><span class=p>:</span> <span class=nx>logger</span><span class=p>.</span><span class=nx>Default</span><span class=p>.</span><span class=nf>LogMode</span><span class=p>(</span><span class=nx>logger</span><span class=p>.</span><span class=nx>Silent</span><span class=p>)})</span>
	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
		<span class=nb>panic</span><span class=p>(</span><span class=s>&#34;failed to connect database&#34;</span><span class=p>)</span>
	<span class=p>}</span>
	<span class=nf>initializeDB</span><span class=p>(</span><span class=nx>db</span><span class=p>)</span>

	<span class=c1>// Execute with PipelinePattern
</span><span class=c1></span>	<span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;==============================&#34;</span><span class=p>)</span>
		<span class=k>for</span> <span class=nx>rep</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>rep</span> <span class=p>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>rep</span><span class=o>++</span> <span class=p>{</span>
			<span class=nx>pattern</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>SequentialPattern</span><span class=p>{</span><span class=nx>DB</span><span class=p>:</span> <span class=nx>db</span><span class=p>}</span>
			<span class=nx>pattern</span><span class=p>.</span><span class=nf>Execute</span><span class=p>()</span>
		<span class=p>}</span>
    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;==============================&#34;</span><span class=p>)</span>
	<span class=p>}()</span>

	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Print</span><span class=p>(</span><span class=s>&#34;DB 부하를 가라앉히기 위해 5초간 휴식&#34;</span><span class=p>)</span>
	<span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>5</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
	<span class=c1>// Execute with PipelinePattern
</span><span class=c1></span>	<span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;==============================&#34;</span><span class=p>)</span>
		<span class=k>for</span> <span class=nx>rep</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>rep</span> <span class=p>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>rep</span><span class=o>++</span> <span class=p>{</span>
			<span class=nx>pattern</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>PipelinePattern</span><span class=p>{</span><span class=nx>DB</span><span class=p>:</span> <span class=nx>db</span><span class=p>}</span>
			<span class=nx>pattern</span><span class=p>.</span><span class=nf>Execute</span><span class=p>()</span>
		<span class=p>}</span>
    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;==============================&#34;</span><span class=p>)</span>
	<span class=p>}()</span>
<span class=p>}</span>
</code></pre></div><h3 id=-벤치마크-결과-비교>📉 벤치마크 결과 비교</h3>
<p><figure style=flex-grow:150;flex-basis:361px>
<a href=/blog/golang/go-concurrent-pattern-pipeline/line-chart-1.png data-size=690x458><img src=/blog/golang/go-concurrent-pattern-pipeline/line-chart-1.png srcset="/blog/golang/go-concurrent-pattern-pipeline/line-chart-1_hu33251dd256e214e8cf3a54828b73b849_33941_480x0_resize_box_3.png 480w, /blog/golang/go-concurrent-pattern-pipeline/line-chart-1_hu33251dd256e214e8cf3a54828b73b849_33941_1024x0_resize_box_3.png 1024w" width=690 height=458 loading=lazy alt=line-chart-1.png>
</a>
<figcaption>line-chart-1.png</figcaption>
</figure></p>
<p>Sequential하게 진행할 경우 모든 Item에 대한 Query가 완료될 때 까지 Update 작업은 <strong>지연</strong>되게 된다. 그리고 Query가 모두 완료되어야 비로소 Update 작업을 시작할 수 있게되므로 좀 더 작업 시간이 오래걸리는 편이다.</p>
<p>반면 <strong>Pipeline</strong>으로 진행할 경우 한 Item을 Query 하자마자 <strong>바로 바로</strong> Upadte 작업이 이루어질 수 있기때문에 작업 시간이 더 짧은 경향이 있다.</p>
<p>하지만 이 정도 차이는 뚜렷한 성능 차이로 보기엔 다소 미미한 것 같았다. 그래서 좀 더 IO latency가 긴 상황을 이용해봤다. DB로 localhost에서 docker mysql server를 이용하는 것이 아니라 운영 중이던 k8s cluster의 mysql pod를 kubectl port forward하여 이용해보았다. (<em>정확히는 모르지만 remote db + kubectl port forawrd 를 이용하는 경우 network latency가 아주 커져 극단적으로 좋은 예시 상황이 될 수 있을 것 같았다.</em>)</p>
<p><figure style=flex-grow:154;flex-basis:369px>
<a href=/blog/golang/go-concurrent-pattern-pipeline/line-chart-2.png data-size=823x534><img src=/blog/golang/go-concurrent-pattern-pipeline/line-chart-2.png srcset="/blog/golang/go-concurrent-pattern-pipeline/line-chart-2_hufd4be17bd74bd8a4b342cf46da06154a_43201_480x0_resize_box_3.png 480w, /blog/golang/go-concurrent-pattern-pipeline/line-chart-2_hufd4be17bd74bd8a4b342cf46da06154a_43201_1024x0_resize_box_3.png 1024w" width=823 height=534 loading=lazy alt=line-chart-2.png>
</a>
<figcaption>line-chart-2.png</figcaption>
</figure></p>
<p>위에서 가정한 remote db + port forward의 극단적 상황은 작업 진행 pattern에 따라 latency를 2배 가량 차이나게 했다.</p>
<p>즉 <strong>한 단계에서 오랜 시간이 소모되어 다음 단계가 지연되는 경우 Pipeline을 이용하면 좋은 것 같다</strong>. <em>이는 마치 컴퓨터 구조에서 MIPS Processor의 Pipeline을 공부할 때와 유사한 듯한 느낌을 줬다.</em></p>
<h2 id=마무리>마무리</h2>
<blockquote>
<p>이 글이 정확한 내용은 아닐 수 있지만 조사해본 선에서 벤치마크 해보며 작성해봤습니다. 혹시 글의 내용 중 잘못된 내용에 대한 피드백을 제시해주신다면 기회가 닿는 한 열심히 다시 알아보겠습니다~!</p>
</blockquote>
<p>평소 궁금했던 &ldquo;<em>Go의 <code>concurrent pattern</code>은 어떨 때 쓰면 좋을까?</em>&rdquo; 라는 의문 중 <code>pipeline pattern</code> 에 대해 이렇게 알아봤다.</p>
<p>Pipeline pattern이 CPU Bound한 작업보다는 IO latency로 인해 오랜 시간이 소모되는 작업에 더 효율적이라고 생각한 이유는 CPU Bound한 작업에서는 CPU가 이미 혹사당하고 있기 때문에 굳이 여러 goroutine을 schedule, switch하거나 channel을 통한 동기처리를 하면서 작업을 진행하기보다는 그냥 일반적인 방식으로 순차적으로 작업을 진행하는 게 좋을 수 있기 때문이다. 워낙에 얼마나 CPU bound한 작업인지, 얼마나 많은 goroutine을 이용하는지 등등 다양한 경우에 따라 달라지기 때문에 딱 잘라말할 수도 없고, 나도 많이 부족하기 때문에 정확히는 모르겠다. 하지만 추측컨대 적어도 io latency로 인해 작업들이 지연되는 경우에는 pipeline pattern이 좋은 듯하다.</p>
<p>추가적으로 <code>Fan-in Fan-out</code> pattern 또한 channel을 바탕으로 data를 전달하면서 작업하기 때문에 일종의 <code>Pipeline</code> pattern이 적용된 패턴인듯하여 기회가 된다면 <strong>어떤 경우에 단순히 Pipeline 패턴을 이용하는 것보다 여러 Goroutine을 이용해 작업하는 Fan-in fan out pattern이 좋을지 비교</strong>해보는 글을 적어보고싶다.</p>
<h2 id=참고>참고</h2>
<ul>
<li>Aidan Bae님의 Pipeline pattern에 대한 소개 - <a class=link href=https://aidanbae.github.io/code/golang-design/pipeline/ target=_blank rel=noopener>https://aidanbae.github.io/code/golang-design/pipeline/</a></li>
<li>Go Blog의 Pipeline pattern에 대한 소개 - <a class=link href=https://blog.golang.org/pipelines target=_blank rel=noopener>https://blog.golang.org/pipelines</a></li>
<li>Pipeline은 ~~~ 이런 상황에 도움이 될 껄?하는 댓글 - <a class=link href=https://www.reddit.com/r/golang/comments/7rjdw6/go_go_go_stream_processing_for_go/ target=_blank rel=noopener>https://www.reddit.com/r/golang/comments/7rjdw6/go_go_go_stream_processing_for_go/</a></li>
<li>Mutex와 Channel 비교 - <a class=link href=https://github.com/golang/go/wiki/MutexOrChannel target=_blank rel=noopener>https://github.com/golang/go/wiki/MutexOrChannel</a></li>
<li>Mutex와 Channel의 속도 차이 - <a class=link href=http://www.dogfootlife.com/archives/452 target=_blank rel=noopener>http://www.dogfootlife.com/archives/452</a></li>
<li>Pipeline architecture를 사용하는 7가지 이유(<del>개인적으론 공감 안 감</del>) - <a class=link href=https://labs.bawi.io/7-reasons-to-use-pipeline-architecture-93346f604b87 target=_blank rel=noopener>https://labs.bawi.io/7-reasons-to-use-pipeline-architecture-93346f604b87</a></li>
<li>python generator 소개, 사용법- <a class=link href=https://wikidocs.net/16069 target=_blank rel=noopener>https://wikidocs.net/16069</a></li>
<li>python generator는 thread-safe하지 않다. - <a class=link href=https://stackoverflow.com/questions/1131430/are-generators-threadsafe target=_blank rel=noopener>https://stackoverflow.com/questions/1131430/are-generators-threadsafe</a></li>
</ul>
</section>
<footer class=article-footer>
<section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
</article>
<aside class=related-contents--wrapper>
<h2 class=section-title>관련 글</h2>
<div class=related-contents>
<div class="flex article-list--tile">
<article class=has-image>
<a href=/blog/golang/how-to-backend-in-go-middleware/>
<div class=article-image>
<img src=/blog/golang/how-to-backend-in-go-middleware/log.a24b8a94710056cf81eeda03f1c3deee_hu6da6c55463c6a62988b186d685cd2c7c_23812_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy data-key data-hash="md5-okuKlHEAVs+B7toD8cPe7g==">
</div>
<div class=article-details>
<h2 class=article-title>Golang으로 백엔드 개발하기 - 4. Custom Middleware(미들웨어) 작성해보기 (feat. fiber)</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/blog/golang/how-to-backend-in-go-webapp/>
<div class=article-image>
<img src=/blog/golang/how-to-backend-in-go-webapp/output.8af8bebb21fe028ac92f562189cb643b_hu537a11d34916ac1c2def7909b69ddbc5_22456_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy data-key data-hash="md5-ivi+uyH+AorJL1YhictkOw==">
</div>
<div class=article-details>
<h2 class=article-title>Golang으로 백엔드 개발하기 - 3. 웹 애플리케이션 개발해보기 (feat. fiber)</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/blog/golang/how-to-backend-in-go-testcode/>
<div class=article-image>
<img src=/blog/golang/how-to-backend-in-go-testcode/test-with-ide.e83038fd0ad61ce8e85069ab96d89062_hu7b61495424919d2e1c8d663236a41b57_159980_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy data-key data-hash="md5-6DA4/QrWHOjoUGmrltiQYg==">
</div>
<div class=article-details>
<h2 class=article-title>Golang으로 백엔드 개발하기 - 2. 테스트 코드 작성 및 Go에서 Mocking 이용하기 (gomock, testify 이용)</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/blog/golang/how-to-backend-in-go-db/>
<div class=article-image>
<img src=/blog/golang/how-to-backend-in-go-db/o2m-relation.73e7e39c70cfc03dd37c4e76a3c340b4_huda98d5d877ff5063fa9c786910881686_21160_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy data-key data-hash="md5-c+fjnHDPwD3TfE52o8NAtA==">
</div>
<div class=article-details>
<h2 class=article-title>Golang으로 백엔드 개발하기 - 1. 데이터베이스 작업하기 (Ent 프레임워크 이용)</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/blog/golang/go-socket/>
<div class=article-image>
<img src=/blog/golang/go-socket/server-client-socket.25567a9a8e35e4878b3820141329b6da_huc5be35f5857cc34672b838b13057c03e_282874_250x150_fill_q75_box_smart1.jpeg width=250 height=150 loading=lazy data-key data-hash="md5-JVZ6mo415IeLOCAUEym22g==">
</div>
<div class=article-details>
<h2 class=article-title>Go 언어로 적용해보는 Computer Science - Socket (Unix Domain Socket, Network/TCP/UDP Socket)</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<div class=disqus-container>
<div id=disqus_thread></div>
<script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//umi0410.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</div>
<style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style>
<script>window.addEventListener('onColorSchemeChange',a=>{DISQUS&&DISQUS.reset({reload:!0})})</script>
<footer class=site-footer>
<section class=copyright>
&copy;
2020 -
2021 Jinsu Playground
</section>
<section class=powerby>
<a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a>로 만듦 <br>
<a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>의 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=2.4.0>Stack</a></b> 테마 사용 중
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
<aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div>
<h2 class="widget-title section-title">Table of contents</h2>
<div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#-시작하며>✋ 시작하며</a></li>
<li><a href=#-pipeline-pattern이란>❓ Pipeline pattern이란?</a>
<ol>
<li><a href=#pipeline-pattern의-흔한-예시로-square-하는-예제를-설명하는-글들>Pipeline pattern의 흔한 예시로 square 하는 예제를 설명하는 글들</a></li>
</ol>
</li>
<li><a href=#-언제-쓰는-게-좋을까>🤔 언제 쓰는 게 좋을까?</a></li>
<li><a href=#예시-프로그램>예시 프로그램</a>
<ol>
<li><a href=#프로그램-설명>프로그램 설명</a></li>
<li><a href=#-벤치마크-결과-비교>📉 벤치마크 결과 비교</a></li>
</ol>
</li>
<li><a href=#마무리>마무리</a></li>
<li><a href=#참고>참고</a></li>
</ol>
</nav>
</div>
</section>
</aside>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</body>
</html>