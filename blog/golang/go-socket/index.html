<!doctype html><html lang=ko-kr>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="자세한 의미는 모른 채 들어보기만 했던 소켓이란 녀석! 어떤 종류의 소켓이 존재하는지, 어떤 차이가 있는지
성능은 어떠한지 실제 Go 프로그램을 통해 확인해보고 벤치마크해보며 비교해봤습니다.
"><title>Go 언어로 적용해보는 Computer Science - Socket (Unix Domain Socket, Network/TCP/UDP Socket)</title>
<link rel=canonical href=https://umi0410.github.io/blog/golang/go-socket/>
<link rel=stylesheet href=/scss/style.min.css><meta property="og:title" content="Go 언어로 적용해보는 Computer Science - Socket (Unix Domain Socket, Network/TCP/UDP Socket)">
<meta property="og:description" content="자세한 의미는 모른 채 들어보기만 했던 소켓이란 녀석! 어떤 종류의 소켓이 존재하는지, 어떤 차이가 있는지
성능은 어떠한지 실제 Go 프로그램을 통해 확인해보고 벤치마크해보며 비교해봤습니다.
">
<meta property="og:url" content="https://umi0410.github.io/blog/golang/go-socket/">
<meta property="og:site_name" content="Jinsu Playground">
<meta property="og:type" content="article"><meta property="article:section" content="Blog"><meta property="article:published_time" content="2021-02-13T14:10:54+09:00"><meta property="article:modified_time" content="2021-02-13T14:10:54+09:00"><meta property="og:image" content="https://umi0410.github.io/blog/golang/go-socket/server-client-socket.jpeg">
<meta name=twitter:title content="Go 언어로 적용해보는 Computer Science - Socket (Unix Domain Socket, Network/TCP/UDP Socket)">
<meta name=twitter:description content="자세한 의미는 모른 채 들어보기만 했던 소켓이란 녀석! 어떤 종류의 소켓이 존재하는지, 어떤 차이가 있는지
성능은 어떠한지 실제 Go 프로그램을 통해 확인해보고 벤치마크해보며 비교해봤습니다.
"><meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://umi0410.github.io/blog/golang/go-socket/server-client-socket.jpeg">
<link rel="shortcut icon" href=https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/google/241/whale_1f40b.png>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-177403492-1','auto'),ga('send','pageview'))</script>
<link rel=preconnect href=https://fonts.googleapis.com>
<link rel=preconnect href=https://fonts.gstatic.com crossorigin>
<link href="https://fonts.googleapis.com/css2?family=East+Sea+Dokdo&family=Noto+Sans+KR:wght@400&display=swap" rel=stylesheet>
<style>@import 'https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css';:root{--body-background:#fafeff;--base-font-family:Pretendard, 'Noto Sans KR', sans-serif}.site-name{--site-name-font-family:'East Sea Dokdo', cursive;font-family:var(--site-name-font-family);font-size:3.2rem!important}.left-sidebar{--sidebar-avatar-size:200px}figure.site-avatar{margin-left:auto!important;margin-right:auto!important}</style>
</head>
<body class="article-page has-toc">
<script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex
extended">
<div id=article-toolbar>
<a href=https://umi0410.github.io class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg>
<span>Back</span>
</a>
</div>
<main class="main full-width">
<article class="has-image main-article">
<header class=article-header>
<div class=article-image>
<a href=/blog/golang/go-socket/>
<img src=/blog/golang/go-socket/server-client-socket_huc5be35f5857cc34672b838b13057c03e_282874_800x0_resize_q75_box.jpeg srcset="/blog/golang/go-socket/server-client-socket_huc5be35f5857cc34672b838b13057c03e_282874_800x0_resize_q75_box.jpeg 800w, /blog/golang/go-socket/server-client-socket_huc5be35f5857cc34672b838b13057c03e_282874_1600x0_resize_q75_box.jpeg 1600w" width=800 height=373 loading=lazy alt="Featured image of post Go 언어로 적용해보는 Computer Science - Socket (Unix Domain Socket, Network/TCP/UDP Socket)">
</a>
</div>
<div class=article-details>
<header class=article-category>
<a href=/categories/golang/>
Golang (Go 언어)
</a>
<a href=/categories/cs-with-golang/>
Golang으로 적용해보는 Computer Science
</a>
</header>
<h2 class=article-title>
<a href=/blog/golang/go-socket/>Go 언어로 적용해보는 Computer Science - Socket (Unix Domain Socket, Network/TCP/UDP Socket)</a>
</h2>
<h3 class=article-subtitle>
자세한 의미는 모른 채 들어보기만 했던 소켓이란 녀석! 어떤 종류의 소켓이 존재하는지, 어떤 차이가 있는지
성능은 어떠한지 실제 Go 프로그램을 통해 확인해보고 벤치마크해보며 비교해봤습니다.
</h3>
<footer class=article-time><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--published>Feb 13, 2021</time>
</footer></div>
</header>
<section class=article-content>
<h2 id=시작하며>시작하며</h2>
<p>개발 공부를 처음 시작한 지 언제 안 됐을 무렵, 의경 복무를 하며 자바로 TCP Socket을 이용해 옆 컴퓨터와 채팅을 하는 프로그램을 만들어 보는 것을 시작으로 docker나 mysql과 같은 다양한 오픈소스들을 이용해보면서나 네트워크를 공부하면서 다양하게 들어왔던 <code>소켓</code>이지만 정확히 어떤 역할을 하는지 어떤 종류가 있는지 어떻게 동작하는지 알지 못했다.</p>
<p>오늘은 그렇게 알쏭달쏭한 존재였던 소켓을 크게 <strong><code>Unix Domain Socket</code>와 <code>Network Socket</code> 두 가지로 나눠 정리해보고 Unix Domain Socket과 TCP를 사용하는 Network Socket을 벤치마크해보고 어떤 차이가 있는지 확인</strong>해보도록 하겠다. 주로 내가 소켓을 접했던 자료나 이슈 상황에서는 UDP보다는 TCP가 많이 등장했었기 때문에 <strong>UDP에 대한 내용은 거의 제외할 것이므로 대부분이 Network socket과 Unix domain socket 각각의 stream(network socket에선 tcp를 이용하는 경우에 해당) type socket</strong>에 관련한 내용일 것이다.</p>
<h2 id=socket-이란>Socket 이란</h2>
<p>소켓은 어떠한 통신에서의 Endpoint(끝점) 역할을 한다. 끝점이 없으면 어디와 어디가 통신하는지 어디에 데이터를 써야하는지 알 수 없다.</p>
<p>소켓을 마치 전구 소켓과 같이 소켓이라고 부르는 이유는 소켓에 올바르게 데이터를 적기만 하면 통신을 위한 세부적인 동작은 소켓이 알아서 수행하기 때문이다. 따라서 우리는 통신을 하기 위한 Socket을 올바르게 생성하고, 그 곳에 데이터를 올바르게 적거나 그곳의 데이터를 올바르게 읽기만 하면 된다. 실제 데이터 전송은 소켓이 알아서 수행해준다.</p>
<p>소켓은 같은 호스트 내에서 IPC를 위해 사용되는 <code>Unix domain socket</code>과 네트워크 통신을 하기 위해 사용되는 <code>Network socket</code>으로 분류할 수 있다. 간혹 unix domain socket과 TCP를 이용하는 Network socket, UDP를 이용하는 Network socket 이렇게 세 가지로 분류하는 경우를 본 것 같은데 이는 잘못된 분류라고 생각한다. Network socket 뿐만 아니라 Unix domain socket 또한 stream(Network socket의 경우 TCP를 이용하는 경우에 해당) 타입과 datagram 타입(Network socket의 경우 UDP를 이용하는 경우에 해당)으로 사용될 수 있기 때문이다.</p>
<h3 id=서버-소켓과-클라이언트-소켓>서버 소켓과 클라이언트 소켓</h3>
<p><figure style=flex-grow:214;flex-basis:515px>
<a href=/blog/golang/go-socket/server-client-socket.jpeg data-size=2146x1000><img src=/blog/golang/go-socket/server-client-socket.jpeg srcset="/blog/golang/go-socket/server-client-socket_huc5be35f5857cc34672b838b13057c03e_282874_480x0_resize_q75_box.jpeg 480w, /blog/golang/go-socket/server-client-socket_huc5be35f5857cc34672b838b13057c03e_282874_1024x0_resize_q75_box.jpeg 1024w" width=2146 height=1000 loading=lazy alt=server-client-socket.jpeg>
</a>
<figcaption>server-client-socket.jpeg</figcaption>
</figure></p>
<p>소켓을 역할의 측면에서 분류한다면 서버 소켓과 클라이언트 소켓으로 나눌 수 있다. 동일한 구조의 소켓이지만 생성되는 시기나 역할이 다를 뿐이다.</p>
<ul>
<li><strong>서버 소켓</strong> - 클라이언트 소켓의 연결 요청을 받아들이기만 할 뿐. 실제 서버 측에서의 데이터의 송수신은 서버 소켓이 클라이언트 소켓의 연결 요청을 수락하면서 새로 만들어지는 소켓을 통해 수행.</li>
<li><strong>클라이언트 소켓</strong> - 클라이언트가 서버와 통신하고자 할 때 생성하는 소켓. 클라이언트는 실제 데이터 송수신도 이 소켓을 통해 수행.</li>
</ul>
<p>서버 소켓과 클라이언트 소켓이 단순한게 1:N으로만 통신하면 이렇게 서버 소켓이 클라이언트 소켓의 요청을 수락한 뒤 새로 소켓을 만들 필요 없지 않을까싶지만 그렇게 되면 서버가 각 클라이언트와 통신할 때 하나의 소켓을 이용하므로 올바르게 원하는 클라이언트와 통신할 수 없을테니 좋은 방식이 아닐 것이다.</p>
<p>그렇다면 과연 <strong>정말 서버에서는 연결을 accept 한 뒤 소켓을 새로 생성할까?</strong> 확인해보자.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kn>package</span> <span class=nx>main</span>

<span class=kn>import</span> <span class=p>(</span>
    <span class=s>&#34;log&#34;</span>
    <span class=s>&#34;net&#34;</span>
    <span class=s>&#34;os&#34;</span>
    <span class=s>&#34;time&#34;</span>
<span class=p>)</span>

<span class=kd>var</span> <span class=p>(</span>
    <span class=nx>network</span> <span class=p>=</span> <span class=s>&#34;tcp&#34;</span>
    <span class=nx>address</span> <span class=p>=</span> <span class=s>&#34;0.0.0.0:8080&#34;</span>
<span class=p>)</span>
<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
    <span class=nx>os</span><span class=p>.</span><span class=nf>Remove</span><span class=p>(</span><span class=nx>address</span><span class=p>)</span>
    <span class=nx>socket</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>net</span><span class=p>.</span><span class=nf>Listen</span><span class=p>(</span><span class=nx>network</span><span class=p>,</span> <span class=nx>address</span><span class=p>)</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
    <span class=p>}</span>

    <span class=k>for</span> <span class=p>{</span>
        <span class=nx>connectedSocket</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>socket</span><span class=p>.</span><span class=nf>Accept</span><span class=p>()</span>
        <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span><span class=p>{</span>
            <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
        <span class=p>}</span>
        <span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
            <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;=</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>{</span>
                <span class=nx>connectedSocket</span><span class=p>.</span><span class=nf>Write</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=s>&#34;pong\n&#34;</span><span class=p>))</span>
                <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
            <span class=p>}</span>
            <span class=nx>connectedSocket</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
        <span class=p>}()</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><p>간단하게 TCP 통신프로그램을 하나 만들어봤다. 단순히 1초 간격으로 pong을 5번 출력한 뒤 연결을 끊는 프로그램이다.</p>
<p><strong>요청 전</strong></p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>$ netstat --tcp
Active Internet connections <span class=o>(</span>w/o servers<span class=o>)</span>
Proto Recv-Q Send-Q Local Address           Foreign Address         State
tcp        <span class=m>0</span>      <span class=m>0</span> ip-172-31-34-13.ap-:ssh 124.50.93.166:60082     ESTABLISHED
tcp        <span class=m>0</span>      <span class=m>0</span> ip-172-31-34-13.ap-:ssh 124.50.93.166:60084     ESTABLISHED
tcp        <span class=m>0</span>      <span class=m>0</span> ip-172-31-34-13.ap-:ssh 124.50.93.166:60078     ESTABLISHED
</code></pre></div><p><strong>요청 수락 후 통신 중</strong> - 소켓이 하나 생성되어 ESTABLISHED 상태</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>$ netstat --tcp
Active Internet connections <span class=o>(</span>w/o servers<span class=o>)</span>
Proto Recv-Q Send-Q Local Address           Foreign Address         State
tcp        <span class=m>0</span>      <span class=m>0</span> ip-172-31-34-13.ap-:ssh 124.50.93.166:60082     ESTABLISHED
tcp        <span class=m>0</span>      <span class=m>0</span> ip-172-31-34-13.ap-:ssh 124.50.93.166:60084     ESTABLISHED
tcp        <span class=m>0</span>      <span class=m>0</span> ip-172-31-34-13.ap-:ssh 124.50.93.166:60078     ESTABLISHED
tcp6       <span class=m>0</span>      <span class=m>0</span> ip-172-31-34-1:http-alt 124.50.93.166:42434     ESTABLISHED
</code></pre></div><p><strong>통신 종료</strong> - 생성되었던 소켓이 TIME_WAIT 상태. 잠시 후 사라진다.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>$ netstat --tcp
Active Internet connections <span class=o>(</span>w/o servers<span class=o>)</span>
Proto Recv-Q Send-Q Local Address           Foreign Address         State
tcp        <span class=m>0</span>      <span class=m>0</span> ip-172-31-34-13.ap-:ssh 124.50.93.166:60082     ESTABLISHED
tcp        <span class=m>0</span>      <span class=m>0</span> ip-172-31-34-13.ap-:ssh 124.50.93.166:60084     ESTABLISHED
tcp        <span class=m>0</span>      <span class=m>0</span> ip-172-31-34-13.ap-:ssh 124.50.93.166:60078     ESTABLISHED
tcp6       <span class=m>0</span>      <span class=m>0</span> ip-172-31-34-1:http-alt 124.50.93.166:42434     TIME_WAIT
</code></pre></div><blockquote>
<p>깔끔한 네트워크 정보를 보기 위해 순수한 AWS EC2 t2.micro 인스턴스에서 작업해보았다. 맨 위 3줄에 나온 소켓 정보는 ssh 접속으로 인한 소켓 정보이다.</p>
<p>또한 서버 소켓은 출력되지 않았는데 이는 우리는 평소에 listen 중인 포트나 서버 소켓을 보기 위해 netstat에 -l 옵션을 전달한 반면 이번엔 &ndash;tcp 옵션을 통해 listen 중인 서버 소켓이 아닌 클라이언트의 요청을 수락한 뒤 생성되는 소켓을 보려하고있기 때문이다.</p>
</blockquote>
<p>4번 째 줄의 소켓 정보가 바로 우리가 생각하는 서버 소켓이 client의 연결 요청을 accept 후 생성하는 socket이다. 클라이언트의 요청을 accept 후에 새로운 소켓이 생성되며 통신 종료 후 잠시 기다린 뒤 사라진다.</p>
<h3 id=network-socket>Network Socket</h3>
<p><code>Network socket</code>은 네트워크 통신이 필요한 작업을 수행할 때 이용하는 소켓의 한 종류로 다시 동작 방식에 따라 TCP 프로토콜을 이용하는 stream socket과 UDP 프로토콜을 이용하는 datagram socket으로 구분할 수 있다. 사용자는 socket에 데이터를 적기만 하면 네트워크와 관련된 작업은 socket이 알아서 수행해준다. 읽을 때에도 마찬가지이다.</p>
<p>TCP socket이라고 부르는 사람도 있고 stream socket, TCP/IP socket이라 부르는 사람도 있는 것 같다. 정확한 명칭은 모르겠지만 사용하거나 이해하는 데에는 무리가 없을 것 같다.
TCP를 이용하는 stream type의 Network socket과 stream type의 Unix domain socket은 사용 방법이 매우 유사하다. 둘 다 stream type이고, 소켓에 데이터를 적은 뒤의 작업은 소켓이 알아서 수행해주기 때문이다. 각각의 소켓을 이용해 서버를 띄우는 작업은 인자의 값만 조금 달라질 뿐이다. 이는 글의 하부의 코드에서 확인해볼 수 있다.</p>
<h4 id=socket과-port>Socket과 Port</h4>
<p>Network socket에 대해서는 socket과 port의 구분이나 역할이 애매하게 느껴질 수 있다. 통신을 할 때 IP 주소를 이용해 목적지인 Host를 찾을 수는 있지만 그 Host의 어떤 프로세스과 통신하려는 것인지는 알 수 없다. 올바른 프로세스를 찾을 수 있도록 프로세스와 어떠한 숫자를 매핑시키는데 이 숫자를 Port 번호라고 한다. 예를 들어 123.123.123.123:8080으로 요청을 보내는 것은 123.123.123.123의 IP 주소를 갖는 Host의 8080번 포트에 맵핑된 프로세스에 요청을 보내는 것이다.</p>
<p>이 때 Port와 프로세스를 그냥 연결할 수는 없고 Socket이라는 녀석이 필요하다. Socket은 실질적으로 어떤 프로세스를 어떤 포트에 맵핑시킬지에 대한 정보가 필요하고 네트워크 작업을 알아서 수행한다.</p>
<p>조금 비유를 해보자면 회사내에 어떤 부서가 있고 외부에서 해당 부서와 작업하기 위해선 어떠한 고유한 부서 번호가 필요하고, 이때 외부와 해당 부서간에 오가는 통신을 담당하는 담당자가 있어야하는 경우에 비유해 볼 수 있다. &ldquo;어떤 부서"는 프로세스이고 &ldquo;고유한 부서 번호"는 포트 번호, 통신을 담당하는 담당자는 소켓에 해당한다.</p>
<h3 id=unix-domain-socket>Unix Domain Socket</h3>
<p>Unix Domain Socket은 IPC(Inter-Process Communication, 프로세스 간 통신)의 여러 방법 중 가장 자유로우면서 사용하는 데에 있어 제한이 별로 없는 방법이다. 네트워크 소켓과 달리 같은 호스트 내의 프로세스 간 통신을 담당하기 때문에 아무런 네트워크 작업이 필요 없다. 하지만 TCP나 UDP를 이용하는 Network socket을 이용할 때와 인자 값만 조금 바꾸어 동일한 방식으로 사용이 가능하다.</p>
<h4 id=-상상의-나래---우리가-알게-모르게-겪었던-unix-domain-socket의-permission오류에-대해>🌈 상상의 나래 - 우리가 알게 모르게 겪었던 Unix domain socket의 Permission오류에 대해</h4>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>$ mysql
stat /var/lib/mysql/mysql.sock
stat: cannot stat <span class=s1>&#39;/var/lib/mysql/mysql.sock&#39;</span>: Permission denied
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>$ docker
docker: Got permission denied <span class=k>while</span> trying to connect to the Docker daemon socket at unix:///var/run/docker.sock
</code></pre></div><p>주로 우리가 <code>MySQL</code>이나 <code>Docker</code>를 <code>localhost</code>에서 사용할 때 <strong>unix socket에 대한 permission 에러</strong>를 겪은 적이 있을 것이다. MySQL이나 Docker를 비롯한 많은 오픈소스들이 아마 성능상의 이점을 위해 localhost에서 서비스를 이용할 경우 Network socket이 아닌 Unix domain socket을 많이들 이용하는 것으로 알고있다. 그렇기 때문에 주로 MySQL 설치 이후 Remote에서는 접속이 되는데 <strong>localhost에서는 권한 문제로 접속이 안된다거나 Docker 설치 이후 사용자를 docker group에 넣어주는 경우</strong>가 많이 있다.</p>
<p>아마도 네트워크 통신을 통해 서버 소켓에 접근하는 네트워크 소켓과 달리 unix domain socket은 client process가 직접 server의 socket file에 접근하기 때문에 이때 쓰기 권한 때문에 그런 권한 오류가 생기는 것이 아닐까라는 상상의 나래를 펼쳐본다.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=c1># ubuntu 사용자로 unix domain socket server 프로세스를 띄운 경우</span>
<span class=c1># ubuntu 사용자로는 잘 접속이 된다.</span>
ubuntu@ec2 $ go <span class=nb>test</span> -v
<span class=o>===</span> RUN   <span class=nv>TestSocket</span>
<span class=o>===</span> RUN   TestSocket/tcp
2021/02/13 12:59:06 <span class=nv>pong</span>
<span class=o>===</span> RUN   TestSocket/unix
2021/02/13 12:59:06 pong
--- PASS: TestSocket <span class=o>(</span>0.00s<span class=o>)</span>
    --- PASS: TestSocket/tcp <span class=o>(</span>0.00s<span class=o>)</span>
    --- PASS: TestSocket/unix <span class=o>(</span>0.00s<span class=o>)</span>
PASS
ok  	uds	0.004s
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=c1># server가 생성한 unix domain socket에 write 권한이 없는</span>
<span class=c1># guest1이라는 사용자로는 server와 unix domain socket으로는 통신할 수 없고,</span>
<span class=c1># 앞서 오픈소스를 이용하며 겪었던 에러와 마찬가지로 권한 이슈가 발생한다.</span>
<span class=c1># 하지만 TCP 소켓을 이용한 경우는 원활히 ping-pong test가 성공한 것을 볼 수 있다.</span>
guest1@ec2 $ go <span class=nb>test</span> -v
<span class=o>===</span> RUN   <span class=nv>TestSocket</span>
<span class=o>===</span> RUN   TestSocket/tcp
2021/02/13 12:59:01 <span class=nv>pong</span>
<span class=o>===</span> RUN   TestSocket/unix
    main_test.go:21: 
        	Error Trace:	main_test.go:21
        	Error:      	Received unexpected error:
        	            	dial unix jinsu.sock: connect: permission denied
        	Test:       	TestSocket/unix
--- FAIL: TestSocket <span class=o>(</span>0.00s<span class=o>)</span>
    --- PASS: TestSocket/tcp <span class=o>(</span>0.00s<span class=o>)</span>
    --- FAIL: TestSocket/unix <span class=o>(</span>0.00s<span class=o>)</span>

<span class=c1># 하지만 재미있게도 guest1도 socket에 write할 수 있도록 권한을 수정해주니</span>
<span class=c1># guest1도 unix domain socket으로 무리 없이 통신이 가능했다!</span>
guest1@ec2 $ sudo chmod <span class=m>777</span> jinsu.sock
guest1@ec2 $ go <span class=nb>test</span> -v
<span class=o>===</span> RUN   <span class=nv>TestSocket</span>
<span class=o>===</span> RUN   TestSocket/tcp
2021/02/13 12:59:06 <span class=nv>pong</span>
<span class=o>===</span> RUN   TestSocket/unix
2021/02/13 12:59:06 pong
--- PASS: TestSocket <span class=o>(</span>0.00s<span class=o>)</span>
    --- PASS: TestSocket/tcp <span class=o>(</span>0.00s<span class=o>)</span>
    --- PASS: TestSocket/unix <span class=o>(</span>0.00s<span class=o>)</span>
PASS
ok  	uds	0.004s
</code></pre></div><p>따라서 ubuntu 사용자로 TCP socket과 Unix domain socket 두 가지 방법으로 서버 역할을 할 수 있는 프로세스를 띄운 뒤 ubuntu 사용자와 guest1 사용자로 통신 테스트를 진행해보았다.</p>
<p>서버가 생성한 unix domain socket은 <code>srwxrwxr-x</code> 의 형식과 권한을 갖고 있기 때문에 guest1은 이 소켓에 대해 read와 execute 권한 뿐이고, write는 불가능하기에 unix domain socket을 이용해서는 통신할 수 없다. 따라서 우리가 평소에 오픈소스를 localhost에서 이용하면서 종종 맞이했던 소켓에 대한 permission error을 만나볼 수 있었다! 반면 socket에 대한 접근 권한이 필요 없는 TCP로는 통신이 가능했고, 놀랍게도 guest1에게 소켓 파일에 대한 write 권한을 부여해주자 Unix domain socket으로도 통신이 가능해진 것을 볼 수 있다.</p>
<p><strong>상상의 나래 정리: unix domain socket을 통해 접속을 시도할 때에는 unix domain socket file에 대한 접근을 하는 프로세스가 해당 socket file에 대한 적절한 permission을 갖고 있어야한다.</strong></p>
<blockquote>
<p>또한 구글링 도중 보았던 재미있는 예시는 database를 통해 authentication/authorization을 수행하는 일반적인 서비스와 달리 Unix domain socket을 이용하는 경우에는 linux user 시스템을 이용해서도 권한/인증 관리를 수행하는 경우도 존재할 수 있다는 것이었다.</p>
</blockquote>
<h2 id=벤치마킹-unix-domain-socket-vs-network-socket>벤치마킹 Unix domain socket vs Network socket</h2>
<p>Unix domain socket과 Network socket의 성능을 비교하는 벤치마크를 작성했다.
두 경우 모두 Stream type의 socket을 이용하도록 했고, Network socket의 경우는 특히나 이 경우 TCP 프로토콜을 이용하게 된다.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=c1>// main.go
</span><span class=c1>// 한 프로세스 내에서 TCP Socket과 Unix Domain Socket 두 가지를 이용해
</span><span class=c1>// 통신할 수 있는 프로그램
</span><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>

<span class=kn>import</span> <span class=p>(</span>
    <span class=s>&#34;errors&#34;</span>
    <span class=s>&#34;io&#34;</span>
    <span class=s>&#34;log&#34;</span>
    <span class=s>&#34;net&#34;</span>
    <span class=s>&#34;os&#34;</span>
    <span class=s>&#34;time&#34;</span>
<span class=p>)</span>

<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>go</span> <span class=nf>RunTCPSocketServer</span><span class=p>()</span>
    <span class=k>go</span> <span class=nf>RunUnixDomainSocketServer</span><span class=p>()</span>

    <span class=k>for</span> <span class=p>{</span>
        <span class=nx>log</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Dummy waiting...&#34;</span><span class=p>)</span>
        <span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nx>Minute</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>RunTCPSocketServer</span><span class=p>(){</span>
    <span class=nx>log</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Run TCPSocketServer...&#34;</span><span class=p>)</span>
    <span class=nf>run</span><span class=p>(</span><span class=s>&#34;tcp&#34;</span><span class=p>,</span> <span class=s>&#34;0.0.0.0:8080&#34;</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>RunUnixDomainSocketServer</span><span class=p>(){</span>
    <span class=nx>log</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Run UnixDomainSocketServer...&#34;</span><span class=p>)</span>
    <span class=nx>serverSocketName</span> <span class=o>:=</span> <span class=s>&#34;jinsu.sock&#34;</span>
    <span class=nx>os</span><span class=p>.</span><span class=nf>Remove</span><span class=p>(</span><span class=nx>serverSocketName</span><span class=p>)</span>
    <span class=nf>run</span><span class=p>(</span><span class=s>&#34;unix&#34;</span><span class=p>,</span> <span class=nx>serverSocketName</span><span class=p>)</span>
<span class=p>}</span>

<span class=c1>// TCP socket을 이용해 서버를 띄우든 Unix Domain Socket을 이용해 서버를 띄우든
</span><span class=c1>// 간단히 인자 값만 변경해서 이용할 수 있다!
</span><span class=c1></span><span class=kd>func</span> <span class=nf>run</span><span class=p>(</span><span class=nx>network</span><span class=p>,</span> <span class=nx>address</span> <span class=kt>string</span><span class=p>){</span>
    <span class=nx>buf</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=mi>1024</span><span class=p>)</span>
    <span class=nx>socket</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>net</span><span class=p>.</span><span class=nf>Listen</span><span class=p>(</span><span class=nx>network</span><span class=p>,</span> <span class=nx>address</span><span class=p>)</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
    <span class=p>}</span>

    <span class=k>for</span> <span class=p>{</span>
        <span class=nx>connectedSocket</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>socket</span><span class=p>.</span><span class=nf>Accept</span><span class=p>()</span>
        <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span><span class=p>{</span>
            <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
        <span class=p>}</span>
        <span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
            <span class=k>for</span><span class=p>{</span>
                <span class=nx>n</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>connectedSocket</span><span class=p>.</span><span class=nf>Read</span><span class=p>(</span><span class=nx>buf</span><span class=p>)</span>
                <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span><span class=p>{</span>
                    <span class=k>if</span> <span class=p>!</span><span class=nx>errors</span><span class=p>.</span><span class=nf>Is</span><span class=p>(</span><span class=nx>io</span><span class=p>.</span><span class=nx>EOF</span><span class=p>,</span> <span class=nx>err</span><span class=p>){</span>
                        <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
                    <span class=p>}</span> <span class=k>else</span><span class=p>{</span>
                        <span class=nx>log</span><span class=p>.</span><span class=nf>Print</span><span class=p>(</span><span class=s>&#34;[Error]&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
                        <span class=k>break</span>
                    <span class=p>}</span>
                <span class=p>}</span>
                <span class=nx>log</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>network</span><span class=p>,</span> <span class=s>&#34;Client sent:&#34;</span><span class=p>,</span> <span class=nx>n</span><span class=p>)</span>
                <span class=nx>connectedSocket</span><span class=p>.</span><span class=nf>Write</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=s>&#34;pong&#34;</span><span class=p>))</span>
            <span class=p>}</span>
            <span class=nx>connectedSocket</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
        <span class=p>}()</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=c1>// main_test.go
</span><span class=c1>// tcp socket과 unix domain socket을 이용해 성공적으로 서버와 통신이
</span><span class=c1>// 이루어지는지 테스트하는 테스트 코드
</span><span class=c1>// tcp와 unix domain socket의 성능을 비교하는 벤치마크 코드
</span><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>

<span class=kn>import</span> <span class=p>(</span>
    <span class=s>&#34;errors&#34;</span>
    <span class=s>&#34;github.com/stretchr/testify/assert&#34;</span>
    <span class=s>&#34;io&#34;</span>
    <span class=s>&#34;log&#34;</span>
    <span class=s>&#34;net&#34;</span>
    <span class=s>&#34;testing&#34;</span>
<span class=p>)</span>

<span class=kd>func</span> <span class=nf>TestSocket</span><span class=p>(</span><span class=nx>t</span> <span class=o>*</span><span class=nx>testing</span><span class=p>.</span><span class=nx>T</span><span class=p>){</span>
    <span class=nx>args</span> <span class=o>:=</span> <span class=p>[][]</span><span class=kt>string</span><span class=p>{</span>
        <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;tcp&#34;</span><span class=p>,</span> <span class=s>&#34;0.0.0.0:8080&#34;</span><span class=p>},</span>
        <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;unix&#34;</span><span class=p>,</span> <span class=s>&#34;jinsu.sock&#34;</span><span class=p>},</span>
    <span class=p>}</span>

    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>arg</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>args</span><span class=p>{</span>
        <span class=nx>t</span><span class=p>.</span><span class=nf>Run</span><span class=p>(</span><span class=nx>arg</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=kd>func</span><span class=p>(</span><span class=nx>t</span> <span class=o>*</span><span class=nx>testing</span><span class=p>.</span><span class=nx>T</span><span class=p>)</span> <span class=p>{</span>
            <span class=nx>conn</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>net</span><span class=p>.</span><span class=nf>Dial</span><span class=p>(</span><span class=nx>arg</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=nx>arg</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
            <span class=nx>assert</span><span class=p>.</span><span class=nf>NoError</span><span class=p>(</span><span class=nx>t</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
            <span class=nx>buf</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=mi>1024</span><span class=p>)</span>
            <span class=nx>_</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>conn</span><span class=p>.</span><span class=nf>Write</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=s>&#34;ping&#34;</span><span class=p>))</span>
            <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span><span class=p>{</span>
                <span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
            <span class=p>}</span>
            <span class=nx>n</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>conn</span><span class=p>.</span><span class=nf>Read</span><span class=p>(</span><span class=nx>buf</span><span class=p>)</span>
            <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span><span class=p>{</span>
                <span class=k>if</span> <span class=p>!</span> <span class=nx>errors</span><span class=p>.</span><span class=nf>Is</span><span class=p>(</span><span class=nx>io</span><span class=p>.</span><span class=nx>EOF</span><span class=p>,</span> <span class=nx>err</span><span class=p>){</span>
                    <span class=nx>log</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
                <span class=p>}</span>
            <span class=p>}</span>
            <span class=nx>log</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nx>buf</span><span class=p>[:</span><span class=nx>n</span><span class=p>]))</span>
        <span class=p>})</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>BenchmarkSocket</span><span class=p>(</span><span class=nx>b</span> <span class=o>*</span><span class=nx>testing</span><span class=p>.</span><span class=nx>B</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>args</span> <span class=o>:=</span> <span class=p>[][]</span><span class=kt>string</span><span class=p>{</span>
        <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;tcp&#34;</span><span class=p>,</span> <span class=s>&#34;0.0.0.0:8080&#34;</span><span class=p>},</span>
        <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;unix&#34;</span><span class=p>,</span> <span class=s>&#34;jinsu.sock&#34;</span><span class=p>},</span>
    <span class=p>}</span>
    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>arg</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>args</span><span class=p>{</span>
        <span class=nx>b</span><span class=p>.</span><span class=nf>Run</span><span class=p>(</span><span class=nx>arg</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=kd>func</span><span class=p>(</span><span class=nx>b</span> <span class=o>*</span><span class=nx>testing</span><span class=p>.</span><span class=nx>B</span><span class=p>)</span> <span class=p>{</span>
            <span class=c1>//log.Println(&#34;Out&#34;) // b.N과 상관 없이 args의 길이에 따라 출력됨.
</span><span class=c1></span>            <span class=nx>conn</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>net</span><span class=p>.</span><span class=nf>Dial</span><span class=p>(</span><span class=nx>arg</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=nx>arg</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
            <span class=nx>assert</span><span class=p>.</span><span class=nf>NoError</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
            <span class=nx>buf</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=mi>1024</span><span class=p>)</span>
            <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nx>b</span><span class=p>.</span><span class=nx>N</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>{</span>
                <span class=c1>//log.Println(&#34;In&#34;) // b.N만큼 수행됨
</span><span class=c1></span>                <span class=nx>_</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>conn</span><span class=p>.</span><span class=nf>Write</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=s>&#34;ping&#34;</span><span class=p>))</span>
                <span class=nx>assert</span><span class=p>.</span><span class=nf>NoError</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
                <span class=nx>_</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>conn</span><span class=p>.</span><span class=nf>Read</span><span class=p>(</span><span class=nx>buf</span><span class=p>)</span>
                <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span><span class=p>{</span>
                    <span class=k>if</span> <span class=p>!</span><span class=nx>errors</span><span class=p>.</span><span class=nf>Is</span><span class=p>(</span><span class=nx>io</span><span class=p>.</span><span class=nx>EOF</span><span class=p>,</span> <span class=nx>err</span><span class=p>){</span>
                        <span class=nx>b</span><span class=p>.</span><span class=nf>Fail</span><span class=p>()</span>
                    <span class=p>}</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>})</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash>$ go <span class=nb>test</span> -bench<span class=o>=</span>. -benchtime<span class=o>=</span>100000x
goos: linux
goarch: amd64
pkg: uds
BenchmarkSocket/tcp         	  100000	    <span class=m>104537</span> ns/op
BenchmarkSocket/unix        	  100000	     <span class=m>83456</span> ns/op
PASS
ok  	uds	18.808s
</code></pre></div><p>10000번의 ping-pong을 수행하는 벤치마크를 수행했다.
그 결과 <strong>TCP socket을 이용할 경우는 한 번의 ping-pong에 약 104537ns, unix domain socket을 이용할 경우는 한 번의 ping-pong에 약 83456ns</strong>가 소요된 것을 보아 <strong>예상대로 네트워크 통신이 일절 필요하지 않은 unix domain socket이 좀 더 성능이 좋은 것으로 보여졌다</strong>. 사전에 자료 조사를 할 때에는 unix domain socket이 tcp socket을 이용할 때보다 약 2배가량 성능이 우월할 것이라고 들었는데, 그렇게 많은 차이가 나는 것 같지는 않다. 하지만 어느 정도 데이터의 크기나 버퍼의 크기에 따라 달라질 수도 있을 것 같고 더 깊은 원리들이 존재할 것 같아 더 자세히는 측정해보지 못했다.</p>
<h2 id=마치며>마치며</h2>
<p>사실 이번에 다룬 소켓이라는 주제는 Go로 적용해보는 Computer Science라는 이 시리즈를 정리해나가던 초기에 2번 째 글로 시도했던 주제였는데 당시엔 Go benchmark도 처음 사용해봤었고 내용이 어려웠던 터라 벤치마크도 제대로 되지 않고 정리도 하기 힘들어서 중단했던 주제이다. 하지만 이번엔 같은 내용에 대해 두 번째 정리해서인지 전보다 내용도 잘 이해됐고, 벤치마킹 코드와 결과도 깔끔하게 나왔던 것 같아 뿌듯하다.</p>
<p>그리고 그 동안 도커나 MySQL 같은 오픈소스들을 사용하면서 간혹 소켓에 대한 오류를 접할 때나 이런 저런 글에서 소켓 관련한 내용이 등장할 때 정확히 어떤 역할인지 이유가 뭔지 자세히 알지 못했는데 이번 기회덕에 앞으로는 좀 더 잘 이해해볼 수 있을 것 같다.</p>
<h2 id=참고>참고</h2>
<ul>
<li>
<p>소켓 <a class=link href="http://www.ktword.co.kr/abbr_view.php?nav=&m_temp1=280&id=742" target=_blank rel=noopener>http://www.ktword.co.kr/abbr_view.php?nav=&m_temp1=280&id=742</a></p>
</li>
<li>
<p>네트워크 소켓 <a class=link href=https://ko.wikipedia.org/wiki/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC_%EC%86%8C%EC%BC%93 target=_blank rel=noopener>https://ko.wikipedia.org/wiki/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC_%EC%86%8C%EC%BC%93</a></p>
</li>
<li>
<p>소켓 프로그래밍 <a class=link href=https://recipes4dev.tistory.com/153 target=_blank rel=noopener>https://recipes4dev.tistory.com/153</a></p>
</li>
<li>
<p>UDS (Unix Domain Socket) <a class=link href=http://www.dreamy.pe.kr/zbxe/CodeClip/119393 target=_blank rel=noopener>http://www.dreamy.pe.kr/zbxe/CodeClip/119393</a></p>
</li>
<li>
<p>[Linux/UDS/Unix Domain Socket] UDS <a class=link href=https://yaaam.tistory.com/entry/LinuxUDSUnix-Domain-Socket-UDS target=_blank rel=noopener>https://yaaam.tistory.com/entry/LinuxUDSUnix-Domain-Socket-UDS</a></p>
</li>
<li>
<p>Unix file type <a class=link href=https://en.wikipedia.org/wiki/Unix_file_types target=_blank rel=noopener>https://en.wikipedia.org/wiki/Unix_file_types</a></p>
</li>
<li>
<p>C# - .NET Core Unix Domain Socket 사용 예제 <a class=link href=https://www.sysnet.pe.kr/2/0/11963 target=_blank rel=noopener>https://www.sysnet.pe.kr/2/0/11963</a></p>
</li>
<li>
<p>Unix Domain Socket <a class=link href=https://www.joinc.co.kr/w/Site/system_programing/IPC/Unix_Domain_Socket target=_blank rel=noopener>https://www.joinc.co.kr/w/Site/system_programing/IPC/Unix_Domain_Socket</a></p>
</li>
<li>
<p>Unix Domain Socket - UDP <a class=link href=https://www.joinc.co.kr/w/Site/system_programing/IPC/Unix_Domain_Socket_UDP target=_blank rel=noopener>https://www.joinc.co.kr/w/Site/system_programing/IPC/Unix_Domain_Socket_UDP</a></p>
</li>
<li>
<p>What is the difference between Unix sockets and TCP/IP sockets? <a class=link href=https://serverfault.com/questions/124517/what-is-the-difference-between-unix-sockets-and-tcp-ip-sockets target=_blank rel=noopener>https://serverfault.com/questions/124517/what-is-the-difference-between-unix-sockets-and-tcp-ip-sockets</a></p>
</li>
</ul>
</section>
<footer class=article-footer>
<section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
</article>
<aside class=related-contents--wrapper>
<h2 class=section-title>관련 글</h2>
<div class=related-contents>
<div class="flex article-list--tile">
<article class=has-image>
<a href=/blog/golang/go-deadlock/>
<div class=article-image>
<img src=/blog/golang/go-deadlock/pprof-debugging-1.d1f321c8f5ce97d5cc607546d7c31712_hu27a13bf8dcdafb0aaff224765e3a83ab_59369_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy data-key data-hash="md5-0fMhyPXOl9XMYHVG18MXEg==">
</div>
<div class=article-details>
<h2 class=article-title>Go 언어로 적용해보는 Computer Science - Deadlock</h2>
</div>
</a>
</article>
<article>
<a href=/blog/golang/go-cpu-cache/>
<div class=article-details>
<h2 class=article-title>Go 언어로 적용해보는 Computer Science - Cache</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/blog/golang/go-mutex-semaphore/>
<div class=article-image>
<img src=/blog/golang/go-mutex-semaphore/mutex-2.ec80287e58d91bc66a01f1e91b68cd50_hu253887d6f424b5a6c4c14b3309becda5_68035_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy data-key data-hash="md5-7IAofljZG8ZqAfHpG2jNUA==">
</div>
<div class=article-details>
<h2 class=article-title>Go 언어로 적용해보는 Computer Science - Mutex와 Semaphore</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/blog/golang/how-to-backend-in-go-errorhandle/>
<div class=article-image>
<img src=/blog/golang/how-to-backend-in-go-errorhandle/chain.84f4fd17f71f3709899bfce8b3896864_hua96618047d845851ee10ee4de25bc827_61443_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy data-key data-hash="md5-hPT9F/cfNwmJm/zos4loZA==">
</div>
<div class=article-details>
<h2 class=article-title>Golang으로 백엔드 개발하기 - 5. Error Handling. 에러 잘 처리하기 (feat. fiber)</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/blog/golang/how-to-backend-in-go-middleware/>
<div class=article-image>
<img src=/blog/golang/how-to-backend-in-go-middleware/log.a24b8a94710056cf81eeda03f1c3deee_hu6da6c55463c6a62988b186d685cd2c7c_23812_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy data-key data-hash="md5-okuKlHEAVs+B7toD8cPe7g==">
</div>
<div class=article-details>
<h2 class=article-title>Golang으로 백엔드 개발하기 - 4. Custom Middleware(미들웨어) 작성해보기 (feat. fiber)</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<div class=disqus-container>
<div id=disqus_thread></div>
<script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//umi0410.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</div>
<style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style>
<script>window.addEventListener('onColorSchemeChange',a=>{DISQUS&&DISQUS.reset({reload:!0})})</script>
<footer class=site-footer>
<section class=copyright>
&copy;
2020 -
2022 Jinsu Playground
</section>
<section class=powerby>
<a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a>로 만듦 <br>
<a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>의 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=2.4.0>Stack</a></b> 테마 사용 중
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
<aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div>
<h2 class="widget-title section-title">Table of contents</h2>
<div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#시작하며>시작하며</a></li>
<li><a href=#socket-이란>Socket 이란</a>
<ol>
<li><a href=#서버-소켓과-클라이언트-소켓>서버 소켓과 클라이언트 소켓</a></li>
<li><a href=#network-socket>Network Socket</a>
<ol>
<li><a href=#socket과-port>Socket과 Port</a></li>
</ol>
</li>
<li><a href=#unix-domain-socket>Unix Domain Socket</a>
<ol>
<li><a href=#-상상의-나래---우리가-알게-모르게-겪었던-unix-domain-socket의-permission오류에-대해>🌈 상상의 나래 - 우리가 알게 모르게 겪었던 Unix domain socket의 Permission오류에 대해</a></li>
</ol>
</li>
</ol>
</li>
<li><a href=#벤치마킹-unix-domain-socket-vs-network-socket>벤치마킹 Unix domain socket vs Network socket</a></li>
<li><a href=#마치며>마치며</a></li>
<li><a href=#참고>참고</a></li>
</ol>
</nav>
</div>
</section>
</aside>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</body>
</html>