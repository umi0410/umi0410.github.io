<!doctype html><html lang=ko-kr>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="`ë°ë¸Œì˜µìŠ¤` ì¸í„´ìœ¼ë¡œ ê·¼ë¬´í•œ ì§€ê°€ ë²Œì¨ ë‘ ë‹¬ì´ ë˜ì–´ê°‘ë‹ˆë‹¤. ì´ê²ƒ ì €ê²ƒ ë°°ìš´ ê²ƒì´ ë§ì•˜ë˜ ì‹œê°„ì´ì—ˆëŠ”ë°, ê·¸ ì¤‘ ê½¤ë‚˜ ì‚½ì§ˆì„ í–ˆë˜ `Kubernetes` ì™€ `ELB`ë¥¼ ì´ìš©í•˜ëŠ” ë¶€ë¶„ì— ëŒ€í•´ ì •ë¦¬ë¥¼ í•´ë³¼ê¹Œí•©ë‹ˆë‹¤. `jenkins`, `spinnaker`, `argo`, `terraform`, `ansible`, `github action`, ... ë“±ë“± ë‹¤ì–‘í•œ ë‚´ìš©ì„ ê²½í—˜í•  ìˆ˜ ìˆë˜ ì‹œê°„ì´ì—ˆì§€ë§Œ, ê·¸ ì¤‘ kubernetesì—ì„œ ë¬´ìŠ¨ ì‘ì—…ì„ í•˜ë˜ ë¹¼ë†“ì„ ìˆ˜ ì—†ìœ¼ë©´ì„œ ì–´ë”˜ê°€ ê¹”ë”íˆ ê·¸ íë¦„ì´ ì •ë¦¬ëœ ê³³ì„ ë³´ê¸° í˜ë“¤ì—ˆë˜ **serviceë¥¼ ELBì— ì—°ê²°**í•˜ê¸°ì— ëŒ€í•œ ë‚´ìš©ì„ ì •ë¦¬í•´ë³´ê² ìŠµë‹ˆë‹¤.
*ë³¸ í¬ìŠ¤íŠ¸ëŠ” EKSë¥¼ í†µí•´ K8së¥¼ ì´ìš©í•  ë•Œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì„¤ëª…í•©ë‹ˆë‹¤.*
"><title>EKS K8sì—ì„œ ELB(ALB, NLB) ì œëŒ€ë¡œ ì„¤ì •í•˜ë©° ì‚¬ìš©í•˜ê¸°</title>
<link rel=canonical href=https://umi0410.github.io/blog/aws/aws_eks_elb/>
<link rel=stylesheet href=/scss/style.min.css><meta property="og:title" content="EKS K8sì—ì„œ ELB(ALB, NLB) ì œëŒ€ë¡œ ì„¤ì •í•˜ë©° ì‚¬ìš©í•˜ê¸°">
<meta property="og:description" content="`ë°ë¸Œì˜µìŠ¤` ì¸í„´ìœ¼ë¡œ ê·¼ë¬´í•œ ì§€ê°€ ë²Œì¨ ë‘ ë‹¬ì´ ë˜ì–´ê°‘ë‹ˆë‹¤. ì´ê²ƒ ì €ê²ƒ ë°°ìš´ ê²ƒì´ ë§ì•˜ë˜ ì‹œê°„ì´ì—ˆëŠ”ë°, ê·¸ ì¤‘ ê½¤ë‚˜ ì‚½ì§ˆì„ í–ˆë˜ `Kubernetes` ì™€ `ELB`ë¥¼ ì´ìš©í•˜ëŠ” ë¶€ë¶„ì— ëŒ€í•´ ì •ë¦¬ë¥¼ í•´ë³¼ê¹Œí•©ë‹ˆë‹¤. `jenkins`, `spinnaker`, `argo`, `terraform`, `ansible`, `github action`, ... ë“±ë“± ë‹¤ì–‘í•œ ë‚´ìš©ì„ ê²½í—˜í•  ìˆ˜ ìˆë˜ ì‹œê°„ì´ì—ˆì§€ë§Œ, ê·¸ ì¤‘ kubernetesì—ì„œ ë¬´ìŠ¨ ì‘ì—…ì„ í•˜ë˜ ë¹¼ë†“ì„ ìˆ˜ ì—†ìœ¼ë©´ì„œ ì–´ë”˜ê°€ ê¹”ë”íˆ ê·¸ íë¦„ì´ ì •ë¦¬ëœ ê³³ì„ ë³´ê¸° í˜ë“¤ì—ˆë˜ **serviceë¥¼ ELBì— ì—°ê²°**í•˜ê¸°ì— ëŒ€í•œ ë‚´ìš©ì„ ì •ë¦¬í•´ë³´ê² ìŠµë‹ˆë‹¤.
*ë³¸ í¬ìŠ¤íŠ¸ëŠ” EKSë¥¼ í†µí•´ K8së¥¼ ì´ìš©í•  ë•Œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì„¤ëª…í•©ë‹ˆë‹¤.*
">
<meta property="og:url" content="https://umi0410.github.io/blog/aws/aws_eks_elb/">
<meta property="og:site_name" content="Jinsu Playground">
<meta property="og:type" content="article"><meta property="article:section" content="Blog"><meta property="article:published_time" content="2020-09-06T19:11:07+09:00"><meta property="article:modified_time" content="2020-09-06T19:11:07+09:00"><meta property="og:image" content="https://umi0410.github.io/blog/aws/aws_eks_elb/preview.png">
<meta name=twitter:title content="EKS K8sì—ì„œ ELB(ALB, NLB) ì œëŒ€ë¡œ ì„¤ì •í•˜ë©° ì‚¬ìš©í•˜ê¸°">
<meta name=twitter:description content="`ë°ë¸Œì˜µìŠ¤` ì¸í„´ìœ¼ë¡œ ê·¼ë¬´í•œ ì§€ê°€ ë²Œì¨ ë‘ ë‹¬ì´ ë˜ì–´ê°‘ë‹ˆë‹¤. ì´ê²ƒ ì €ê²ƒ ë°°ìš´ ê²ƒì´ ë§ì•˜ë˜ ì‹œê°„ì´ì—ˆëŠ”ë°, ê·¸ ì¤‘ ê½¤ë‚˜ ì‚½ì§ˆì„ í–ˆë˜ `Kubernetes` ì™€ `ELB`ë¥¼ ì´ìš©í•˜ëŠ” ë¶€ë¶„ì— ëŒ€í•´ ì •ë¦¬ë¥¼ í•´ë³¼ê¹Œí•©ë‹ˆë‹¤. `jenkins`, `spinnaker`, `argo`, `terraform`, `ansible`, `github action`, ... ë“±ë“± ë‹¤ì–‘í•œ ë‚´ìš©ì„ ê²½í—˜í•  ìˆ˜ ìˆë˜ ì‹œê°„ì´ì—ˆì§€ë§Œ, ê·¸ ì¤‘ kubernetesì—ì„œ ë¬´ìŠ¨ ì‘ì—…ì„ í•˜ë˜ ë¹¼ë†“ì„ ìˆ˜ ì—†ìœ¼ë©´ì„œ ì–´ë”˜ê°€ ê¹”ë”íˆ ê·¸ íë¦„ì´ ì •ë¦¬ëœ ê³³ì„ ë³´ê¸° í˜ë“¤ì—ˆë˜ **serviceë¥¼ ELBì— ì—°ê²°**í•˜ê¸°ì— ëŒ€í•œ ë‚´ìš©ì„ ì •ë¦¬í•´ë³´ê² ìŠµë‹ˆë‹¤.
*ë³¸ í¬ìŠ¤íŠ¸ëŠ” EKSë¥¼ í†µí•´ K8së¥¼ ì´ìš©í•  ë•Œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì„¤ëª…í•©ë‹ˆë‹¤.*
"><meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://umi0410.github.io/blog/aws/aws_eks_elb/preview.png">
<link rel="shortcut icon" href=https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/google/241/whale_1f40b.png>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-177403492-1','auto'),ga('send','pageview'))</script>
<link rel=preconnect href=https://fonts.googleapis.com>
<link rel=preconnect href=https://fonts.gstatic.com crossorigin>
<link href="https://fonts.googleapis.com/css2?family=East+Sea+Dokdo&family=Noto+Sans+KR:wght@400&display=swap" rel=stylesheet>
<style>@import 'https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css';:root{--body-background:#fafeff;--base-font-family:Pretendard, 'Noto Sans KR', sans-serif}.site-name{--site-name-font-family:'East Sea Dokdo', cursive;font-family:var(--site-name-font-family);font-size:3.2rem!important}.left-sidebar{--sidebar-avatar-size:200px}figure.site-avatar{margin-left:auto!important;margin-right:auto!important}</style>
</head>
<body class="article-page has-toc">
<script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex
extended">
<div id=article-toolbar>
<a href=https://umi0410.github.io class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg>
<span>Back</span>
</a>
</div>
<main class="main full-width">
<article class="has-image main-article">
<header class=article-header>
<div class=article-image>
<a href=/blog/aws/aws_eks_elb/>
<img src=/blog/aws/aws_eks_elb/preview_huc38b74e19f60c2848e88837c4c6920fa_1709468_800x0_resize_box_3.png srcset="/blog/aws/aws_eks_elb/preview_huc38b74e19f60c2848e88837c4c6920fa_1709468_800x0_resize_box_3.png 800w, /blog/aws/aws_eks_elb/preview_huc38b74e19f60c2848e88837c4c6920fa_1709468_1600x0_resize_box_3.png 1600w" width=800 height=432 loading=lazy alt="Featured image of post EKS K8sì—ì„œ ELB(ALB, NLB) ì œëŒ€ë¡œ ì„¤ì •í•˜ë©° ì‚¬ìš©í•˜ê¸°">
</a>
</div>
<div class=article-details>
<header class=article-category>
<a href=/categories/aws/>
AWS
</a>
</header>
<h2 class=article-title>
<a href=/blog/aws/aws_eks_elb/>EKS K8sì—ì„œ ELB(ALB, NLB) ì œëŒ€ë¡œ ì„¤ì •í•˜ë©° ì‚¬ìš©í•˜ê¸°</a>
</h2>
<h3 class=article-subtitle>
`ë°ë¸Œì˜µìŠ¤` ì¸í„´ìœ¼ë¡œ ê·¼ë¬´í•œ ì§€ê°€ ë²Œì¨ ë‘ ë‹¬ì´ ë˜ì–´ê°‘ë‹ˆë‹¤. ì´ê²ƒ ì €ê²ƒ ë°°ìš´ ê²ƒì´ ë§ì•˜ë˜ ì‹œê°„ì´ì—ˆëŠ”ë°, ê·¸ ì¤‘ ê½¤ë‚˜ ì‚½ì§ˆì„ í–ˆë˜ `Kubernetes` ì™€ `ELB`ë¥¼ ì´ìš©í•˜ëŠ” ë¶€ë¶„ì— ëŒ€í•´ ì •ë¦¬ë¥¼ í•´ë³¼ê¹Œí•©ë‹ˆë‹¤. `jenkins`, `spinnaker`, `argo`, `terraform`, `ansible`, `github action`, ... ë“±ë“± ë‹¤ì–‘í•œ ë‚´ìš©ì„ ê²½í—˜í•  ìˆ˜ ìˆë˜ ì‹œê°„ì´ì—ˆì§€ë§Œ, ê·¸ ì¤‘ kubernetesì—ì„œ ë¬´ìŠ¨ ì‘ì—…ì„ í•˜ë˜ ë¹¼ë†“ì„ ìˆ˜ ì—†ìœ¼ë©´ì„œ ì–´ë”˜ê°€ ê¹”ë”íˆ ê·¸ íë¦„ì´ ì •ë¦¬ëœ ê³³ì„ ë³´ê¸° í˜ë“¤ì—ˆë˜ **serviceë¥¼ ELBì— ì—°ê²°**í•˜ê¸°ì— ëŒ€í•œ ë‚´ìš©ì„ ì •ë¦¬í•´ë³´ê² ìŠµë‹ˆë‹¤.
*ë³¸ í¬ìŠ¤íŠ¸ëŠ” EKSë¥¼ í†µí•´ K8së¥¼ ì´ìš©í•  ë•Œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì„¤ëª…í•©ë‹ˆë‹¤.*
</h3>
<footer class=article-time><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--published>Sep 06, 2020</time>
</footer></div>
</header>
<section class=article-content>
<h2 id=-ì‹œì‘í•˜ë©°>ğŸ¶ ì‹œì‘í•˜ë©°</h2>
<blockquote>
<p>ë³¸ ê²Œì‹œê¸€ì€ AWS ëŒ€í•™ìƒ ìœ ì €ê·¸ë£¹ì¸ <a class=link href=https://velog.io/@ausg target=_blank rel=noopener>AUSG</a>ì˜ í™œë™ ì¤‘
í•˜ë‚˜ë¡œì„œ ë³¸ì¸(ë°•ì§„ìˆ˜)ì´ ì‘ì„±í•œ ê²Œì‹œë¬¼ì„ í¬ì›Œë”©í•œ ê²ƒì…ë‹ˆë‹¤.</p>
</blockquote>
<p><figure style=flex-grow:185;flex-basis:444px>
<a href=/blog/aws/aws_eks_elb/preview.png data-size=2032x1097><img src=/blog/aws/aws_eks_elb/preview.png srcset="/blog/aws/aws_eks_elb/preview_huc38b74e19f60c2848e88837c4c6920fa_1709468_480x0_resize_box_3.png 480w, /blog/aws/aws_eks_elb/preview_huc38b74e19f60c2848e88837c4c6920fa_1709468_1024x0_resize_box_3.png 1024w" width=2032 height=1097 loading=lazy alt=preview.png>
</a>
<figcaption>preview.png</figcaption>
</figure></p>
<p><code>ë°ë¸Œì˜µìŠ¤</code> ì¸í„´ìœ¼ë¡œ ê·¼ë¬´í•œ ì§€ê°€ ë²Œì¨ ë‘ ë‹¬ì´ ë˜ì–´ê°‘ë‹ˆë‹¤. ì´ê²ƒ ì €ê²ƒ ë°°ìš´ ê²ƒì´ ë§ì•˜ë˜ ì‹œê°„ì´ì—ˆëŠ”ë°, ê·¸ ì¤‘ ê½¤ë‚˜ ì‚½ì§ˆì„ í–ˆë˜ <code>Kubernetes</code> ì™€ <code>ELB</code>ë¥¼ ì´ìš©í•˜ëŠ” ë¶€ë¶„ì— ëŒ€í•´ ì •ë¦¬ë¥¼ í•´ë³¼ê¹Œí•©ë‹ˆë‹¤. <code>jenkins</code>, <code>spinnaker</code>, <code>argo</code>, <code>terraform</code>, <code>ansible</code>, <code>github action</code>, &mldr; ë“±ë“± ë‹¤ì–‘í•œ ë‚´ìš©ì„ ê²½í—˜í•  ìˆ˜ ìˆë˜ ì‹œê°„ì´ì—ˆì§€ë§Œ, ê·¸ ì¤‘ kubernetesì—ì„œ ë¬´ìŠ¨ ì‘ì—…ì„ í•˜ë˜ ë¹¼ë†“ì„ ìˆ˜ ì—†ìœ¼ë©´ì„œ ì–´ë”˜ê°€ ê¹”ë”íˆ ê·¸ íë¦„ì´ ì •ë¦¬ëœ ê³³ì„ ë³´ê¸° í˜ë“¤ì—ˆë˜ <strong>serviceë¥¼ ELBì— ì—°ê²°</strong>í•˜ê¸°ì— ëŒ€í•œ ë‚´ìš©ì„ ì •ë¦¬í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<p><em>ë³¸ í¬ìŠ¤íŠ¸ëŠ” EKSë¥¼ í†µí•´ K8së¥¼ ì´ìš©í•  ë•Œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì„¤ëª…í•©ë‹ˆë‹¤.</em></p>
<h2 id=-eks-ì—ì„œ-elbë¥¼-ì‚¬ìš©í•´-ì„œë¹„ìŠ¤ë¥¼-ë…¸ì¶œí‚¬-ë•Œ-ìœ ì˜ì‚¬í•­ë“¤>ğŸ’ğŸ»â€â™‚ï¸ EKS ì—ì„œ ELBë¥¼ ì‚¬ìš©í•´ ì„œë¹„ìŠ¤ë¥¼ ë…¸ì¶œí‚¬ ë•Œ ìœ ì˜ì‚¬í•­ë“¤</h2>
<blockquote>
<p>ğŸ§ : " <code>ELB</code>, <code>NLB</code>, <code>ALB</code> ëŒ€ì²´ ë­ê°€ ë‹¤ë¥¸ ê±°ì•¼..?ã…œã…œ <strong>ì¿ ë²„ë„¤í‹°ìŠ¤</strong>ë¥¼ ì“¸ ë•ŒëŠ” ì–´ë–»ê²Œ ì–˜ë„¤ë¥¼ ì§€ì •í•˜ëŠ” ê±°ì§€..? <code>kubectl expose deploy {{deployment_name}} --type=LoadBalancer</code> í•˜ë©´ ê·¸ëƒ¥ ì‘ë™ì€ í•˜ë˜ë°&mldr;"</p>
</blockquote>
<p><code>EKS</code>ì—ì„œ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” <code>ELB</code>ëŠ” L4ì˜ <code>NLB</code>ì™€ L7ì˜ <code>ALB</code> ì…ë‹ˆë‹¤. ALBê°€ L7ì— ëŒ€í•œ ì¢€ ë” ë‹¤ì–‘í•œ ì„¤ì •ì´ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— ì¡°ê±´ì´ ë§ê¸°ë„ í•˜ê³ , AWSì˜ ALBë§Œì„ ìœ„í•œ <code>alb-ingress-controller</code>ë¼ëŠ” ë…€ì„ì´ ì§ì ‘ <code>Ingress</code>ì˜ ì„¤ì •ë“¤ì„ ê´€ë¦¬í•´ì£¼ê¸° ë•Œë¬¸ì— ì„¤ì •í•  ìˆ˜ ìˆëŠ” ì˜µì…˜ë„ ë§ìŠµë‹ˆë‹¤. ì¢‹ê²Œ ë³´ë©´ ë§ì€ ì„¤ì •ì„ í•  ìˆ˜ ìˆê³ , ë‚˜ì˜ê²Œ ë³´ë©´ ì´ˆë³´ìì—ê² ê·€ì°®ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. <code>NLB</code>ëŠ” ë¹„êµì  ì„¤ì •ì´ ì ê³  ë”°ë¼ì„œ ì„¤ì •í•´ì¤„ ìˆ˜ ìˆëŠ” í•­ëª©ë„ ì ìŠµë‹ˆë‹¤.</p>
<p>ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œ ë‹¤ì–‘í•œ ì‘ì—…ì„ í•˜ë©´ì„œ ë‹¤ì–‘í•œ controllerì„ ì ‘í•˜ê²Œ ë˜ê³ , ê·¸ë ‡ê²Œ ë  ìˆ˜ë¡ <code>annotation</code>ìœ¼ë¡œ ë§ì€ ì„¤ì •ì„ í•˜ê²Œ ë©ë‹ˆë‹¤. k8së¥¼ ì²˜ìŒ ì ‘í•  ë•Œì—ëŠ” annotationì— ëŒ€í•œ ì •ì˜ë¡œì„œ ì•„ë˜ì™€ ê°™ì€ ë¬¸ì¥ì„ ì ‘í•  ìˆ˜ ìˆê³ , ë§ˆì¹˜ ê¸°ëŠ¥ê³¼ í¬ê²Œ ìƒê´€ì´ ì—†ì„ ê²ƒì²˜ëŸ¼ ëŠê»´ì§€ê¸°ë„ í•˜ì§€ë§Œ ì‚¬ì‹¤ EKSë¥¼ ë¹„ë¡¯í•œ ì—¬ëŸ¬ ì„œë¹„ìŠ¤ì—ì„œëŠ” annotationì„ ì´ìš©í•´ ì¤‘ìš”í•œ ì„¤ì • ë“±ì„ ê¸°ì…í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì˜ ì„¤ì •í•´ì£¼ì–´ì•¼í•©ë‹ˆë‹¤. ELBë˜í•œ ëª¨ë“  ì„¤ì •ì´ annotationìœ¼ë¡œ ë™ì‘í•œë‹¤.</p>
<blockquote>
<p>" <code>Label</code>ì„ ì‚¬ìš©í•˜ì—¬ ì˜¤ë¸Œì íŠ¸ë¥¼ ì„ íƒí•˜ê³ , íŠ¹ì • ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ì˜¤ë¸Œì íŠ¸ ì»¬ë ‰ì…˜ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤. ë°˜ë©´ì—, <code>annotation</code>ì€ ì˜¤ë¸Œì íŠ¸ë¥¼ ì‹ë³„í•˜ê³  ì„ íƒí•˜ëŠ”ë° ì‚¬ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤. ì–´ë…¸í…Œì´ì…˜ì˜ ë©”íƒ€ë°ì´í„°ëŠ” ì‘ê±°ë‚˜ í¬ê³ , êµ¬ì¡°ì ì´ê±°ë‚˜ êµ¬ì¡°ì ì´ì§€ ì•Šì„ ìˆ˜ ìˆìœ¼ë©°, ë ˆì´ë¸”ì—ì„œ í—ˆìš©ë˜ì§€ ì•ŠëŠ” ë¬¸ìë¥¼ í¬í•¨í•  ìˆ˜ ìˆë‹¤."</p>
</blockquote>
<h3 id=-albë¥¼-ì‚¬ìš©í• -ë•Œ-ìœ ì˜í• -ì >âš ï¸ ALBë¥¼ ì‚¬ìš©í•  ë•Œ ìœ ì˜í•  ì </h3>
<blockquote>
<p>ì–´ë–¤ ì˜µì…˜ë“¤ì´ ìˆê³ , ê¸°ë³¸ì ìœ¼ë¡œëŠ” ì–´ë–»ê²Œ ì„¤ì •ë˜ëŠ” ì§€ì— ëŒ€í•œ ì´í•´ê°€ ìˆì–´ì•¼ ì˜¤ë¥˜ ê³¼ì •ì„ ì¶”ì í•˜ê¸° ì‰¬ìš°ë¯€ë¡œ ê¸°ë³¸ì ìœ¼ë¡œ ALBë¥¼ AWS Consoleì—ì„œ ì‚¬ìš©í•´ë³¸ ë’¤ì— ì„¤ì •í•  ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤.</p>
</blockquote>
<ul>
<li><code>alb ingress controller</code>ê°€ ìƒì„±í•  ALBê°€ ì‚¬ìš©í•  ì„œë¸Œë„·ì„ discoverí•˜ê¸° ìœ„í•´ì„œëŠ” <strong>ì˜¬ë°”ë¥¸ íƒœê·¸ê°€ ë‹¬ë¦° subnet</strong>ì´ ì¡´ì¬í•´ì•¼í•œë‹¤.</li>
<li>node í˜¹ì€ <code>alb ingress controller</code>ì— ì—°ê²°ëœ service accountê°€ albë¥¼ ì œì–´í•˜ê¸° ìœ„í•œ <strong>iam permission</strong>ì´ ë¶€ì—¬ë˜ì–´ì•¼í•œë‹¤.</li>
<li>internet facingí•œ albë¥¼ ë§Œë“¤ì§€ internalí•œ albë¥¼ ë§Œë“¤ì§€ ê³ ë¯¼í•´ë´ì•¼í•œë‹¤.</li>
<li><code>alb ingress controller</code>ì˜ logë¥¼ í†µí•´ ì‘ì—…ì— ëŒ€í•œ logë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.</li>
</ul>
<h3 id=-nlb-clbë¥¼-ì‚¬ìš©í• -ë•Œ-ìœ ì˜í• -ì >âš ï¸ NLB, CLBë¥¼ ì‚¬ìš©í•  ë•Œ ìœ ì˜í•  ì </h3>
<p><a class=link href=https://kubernetes.io/ko/docs/concepts/services-networking/service/#aws-nlb-support target=_blank rel=noopener>https://kubernetes.io/ko/docs/concepts/services-networking/service/#aws-nlb-support</a></p>
<p><a class=link href=https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/load-balancing.html target=_blank rel=noopener>https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/load-balancing.html</a></p>
<ul>
<li><code>NLB</code>, <code>CLB</code>ê°€ ì‚¬ìš©í•  ì„œë¸Œë„·ì„ ì„¤ì •í•˜ê¸° ìœ„í•´ì„œëŠ” <strong>ì˜¬ë°”ë¥¸ íƒœê·¸ê°€ ë‹¬ë¦° subnet</strong>ì´ ì¡´ì¬í•´ì•¼í•œë‹¤.</li>
<li>ì–´ëŠ ë¶€ë¶„ì—ì„ ê°€ NLB, CLBë¥¼ ì œì–´í•˜ê¸° ìœ„í•œ <strong>iam permission</strong>ì´ ë¶€ì—¬ë˜ì–´ì•¼í•œë‹¤. (ì–´ëŠ ë¶€ë¶„ì¸ì§€ í™•ì‹¤íˆëŠ” ëª¨ë¥´ê² ìŒ. ë”°ë¡œ ì„¤ì •ì•ˆí•´ë„ ë™ì‘í•˜ëŠ” ê²ƒì„ ë³´ì•„ worker nodeê°€ ê°–ëŠ” iam roleì— permissionì´ ë¶™ì–´ìˆì„ ê²ƒìœ¼ë¡œ ì˜ˆìƒë¨)</li>
</ul>
<h2 id=-albë¥¼-ì‚¬ìš©í•´-ì„œë¹„ìŠ¤ë¥¼-ë…¸ì¶œì‹œí‚¤ëŠ”-ë°©ë²•>ğŸŒ ALBë¥¼ ì‚¬ìš©í•´ ì„œë¹„ìŠ¤ë¥¼ ë…¸ì¶œì‹œí‚¤ëŠ” ë°©ë²•</h2>
<blockquote>
<p>ğŸ˜Š <code>ALB</code>ëŠ” K8sì— ì¹œìˆ™í•˜ì§€ ì•Šìœ¼ì‹  ë¶„ë“¤ê»˜ëŠ” ë‹¤ì†Œ ì§„ì…ì¥ë²½ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëƒ¥ ì„œë¹„ìŠ¤ë¥¼ ë…¸ì¶œì‹œí‚¬ ë•ŒëŠ” êµ³ì´ ì‚¬ìš©í•  í•„ìš” ì—†ëŠ” <code>Ingress</code> ë¼ëŠ” ì˜¤ë¸Œì íŠ¸ë„ ê´€ë¦¬í•´ì•¼í•˜ê³ , <code>alb-ingress-contoller</code>ë¼ëŠ” ë…€ì„ë„ ë°°í¬í•´ì•¼í•˜ë©° ì„¤ì •ì´ ë‹¤ì–‘í•˜ê¸° ë•Œë¬¸ì´ì£ ! ğŸ’¦</p>
</blockquote>
<p>K8sì—ì„œ EKSë¥¼ ì‚¬ìš©í•´ <code>ALB</code>ë¥¼ ì´ìš©í•˜ê³ ì‹¶ì€ ê²½ìš° <code>alb-ingress-controller</code>ì„ ë°°í¬í•œ ë’¤, <code>Ingress</code>ë¥¼ í†µí•´ ì‚¬ìš©í•  albì— ëŒ€í•œ ruleì„ ì„¤ì •ì„ í•´ì£¼ì–´ì•¼í•©ë‹ˆë‹¤.</p>
<p><a class=link href=https://kubernetes-sigs.github.io/aws-alb-ingress-controller/guide/controller/setup/ target=_blank rel=noopener>https://kubernetes-sigs.github.io/aws-alb-ingress-controller/guide/controller/setup/</a> ì˜ ë‚´ìš©ì„ ë²„ë¦´ ë¶€ë¶„ì´ í•˜ë‚˜ë„ ì—†ìŠµë‹ˆë‹¤. ìœ„ ë§í¬ë¥¼ í†µí•´ alb-ingress-controllerì— ëŒ€í•œ ê°œë…ì„ ì¡ê³  ë°°í¬í•´ë´…ë‹ˆë‹¤. <code>alb-ingress-controller.yaml</code>ì˜ ì¸ìë¥¼ ì ì ˆíˆ ìˆ˜ì •í•´ì£¼ì–´ì•¼í•©ë‹ˆë‹¤.</p>
<p>ALBê°€ ì•„ë‹Œ k8s cluster ìƒì—ì„œ L7 LoadBalancerë¥¼ ì´ìš©í•˜ëŠ” ê²½ìš°ì—ëŠ” nginx ingress controllerë“±ì„ ì´ìš©í•˜ë©° nginx ì— ì ìš©í•  ruleì„ <code>Ingress</code>ë¼ëŠ” K8s Objectë¥¼ í†µí•´ ì„¤ì •í•©ë‹ˆë‹¤. ingress controllerì˜ ì„¤ì •ì—ì„œ ìì‹ ì˜ class nameì„ ì ì–´ì£¼ê³ , <code>Ingress</code>ì—ì„œëŠ” ì–´ë–¤ class nameì˜ ingress controllerì—ì„œ ìì‹ (Ingressì´ì Rule)ì„ ì ìš©í•˜ë„ë¡ í•  ì§€ë¥¼ annotationì„ í†µí•´ ì„¤ì •í•˜ê±°ë‚˜ ingressClassNameì´ë¼ëŠ” í•„ë“œë¥¼ í†µí•´ ì„¤ì •í•©ë‹ˆë‹¤.(ingress ì„¤ì •ì— ëŒ€í•œ ì°¸ê³  - <a class=link href=https://kubernetes.io/ko/docs/concepts/services-networking/ingress/#%EC%9D%B8%EA%B7%B8%EB%A0%88%EC%8A%A4-%ED%81%B4%EB%9E%98%EC%8A%A4 target=_blank rel=noopener>https://kubernetes.io/ko/docs/concepts/services-networking/ingress/#ì¸ê·¸ë ˆìŠ¤-í´ë˜ìŠ¤</a>)</p>
<p>ì´ì™€ ê°™ì€ ê²½ìš°ì—ëŠ” ingress controllerê°€ ì§ì ‘ ingressì— ëª…ì‹œëœ ruleì„ ì´ìš©í–ˆì§€ë§Œ, <strong>alb-ingress-controller</strong>ì˜ ê²½ìš°ëŠ” alb-ingress-controllerê°€ nginx-ingress-controllerì²˜ëŸ¼ <strong>ì§ì ‘ ì›¹ì„œë²„ì˜ ì—­í• ì„ í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ</strong>, ingressì— ëª…ì‹œëœ ruleì„ ì´ìš©í•˜ëŠ” <strong>ALBë¥¼ ìƒì„±í•˜ê³  ê´€ë¦¬</strong>í•˜ëŠ” ì—­í• ì„ í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ ë¶€ë¶„ì´ ì²˜ìŒì—ëŠ” ë‹¤ì†Œ í—·ê°ˆë¦¬ê²Œ ëŠê»´ì§ˆ ìˆ˜ ìˆê¸°ì— ê¸¸ê²Œ ì„œìˆ í•´ë³´ì•˜ìŠµë‹ˆë‹¤.</p>
<p>ì‹¤ì œë¡œ ingressë¥¼ ìƒì„±í•œ ë’¤ ì•ì—ì„œ ë°°í¬í•œ alb-ingress-controllerì˜ logë¥¼ ë³´ë©´ albë¥¼ ê´€ë¦¬í•˜ê¸°ìœ„í•œ ì—¬ëŸ¬ ì‘ì—…ì„ ìˆ˜í–‰ì¤‘ì¸ ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ê·¸ëŸ¼ ì´ì œ ì‹¤ì œë¡œ alb ingress controllerì„ í†µí•´ albë¥¼ ì´ìš©í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<h3 id=albë¥¼-ì›í™œíˆ-ì œì–´í•˜ê¸°-ìœ„í•œ-permission-ë¶€ì—¬>ALBë¥¼ ì›í™œíˆ ì œì–´í•˜ê¸° ìœ„í•œ permission ë¶€ì—¬</h3>
<ul>
<li>ALB iam ì •ì±… ì°¸ê³ 
<ul>
<li><a class=link href=https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/alb-ingress.html target=_blank rel=noopener>https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/alb-ingress.html</a></li>
<li><a class=link href=https://raw.githubusercontent.com/kubernetes-sigs/aws-alb-ingress-controller/v1.1.2/docs/examples/iam-policy.json target=_blank rel=noopener>https://raw.githubusercontent.com/kubernetes-sigs/aws-alb-ingress-controller/v1.1.2/docs/examples/iam-policy.json</a></li>
</ul>
</li>
</ul>
<p><code>ALB</code>ë¥¼ ì œì–´í•˜ê¸° ìœ„í•´ì„œëŠ” awsì˜ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ì–´ë– í•œ permissionì´ í•„ìš”í•©ë‹ˆë‹¤. <code>node</code>ì— ë¶€ì—¬í•  ìˆ˜ë„ ìˆê³ , IAM Userì— ë¶€ì—¬í•œ ë’¤ <code>alb ingress controller</code>ì˜ ì„¤ì •ì—ì„œ í•´ë‹¹ IAM Userì˜ Keyë¥¼ ë¶€ì—¬í•  ìˆ˜ë„ ìˆê³ , Service accountì™€ IAM Roleì„ <code>OIDC</code>(OpenID Connectë¥¼ ì´ìš©í•´ Service accountì™€ IAM Roleì„ ì—°ê²°ì‹œí‚¤ëŠ” ì‘ì—…)ë¥¼ ì´ìš©í•´ ì—®ì€ ë’¤, alb ingress controller podì— í•´ë‹¹ Service Accountë¥¼ ë¶€ì—¬í•  ìˆ˜ë„ ìˆì§€ë§Œ ë’¤ì˜ ë°©ë²•ë“¤ì€ ì¢€ íŠœí† ë¦¬ì–¼ì¹˜ê³  íˆ¬ë¨¸ì¹˜í•œ ê°ì´ ìˆê¸°ë•Œë¬¸ì—, ê°„ë‹¨íˆ nodeì— Permissionì„ ë¶€ì—¬í•˜ë„ë¡í•˜ê² ìŠµë‹ˆë‹¤.</p>
<p><figure style=flex-grow:149;flex-basis:359px>
<a href=/blog/aws/aws_eks_elb/iam.png data-size=797x532><img src=/blog/aws/aws_eks_elb/iam.png srcset="/blog/aws/aws_eks_elb/iam_hu9ac6964ec6844f4165a3f6a7be3b3a23_55018_480x0_resize_box_3.png 480w, /blog/aws/aws_eks_elb/iam_hu9ac6964ec6844f4165a3f6a7be3b3a23_55018_1024x0_resize_box_3.png 1024w" width=797 height=532 loading=lazy alt=iam.png>
</a>
<figcaption>iam.png</figcaption>
</figure></p>
<p>worker nodeë“¤ì´ ì´ìš©í•˜ëŠ” IAM Roleì— Policyë¥¼ ì¶”ê°€í•œ ëª¨ìŠµ.</p>
<h3 id=albê°€-ì‚¬ìš©í• -subnetì—-ì ì ˆí•œ-íƒœê·¸-ë‹¬ê¸°>albê°€ ì‚¬ìš©í•  subnetì— ì ì ˆí•œ íƒœê·¸ ë‹¬ê¸°</h3>
<p><a class=link href=https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/alb-ingress.html target=_blank rel=noopener>https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/alb-ingress.html</a> ì— ë‚˜ì™€ìˆë“¯ì´ ELBê°€ ì´ìš©í•˜ëŠ” ì„œë¸Œë„·ì„ ìë™ìœ¼ë¡œ ì„¤ì •ë˜ë„ë¡ í•˜ê¸° ìœ„í•´ì„œëŠ” ì‚¬ìš©í•˜ê³ ì í•˜ëŠ” ì„œë¸Œë„·ì— ì•„ë˜ì™€ ê°™ì€ íƒœê·¸ë“¤ì„ ë‹¬ì•„ì£¼ì–´ì•¼í•œë‹¤.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=nx>kubernetes</span><span class=p>.</span><span class=nx>io</span><span class=o>/</span><span class=nx>cluster</span><span class=o>/</span><span class=p>&lt;</span><span class=nt>cluster</span><span class=err>-</span><span class=na>name</span><span class=p>&gt;</span> <span class=o>=</span> <span class=nx>shared</span> <span class=o>|</span> <span class=nx>owned</span> <span class=err>#</span> <span class=nx>Required</span>
<span class=nx>kubernetes</span><span class=p>.</span><span class=nx>io</span><span class=o>/</span><span class=nx>role</span><span class=o>/</span><span class=nx>internal</span><span class=o>-</span><span class=nx>elb</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>|</span> <span class=s2>&#34;&#34;</span> <span class=err>#</span> <span class=nx>Optional</span><span class=p>,</span> <span class=k>for</span> <span class=nx>internal</span> <span class=nx>alb</span>
<span class=nx>kubernetes</span><span class=p>.</span><span class=nx>io</span><span class=o>/</span><span class=nx>role</span><span class=o>/</span><span class=nx>elb</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>|</span> <span class=s2>&#34;&#34;</span> <span class=err>#</span> <span class=nx>Optional</span><span class=p>,</span> <span class=k>for</span> <span class=nx>internet</span><span class=o>-</span><span class=nx>facing</span> <span class=nx>alb</span>
</code></pre></div><p><code>a | b</code>ì™€ ê°™ì€ í‘œí˜„ì€ a ë‚˜ bì¤‘ í•œ ê°’ì„ ê°€ì ¸ì•¼í•œë‹¤ëŠ” ì˜ë¯¸ë¡œ í‘œí˜„í•œ ê²ƒì…ë‹ˆë‹¤.</p>
<p><figure style=flex-grow:164;flex-basis:393px>
<a href=/blog/aws/aws_eks_elb/tag.png data-size=714x435><img src=/blog/aws/aws_eks_elb/tag.png srcset="/blog/aws/aws_eks_elb/tag_hu2bbb23500c440a1ae11b9e8cf9268536_37002_480x0_resize_box_3.png 480w, /blog/aws/aws_eks_elb/tag_hu2bbb23500c440a1ae11b9e8cf9268536_37002_1024x0_resize_box_3.png 1024w" width=714 height=435 loading=lazy alt=tag.png>
</a>
<figcaption>tag.png</figcaption>
</figure></p>
<p>internet facing ALBë§Œ ì´ìš©í•  ê²ƒì´ê¸° ë•Œë¬¸ì— <a class=link href=http://kubernetes.io/role/internal-elb target=_blank rel=noopener><code>kubernetes.io/role/internal-elb</code></a> tagëŠ” ìƒëµí•˜ê³  íƒœê·¸ë¥¼ ë‹¬ì•„ì¤€ ëª¨ìŠµ.</p>
<p>subnetì— ALBë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ íƒœê·¸ë¥¼ ì œëŒ€ë¡œ ë‹¬ì•„ì£¼ì§€ ì•Šì„ ê²½ìš° alb-ingress-controller ì—ì„œ ì•„ë˜ì™€ ê°™ì€ ë¡œê·¸ë¥¼ ë³´ê²Œ ë©ë‹ˆë‹¤. ALBê°€ ìƒì„±ë˜ì§€ë„ ì•ŠìŠµë‹ˆë‹¤.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=nx>controller</span><span class=p>.</span><span class=nx>go</span><span class=o>:</span><span class=mi>217</span><span class=p>]</span> <span class=nx>kubebuilder</span><span class=o>/</span><span class=nx>controller</span> <span class=s2>&#34;msg&#34;</span><span class=o>=</span><span class=s2>&#34;Reconciler error&#34;</span> <span class=s2>&#34;error&#34;</span><span class=o>=</span><span class=err>&#34;</span><span class=nx>failed</span> <span class=nx>to</span> <span class=nx>build</span> <span class=nx>LoadBalancer</span> <span class=nx>configuration</span> <span class=nx>due</span> <span class=nx>to</span> <span class=nx>failed</span> <span class=nx>to</span> <span class=nx>resolve</span> <span class=mi>2</span> <span class=nx>qualified</span> <span class=nx>subnet</span> <span class=k>for</span> <span class=nx>ALB</span><span class=p>.</span> <span class=nx>Subnets</span> <span class=nx>must</span> <span class=nx>contains</span> <span class=nx>these</span> <span class=nx>tags</span><span class=o>:</span> <span class=s1>&#39;kubernetes.io/cluster/umi-dev&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;shared&#39;</span> <span class=nx>or</span> <span class=s1>&#39;owned&#39;</span><span class=p>]</span> <span class=nx>and</span> <span class=s1>&#39;kubernetes.io/role/internal-elb&#39;</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;&#39;</span> <span class=nx>or</span> <span class=s1>&#39;1&#39;</span><span class=p>]</span>
</code></pre></div><h3 id=alb-ingress-controller-ë°°í¬í•˜ê¸°>alb ingress controller ë°°í¬í•˜ê¸°.</h3>
<blockquote>
<p>ìŠ¬ìŠ¬ ì½ê¸° ê·€ì°®ì•„ì§ˆ íƒ€ì´ë°ì…ë‹ˆë‹¤. &lsquo;<em>ìš”ë†ˆì´ IAM policyë„ ë§Œë“¤ê³ , ì„œë¸Œë„·ì— ì—„í•œ íƒœê·¸ë¥¼ ë‹¬ë”ë‹ˆ ì´ì œëŠ” í•˜,,, ë­˜ ë˜ ë°°í¬í•˜ë¼ê³  í•˜ëŠ”êµ¬ë‚˜ ì•„ì´ê³  ë‚´ ëˆˆì•„,,,</em>&rsquo; ì‹¶ê² ì§€ë§Œ, ì¢€ ë” í˜ì„ ë‚´ì–´ë´…ì‹œë‹¤ ğŸ»</p>
</blockquote>
<p><a class=link href=https://kubernetes-sigs.github.io/aws-alb-ingress-controller/guide/controller/setup/ target=_blank rel=noopener>https://kubernetes-sigs.github.io/aws-alb-ingress-controller/guide/controller/setup/</a> ë¥¼ ì°¸ê³ í•˜ì—¬ <code>Deployment</code> ë‚´ì˜ containerì˜ <code>args</code>ë¥¼ ìì‹ ì˜ ìƒí™©ì— ë§ê²Œ ìˆ˜ì •í•œ ë’¤ ë°°í¬í•´ì¤ë‹ˆë‹¤.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=p>...</span>
  <span class=nx>args</span><span class=o>:</span>
    <span class=o>-</span> <span class=o>--</span><span class=nx>ingress</span><span class=o>-</span><span class=kr>class</span><span class=o>=</span><span class=nx>alb</span> <span class=err>#</span> <span class=nx>ingressì˜</span> <span class=nx>annotationì—</span> <span class=nx>ëª…ì‹œí• </span> <span class=kr>class</span> <span class=nx>name</span>
    <span class=o>-</span> <span class=o>--</span><span class=nx>cluster</span><span class=o>-</span><span class=nx>name</span><span class=o>=</span><span class=nx>umi</span><span class=o>-</span><span class=nx>dev</span> <span class=err>#</span> <span class=nx>eks</span> <span class=nx>cluster</span> <span class=nx>name</span>
    <span class=o>-</span> <span class=o>--</span><span class=nx>aws</span><span class=o>-</span><span class=nx>region</span><span class=o>=</span><span class=nx>ap</span><span class=o>-</span><span class=nx>northeast</span><span class=o>-</span><span class=mi>2</span>
    <span class=o>-</span> <span class=o>--</span><span class=nx>aws</span><span class=o>-</span><span class=nx>api</span><span class=o>-</span><span class=nx>debug</span><span class=o>=</span><span class=kc>true</span>
</code></pre></div><p>ì €ëŠ” ìœ„ì™€ ê°™ì€ ì‹ìœ¼ë¡œ ì„¤ì •í•´ì£¼ì—ˆê³ , ì˜ ë°°í¬ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ë´…ë‹ˆë‹¤.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=nx>$</span> <span class=nx>kubectl</span> <span class=nx>get</span> <span class=nx>po</span> <span class=o>-</span><span class=nx>A</span> <span class=o>|</span> <span class=nx>grep</span> <span class=nx>alb</span>
<span class=nx>kube</span><span class=o>-</span><span class=nx>system</span>   <span class=nx>alb</span><span class=o>-</span><span class=nx>ingress</span><span class=o>-</span><span class=nx>controller</span><span class=o>-</span><span class=mi>594</span><span class=nx>f84b465</span><span class=o>-</span><span class=nx>q4qjb</span>   <span class=mi>1</span><span class=o>/</span><span class=mi>1</span>     <span class=nx>Running</span>   <span class=mi>0</span>          <span class=mi>106</span><span class=nx>m</span>
</code></pre></div><h3 id=ë…¸ì¶œì‹œí‚¬-ì„œë¹„ìŠ¤-ë°°í¬í•˜ê¸°>ë…¸ì¶œì‹œí‚¬ ì„œë¹„ìŠ¤ ë°°í¬í•˜ê¸°</h3>
<p>ê°„ë‹¨í•˜ê²Œ <code>Nginx</code>ë¥¼ ë°°í¬í•´ë³´ë¡í•˜ê² ìŠµë‹ˆë‹¤.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=nx>apiVersion</span><span class=o>:</span> <span class=nx>v1</span>
<span class=nx>kind</span><span class=o>:</span> <span class=nx>Service</span>
<span class=nx>metadata</span><span class=o>:</span>
  <span class=nx>name</span><span class=o>:</span> <span class=nx>ingress</span><span class=o>-</span><span class=nx>test</span>
<span class=nx>spec</span><span class=o>:</span>
  <span class=nx>selector</span><span class=o>:</span>
    <span class=nx>app</span><span class=o>:</span> <span class=nx>nginx</span>
  <span class=nx>ports</span><span class=o>:</span>
    <span class=o>-</span> <span class=nx>protocol</span><span class=o>:</span> <span class=nx>TCP</span>
      <span class=nx>port</span><span class=o>:</span> <span class=mi>80</span>
      <span class=nx>targetPort</span><span class=o>:</span> <span class=mi>80</span>
      <span class=nx>nodePort</span><span class=o>:</span> <span class=mi>30010</span>
  <span class=nx>type</span><span class=o>:</span> <span class=nx>NodePort</span>

<span class=o>---</span>
<span class=nx>apiVersion</span><span class=o>:</span> <span class=nx>apps</span><span class=o>/</span><span class=nx>v1</span>
<span class=nx>kind</span><span class=o>:</span> <span class=nx>Deployment</span>
<span class=nx>metadata</span><span class=o>:</span>
  <span class=nx>name</span><span class=o>:</span> <span class=nx>ingress</span><span class=o>-</span><span class=nx>test</span>
  <span class=nx>labels</span><span class=o>:</span>
    <span class=nx>app</span><span class=o>:</span> <span class=nx>nginx</span>
<span class=nx>spec</span><span class=o>:</span>
  <span class=nx>replicas</span><span class=o>:</span> <span class=mi>3</span>
  <span class=nx>selector</span><span class=o>:</span>
    <span class=nx>matchLabels</span><span class=o>:</span>
      <span class=nx>app</span><span class=o>:</span> <span class=nx>nginx</span>
  <span class=nx>template</span><span class=o>:</span>
    <span class=nx>metadata</span><span class=o>:</span>
      <span class=nx>labels</span><span class=o>:</span>
        <span class=nx>app</span><span class=o>:</span> <span class=nx>nginx</span>
    <span class=nx>spec</span><span class=o>:</span>
      <span class=nx>containers</span><span class=o>:</span>
      <span class=o>-</span> <span class=nx>name</span><span class=o>:</span> <span class=nx>nginx</span>
        <span class=nx>image</span><span class=o>:</span> <span class=nx>nginx</span>
        <span class=nx>ports</span><span class=o>:</span>
        <span class=o>-</span> <span class=nx>containerPort</span><span class=o>:</span> <span class=mi>80</span>
</code></pre></div><p>ALBëŠ” ê¸°ë³¸ì ìœ¼ë¡œ <strong>nodeì˜ Port</strong>ë¥¼ AWS ìƒì˜ <code>target group</code>ìœ¼ë¡œì„œ ì´ìš©í•˜ê¸° ë•Œë¬¸ì—, ingressë¥¼ í†µí•´ ë…¸ì¶œì‹œì¼œì¤„ ì„œë¹„ìŠ¤ëŠ” ì ì–´ë„ <code>NodePort</code> íƒ€ì…ìœ¼ë¡œ ë…¸ì¶œë˜ì–´ìˆì–´ì•¼ <code>ALB ingress controller</code>ê°€ í•´ë‹¹ ì„œë¹„ìŠ¤ë¥¼ ë…¸ì¶œì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.(target typeì„ ê¸°ë³¸ê°’ì¸ <code>instance</code>ê°€ ì•„ë‹ˆë¼ <code>IP</code>ë¡œ ì„¤ì •í•˜ë©´, Podì˜ IPë¡œ íŠ¸ë˜í”½ì´ í˜ëŸ¬ê°€ê²Œ í•  ìˆ˜ëŠ” ìˆìŠµë‹ˆë‹¤.)</p>
<p>ì‘ë™ë°©ì‹ì„ ì„¤ëª…í•´ë³´ìë©´ ingress ëŠ” service nameê³¼ service portë¥¼ ì„¤ì •ìœ¼ë¡œ ë°›ìŠµë‹ˆë‹¤. alb-ingress-controllerëŠ” ê·¸ëŸ¬ë©´ í•´ë‹¹ service name, service portì™€ ì—°ê²°ëœ NodePortë¥¼ ì°¾ì•„ì„œ ALBì˜ target groupìœ¼ë¡œ ë“±ë¡ì‹œí‚µë‹ˆë‹¤.</p>
<h3 id=ingress-ë°°í¬í•˜ê¸°>Ingress ë°°í¬í•˜ê¸°</h3>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=nx>apiVersion</span><span class=o>:</span> <span class=nx>extensions</span><span class=o>/</span><span class=nx>v1beta1</span>
<span class=nx>kind</span><span class=o>:</span> <span class=nx>Ingress</span>
<span class=nx>metadata</span><span class=o>:</span>
  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;ingress&#34;</span>
  <span class=nx>annotations</span><span class=o>:</span>
    <span class=nx>kubernetes</span><span class=p>.</span><span class=nx>io</span><span class=o>/</span><span class=nx>ingress</span><span class=p>.</span><span class=kr>class</span><span class=o>:</span> <span class=nx>alb</span> <span class=err>#</span> <span class=nx>the</span> <span class=nx>value</span> <span class=nx>we</span> <span class=nx>set</span> <span class=k>in</span> <span class=nx>alb</span><span class=o>-</span><span class=nx>ingress</span><span class=o>-</span><span class=nx>controller</span>
    <span class=nx>alb</span><span class=p>.</span><span class=nx>ingress</span><span class=p>.</span><span class=nx>kubernetes</span><span class=p>.</span><span class=nx>io</span><span class=o>/</span><span class=nx>scheme</span><span class=o>:</span> <span class=nx>internet</span><span class=o>-</span><span class=nx>facing</span>
<span class=nx>spec</span><span class=o>:</span>
  <span class=nx>rules</span><span class=o>:</span>
    <span class=o>-</span> <span class=nx>http</span><span class=o>:</span>
        <span class=nx>paths</span><span class=o>:</span>
          <span class=o>-</span> <span class=nx>path</span><span class=o>:</span> <span class=err>/*</span>
            <span class=nx>backend</span><span class=o>:</span>
              <span class=nx>serviceName</span><span class=o>:</span> <span class=s2>&#34;ingress-test&#34;</span>
              <span class=nx>servicePort</span><span class=o>:</span> <span class=mi>80</span>
</code></pre></div><p><a class=link href=https://kubernetes-sigs.github.io/aws-alb-ingress-controller/guide/ingress/annotation/ target=_blank rel=noopener>https://kubernetes-sigs.github.io/aws-alb-ingress-controller/guide/ingress/annotation/</a> ì„ ì°¸ê³ í•˜ì—¬ <code>Ingress</code>ë¥¼ ì‘ì„±í•´ì¤ë‹ˆë‹¤. <code>[kubernetes.io/ingress.class</code>ëŠ”](<a class=link href=http://kubernetes.io/ingress.class target=_blank rel=noopener>http://kubernetes.io/ingress.class</a>ëŠ”) alb-ingress-controllerì—ì„œ ì„¤ì •í•œ <code>ingress.class</code>ë¥¼ ì ì–´ì£¼ê³ , <a class=link href=http://alb.ingress.kubernetes.io/scheme%eb%8a%94 target=_blank rel=noopener><code>alb.ingress.kubernetes.io/scheme</code>ëŠ”</a> ìš©ë„ì— ë”°ë¼ <code>internet-facing</code> í˜¹ì€ <code>internal</code>ì„ ì ì–´ì¤ë‹ˆë‹¤. ingress ë¥¼ ìƒì„±í•˜ê¸° ì „ì— <code>kubectl logs -f {alb-ingress-controller pod name}</code>ì„ í•œ ì°½ì— ë„ì›Œë†“ìœ¼ë©´ ALB ìƒì„± ê´€ë ¨ ë¡œê·¸ë¥¼ ì­ˆë£¨ë£© ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p><figure style=flex-grow:403;flex-basis:968px>
<a href=/blog/aws/aws_eks_elb/elb.png data-size=670x166><img src=/blog/aws/aws_eks_elb/elb.png srcset="/blog/aws/aws_eks_elb/elb_huae6e8bb776e806d0d619a890a5bf58a9_19454_480x0_resize_box_3.png 480w, /blog/aws/aws_eks_elb/elb_huae6e8bb776e806d0d619a890a5bf58a9_19454_1024x0_resize_box_3.png 1024w" width=670 height=166 loading=lazy alt=elb.png>
</a>
<figcaption>elb.png</figcaption>
</figure></p>
<p>ì˜ ì„¤ì •ë˜ì—ˆë‹¤ë©´ ìœ„ì™€ ê°™ì´ ALBê°€ ìƒì„±ë  ê²ƒ ì…ë‹ˆë‹¤.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=nx>$</span> <span class=nx>kubectl</span> <span class=nx>get</span> <span class=nx>ingress</span>
<span class=nx>NAME</span>      <span class=nx>HOSTS</span>   <span class=nx>ADDRESS</span>                                                                     <span class=nx>PORTS</span>   <span class=nx>AGE</span>
<span class=nx>ingress</span>   <span class=o>*</span>       <span class=nx>bf1e76be</span><span class=o>-</span><span class=k>default</span><span class=o>-</span><span class=nx>ingress</span><span class=o>-</span><span class=nx>e8c7</span><span class=o>-</span><span class=mf>1351183883.</span><span class=nx>ap</span><span class=o>-</span><span class=nx>northeast</span><span class=o>-</span><span class=mf>2.</span><span class=nx>elb</span><span class=p>.</span><span class=nx>amazonaws</span><span class=p>.</span><span class=nx>com</span>   <span class=mi>80</span>      <span class=mi>30</span><span class=nx>s</span>
</code></pre></div><h3 id=ì¸ì¦ì„œ-ì„¤ì •ì„-í†µí•´-https-ê¹Œì§€>ì¸ì¦ì„œ ì„¤ì •ì„ í†µí•´ HTTPS ê¹Œì§€?!</h3>
<blockquote>
<p>â¤ï¸ AWS <code>Certificate Manager</code>ì™€ <code>Ingress</code>ì— ëŒ€í•œ <code>annotation</code>ì„ ì´ìš©í•´ ê°„ë‹¨í•˜ê²Œ <code>HTTPS</code>ë¥¼ ì´ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤! ì§ì ‘í•˜ë ¤ë©´ ë„ë©”ì¸ ì†Œìœ  ì¸ì¦ê³¼ ì¸ì¦ì„œ, ë¹„ë°€í‚¤ ë“±ì„ ëª¨ë‘ ê´€ë¦¬í•´ì•¼í–ˆëŠ”ë° ë§ì´ì§€ìš”! ğŸ¥</p>
</blockquote>
<p><figure style=flex-grow:341;flex-basis:819px>
<a href=/blog/aws/aws_eks_elb/cert.png data-size=1082x317><img src=/blog/aws/aws_eks_elb/cert.png srcset="/blog/aws/aws_eks_elb/cert_hu285e592bed94d8c711caab941a928b85_40319_480x0_resize_box_3.png 480w, /blog/aws/aws_eks_elb/cert_hu285e592bed94d8c711caab941a928b85_40319_1024x0_resize_box_3.png 1024w" width=1082 height=317 loading=lazy alt=cert.png>
</a>
<figcaption>cert.png</figcaption>
</figure></p>
<p>ì´ëŸ°ì‹ìœ¼ë¡œ AWSì˜ <code>Certificate Manager</code>ì„ í†µí•´ ë°œê¸‰ë°›ì€ ì¸ì¦ì„œê°€ ìˆë‹¤ë©´ ì´ë¥¼ alb ì—ì„œ ingressì— annotationì„ ì„¤ì •í•¨ìœ¼ë¡œì¨ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p><strong>Ingressì˜ annotationì— HTTPSë° ì¸ì¦ì„œ ê´€ë ¨ ì„¤ì • ì¶”ê°€í•´ì£¼ê¸°</strong></p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=nx>apiVersion</span><span class=o>:</span> <span class=nx>extensions</span><span class=o>/</span><span class=nx>v1beta1</span>
<span class=nx>kind</span><span class=o>:</span> <span class=nx>Ingress</span>
<span class=nx>metadata</span><span class=o>:</span>
  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;ingress&#34;</span>
  <span class=nx>annotations</span><span class=o>:</span>
    <span class=nx>kubernetes</span><span class=p>.</span><span class=nx>io</span><span class=o>/</span><span class=nx>ingress</span><span class=p>.</span><span class=kr>class</span><span class=o>:</span> <span class=nx>alb</span>
    <span class=nx>alb</span><span class=p>.</span><span class=nx>ingress</span><span class=p>.</span><span class=nx>kubernetes</span><span class=p>.</span><span class=nx>io</span><span class=o>/</span><span class=nx>scheme</span><span class=o>:</span> <span class=nx>internet</span><span class=o>-</span><span class=nx>facing</span>
    <span class=nx>alb</span><span class=p>.</span><span class=nx>ingress</span><span class=p>.</span><span class=nx>kubernetes</span><span class=p>.</span><span class=nx>io</span><span class=o>/</span><span class=nx>listen</span><span class=o>-</span><span class=nx>ports</span><span class=o>:</span> <span class=s1>&#39;[{&#34;HTTP&#34;: 80}, {&#34;HTTPS&#34;: 443}]&#39;</span>
    <span class=nx>alb</span><span class=p>.</span><span class=nx>ingress</span><span class=p>.</span><span class=nx>kubernetes</span><span class=p>.</span><span class=nx>io</span><span class=o>/</span><span class=nx>actions</span><span class=p>.</span><span class=nx>redirect</span><span class=o>-</span><span class=nx>to</span><span class=o>-</span><span class=nx>https</span><span class=o>:</span> <span class=o>&gt;</span>
      <span class=p>{</span><span class=s2>&#34;Type&#34;</span><span class=o>:</span><span class=s2>&#34;redirect&#34;</span><span class=p>,</span><span class=s2>&#34;RedirectConfig&#34;</span><span class=o>:</span><span class=p>{</span><span class=s2>&#34;Port&#34;</span><span class=o>:</span><span class=s2>&#34;443&#34;</span><span class=p>,</span><span class=s2>&#34;Protocol&#34;</span><span class=o>:</span><span class=s2>&#34;HTTPS&#34;</span><span class=p>,</span><span class=s2>&#34;StatusCode&#34;</span><span class=o>:</span><span class=s2>&#34;HTTP_302&#34;</span><span class=p>}}</span>
    <span class=nx>alb</span><span class=p>.</span><span class=nx>ingress</span><span class=p>.</span><span class=nx>kubernetes</span><span class=p>.</span><span class=nx>io</span><span class=o>/</span><span class=nx>certificate</span><span class=o>-</span><span class=nx>arn</span><span class=o>:</span> <span class=p>{</span><span class=nx>Certificate</span> <span class=nx>Mangerì˜</span> <span class=nx>ì¸ì¦ì„œ</span> <span class=nx>arn</span><span class=p>}</span>
<span class=p>...</span>
</code></pre></div><p><em>http redirect ë° actionsì— ëŒ€í•œ ë‚´ìš©ì€ ì €ì˜ ì• êµì…ë‹ˆë‹¤.</em> ê¶ê¸ˆí•˜ì‹  ë¶„ë“¤ì€ í•œ ë²ˆ ì ìš©í•´ë³´ì‹œê±°ë‚˜ ì•Œì•„ë³´ì‹œë©´ ì–´ë µì§€ ì•Šê²Œ ì•Œì•„ë‚´ì‹¤ ìˆ˜ ìˆì„ ê²ë‹ˆë‹¤! ğŸ˜†</p>
<p><strong>Route53ì— ALB ì¶”ê°€í•´ì£¼ê¸°</strong></p>
<p>EKSì—ì„œ ALBë¥¼ ì‚¬ìš©í•˜ëŠ” ë“±ì˜ ì‘ì—…ì„ í•˜ì‹œëŠ” ë¶„ì€ ì–´ëŠ ì •ë„ awsì— ëŒ€í•œ ì´í•´ê°€ ìˆìœ¼ë¦¬ë¼ ìƒê°í•˜ê³ , ALBë¥¼ Route53ì„ í†µí•´ ë ˆì½”ë“œë¡œ ì¶”ê°€í•˜ëŠ” ì‘ì—…ì— ëŒ€í•œ ì„¤ëª…ì€ ìƒëµí•˜ê² ìŠµë‹ˆë‹¤.</p>
<p><figure style=flex-grow:283;flex-basis:679px>
<a href=/blog/aws/aws_eks_elb/cert2.png data-size=1714x605><img src=/blog/aws/aws_eks_elb/cert2.png srcset="/blog/aws/aws_eks_elb/cert2_huff1102cf41f5fc11c3e61b957cd43eab_183400_480x0_resize_box_3.png 480w, /blog/aws/aws_eks_elb/cert2_huff1102cf41f5fc11c3e61b957cd43eab_183400_1024x0_resize_box_3.png 1024w" width=1714 height=605 loading=lazy alt=cert2.png>
</a>
<figcaption>cert2.png</figcaption>
</figure></p>
<p>alb-ingress-controllerë¡œ AWS Certificate Managerì˜ ì¸ì¦ì„œê¹Œì§€ ì‚¬ìš©í•œ ëª¨ìŠµ.</p>
<h2 id=-nlbë¥¼-ì‚¬ìš©í•´-ì„œë¹„ìŠ¤ë¥¼-ë…¸ì¶œì‹œí‚¤ëŠ”-ë°©ë²•>ğŸŒ NLBë¥¼ ì‚¬ìš©í•´ ì„œë¹„ìŠ¤ë¥¼ ë…¸ì¶œì‹œí‚¤ëŠ” ë°©ë²•</h2>
<p>CLBëŠ” Deprecate ëŒ€ìƒì´ë¼ê³  ë“¤ì—ˆê¸°ë„ í•˜ê³ , êµ³ì´ ì¨ë³¸ ì ì´ ì—†ì–´ NLBë¡œë§Œ ì„¤ëª…í•©ë‹ˆë‹¤. NLBëŠ” ALBì— ë¹„í•´ ì‚¬ìš©ì´ ê°„ë‹¨í•©ë‹ˆë‹¤.</p>
<p>Ingressì™€ alb-ingress-controllerë¥¼ ì‚¬ìš©í–ˆë˜ ALBì™€ ë‹¬ë¦¬ NLBëŠ” ì„œë¹„ìŠ¤ë¥¼ ì§ì ‘ ë…¸ì¶œì‹œí‚µë‹ˆë‹¤. ì£¼ë¡œ <code>Nginx Ingress Controller</code>ì„ NLBì— ì—°ê²°í•´ì„œ ì‚¬ìš©í–ˆë˜ ê¸°ì–µì´ ë‚©ë‹ˆë‹¤. NLBëŠ” L4 LBë¡œ, Nginxë¥¼ ì£¼ë¡œ L7 LBë¡œ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ì´ë ‡ê²Œ NLBë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ALBì™€ Nginx ëª¨ë‘ L7 LBë¡œì„œ ì—­í• ì„ í•˜ê¸°ë•Œë¬¸ì— êµ³ì´ ALBë¥¼ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ëŠ” ê²½ìš°ê°€ ë§ì•˜ìŠµë‹ˆë‹¤.</p>
<p>NLBë¥¼ í†µí•´ ì„œë¹„ìŠ¤ë¥¼ ë…¸ì¶œì‹œí‚¤ê¸° ìœ„í•´ì„  annotaionì¤‘ì—ì„œë„ [<code>service.beta.kubernetes.io](http://service.beta.kubernetes.io/)...</code>í˜•íƒœì˜ annotationì„ ì´ìš©í•©ë‹ˆë‹¤. ì‚¬ì‹¤ ì‹¤ì œë¡œ ì‹¤ë¬´í•´ì„œ ì‚¬ìš©í•´ë³¸ annotationì€ ê±°ì˜ [<code>service.beta.kubernetes.io/aws-load-balancer-type:](http://service.beta.kubernetes.io/aws-load-balancer-type:) "nlb"</code> ë¿ì…ë‹ˆë‹¤. (ì´ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì„ ê²½ìš° ë””í´íŠ¸ê°€ CLBì´ê¸° ë•Œë¬¸ì—&mldr;)</p>
<h3 id=nlbê°€-ì‚¬ìš©í• -subnetì—-ì ì ˆí•œ-íƒœê·¸-ë‹¬ê¸°>NLBê°€ ì‚¬ìš©í•  subnetì— ì ì ˆí•œ íƒœê·¸ ë‹¬ê¸°</h3>
<p>ALBë¥¼ ì‚¬ìš©í–ˆì„ ë•Œì™€ ë§ˆì°¬ê°€ì§€ë¡œ NLBê°€ ì‚¬ìš©í•  ì„œë¸Œë„·ì— í•„ìˆ˜ íƒœê·¸ë¥¼ ë‹¬ì•„ì¤ë‹ˆë‹¤. ê¸°ì–µì´ ì•ˆë‚œ ë‹¤ë©´ ê¸€ì˜ ìƒë‹¨ ALB íŒŒíŠ¸ë¥¼ ì°¸ê³ !</p>
<h3 id=nlbë¡œ-ë…¸ì¶œí• -ì„œë¹„ìŠ¤-ìƒì„±í•˜ê¸°>NLBë¡œ ë…¸ì¶œí•  ì„œë¹„ìŠ¤ ìƒì„±í•˜ê¸°</h3>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=nx>apiVersion</span><span class=o>:</span> <span class=nx>v1</span>
<span class=nx>kind</span><span class=o>:</span> <span class=nx>Service</span>
<span class=nx>metadata</span><span class=o>:</span>
  <span class=nx>name</span><span class=o>:</span> <span class=nx>nginx</span><span class=o>-</span><span class=nx>nlb</span>
  <span class=nx>annotations</span><span class=o>:</span>
    <span class=nx>service</span><span class=p>.</span><span class=nx>beta</span><span class=p>.</span><span class=nx>kubernetes</span><span class=p>.</span><span class=nx>io</span><span class=o>/</span><span class=nx>aws</span><span class=o>-</span><span class=nx>load</span><span class=o>-</span><span class=nx>balancer</span><span class=o>-</span><span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;nlb&#34;</span>
<span class=nx>spec</span><span class=o>:</span>
  <span class=nx>selector</span><span class=o>:</span>
    <span class=nx>app</span><span class=o>:</span> <span class=nx>nginx</span>
  <span class=nx>ports</span><span class=o>:</span>
    <span class=o>-</span> <span class=nx>protocol</span><span class=o>:</span> <span class=nx>TCP</span>
      <span class=nx>port</span><span class=o>:</span> <span class=mi>80</span>
      <span class=nx>targetPort</span><span class=o>:</span> <span class=mi>80</span>
      <span class=nx>nodePort</span><span class=o>:</span> <span class=mi>30011</span>
  <span class=nx>type</span><span class=o>:</span> <span class=nx>LoadBalancer</span>
</code></pre></div><p><figure style=flex-grow:440;flex-basis:1057px>
<a href=/blog/aws/aws_eks_elb/terminal.png data-size=983x223><img src=/blog/aws/aws_eks_elb/terminal.png srcset="/blog/aws/aws_eks_elb/terminal_hua70a78035179ff73439578821520f3f3_51627_480x0_resize_box_3.png 480w, /blog/aws/aws_eks_elb/terminal_hua70a78035179ff73439578821520f3f3_51627_1024x0_resize_box_3.png 1024w" width=983 height=223 loading=lazy alt=terminal.png>
</a>
<figcaption>terminal.png</figcaption>
</figure></p>
<p><figure style=flex-grow:105;flex-basis:252px>
<a href=/blog/aws/aws_eks_elb/zzal.png data-size=420x400><img src=/blog/aws/aws_eks_elb/zzal.png srcset="/blog/aws/aws_eks_elb/zzal_hu70382f8ad38785a4d7f8dffcaf07bdc6_351117_480x0_resize_box_3.png 480w, /blog/aws/aws_eks_elb/zzal_hu70382f8ad38785a4d7f8dffcaf07bdc6_351117_1024x0_resize_box_3.png 1024w" width=420 height=400 loading=lazy alt=zzal.png>
</a>
<figcaption>zzal.png</figcaption>
</figure></p>
<p>ê°„ë‹¨íˆ typeì„ LoadBalancerë¡œ ë°”ê¾¸ì–´ì£¼ê³ , annotationì— ì–´ë–¤ ELBë¥¼ ì‚¬ìš©í• ì§€( NLB/CLB )ë§Œ ì ì–´ì£¼ë©´ ì•„ë˜ ê·¸ë¦¼ì²˜ëŸ¼ ì†ì‰½ê²Œ NLBë¡œ ì„œë¹„ìŠ¤ë¥¼ ë…¸ì¶œ ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<h3 id=ì¸ì¦ì„œ-ì„¤ì •ì„-í†µí•´-httpsê¹Œì§€>ì¸ì¦ì„œ ì„¤ì •ì„ í†µí•´ HTTPSê¹Œì§€?!</h3>
<blockquote>
<p>ğŸŒ‹: &ldquo;ê·¸ë§Œ&mldr;. ì•„ë¬´ë„ ì•ˆ ê¶ê¸ˆí•´&mldr;&rdquo; - í•˜ì§€ë§Œ ë§ˆì§€ë§‰ê¹Œì§€ í˜ì„ ë‚´ì„œ EKSì—ì„œì˜ ELBë¥¼ ì •ë³µí•´ë´…ì‹œë‹¤!</p>
</blockquote>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=nx>apiVersion</span><span class=o>:</span> <span class=nx>v1</span>
<span class=nx>kind</span><span class=o>:</span> <span class=nx>Service</span>
<span class=nx>metadata</span><span class=o>:</span>
  <span class=nx>name</span><span class=o>:</span> <span class=nx>nginx</span><span class=o>-</span><span class=nx>nlb</span>
  <span class=nx>annotations</span><span class=o>:</span>
    <span class=nx>service</span><span class=p>.</span><span class=nx>beta</span><span class=p>.</span><span class=nx>kubernetes</span><span class=p>.</span><span class=nx>io</span><span class=o>/</span><span class=nx>aws</span><span class=o>-</span><span class=nx>load</span><span class=o>-</span><span class=nx>balancer</span><span class=o>-</span><span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;nlb&#34;</span>
    <span class=nx>service</span><span class=p>.</span><span class=nx>beta</span><span class=p>.</span><span class=nx>kubernetes</span><span class=p>.</span><span class=nx>io</span><span class=o>/</span><span class=nx>aws</span><span class=o>-</span><span class=nx>load</span><span class=o>-</span><span class=nx>balancer</span><span class=o>-</span><span class=nx>backend</span><span class=o>-</span><span class=nx>protocol</span><span class=o>:</span> <span class=nx>tcp</span>
    <span class=nx>service</span><span class=p>.</span><span class=nx>beta</span><span class=p>.</span><span class=nx>kubernetes</span><span class=p>.</span><span class=nx>io</span><span class=o>/</span><span class=nx>aws</span><span class=o>-</span><span class=nx>load</span><span class=o>-</span><span class=nx>balancer</span><span class=o>-</span><span class=nx>ssl</span><span class=o>-</span><span class=nx>ports</span><span class=o>:</span> <span class=s2>&#34;443&#34;</span>
    <span class=nx>service</span><span class=p>.</span><span class=nx>beta</span><span class=p>.</span><span class=nx>kubernetes</span><span class=p>.</span><span class=nx>io</span><span class=o>/</span><span class=nx>aws</span><span class=o>-</span><span class=nx>load</span><span class=o>-</span><span class=nx>balancer</span><span class=o>-</span><span class=nx>ssl</span><span class=o>-</span><span class=nx>cert</span><span class=o>:</span> <span class=nx>arn</span><span class=o>:</span><span class=nx>aws</span><span class=o>:</span><span class=nx>acm</span><span class=o>:</span><span class=nx>ap</span><span class=o>-</span><span class=nx>northeast</span><span class=o>-</span><span class=mi>2</span><span class=o>:</span><span class=p>{{</span><span class=nx>root</span><span class=p>}}</span><span class=o>:</span><span class=nx>certificate</span><span class=o>/</span><span class=p>{{</span><span class=nx>arn</span><span class=p>}}</span>

<span class=nx>spec</span><span class=o>:</span>
  <span class=nx>selector</span><span class=o>:</span>
    <span class=nx>app</span><span class=o>:</span> <span class=nx>nginx</span>
  <span class=nx>ports</span><span class=o>:</span>
    <span class=o>-</span> <span class=nx>protocol</span><span class=o>:</span> <span class=nx>TCP</span>
      <span class=nx>port</span><span class=o>:</span> <span class=mi>80</span>
      <span class=nx>targetPort</span><span class=o>:</span> <span class=mi>80</span>
      <span class=nx>nodePort</span><span class=o>:</span> <span class=mi>30011</span>
    <span class=o>-</span> <span class=nx>protocol</span><span class=o>:</span> <span class=nx>TCP</span>
      <span class=nx>port</span><span class=o>:</span> <span class=mi>443</span>
      <span class=nx>targetPort</span><span class=o>:</span> <span class=mi>80</span>
      <span class=nx>nodePort</span><span class=o>:</span> <span class=mi>30012</span>
  <span class=nx>type</span><span class=o>:</span> <span class=nx>LoadBalancer</span>
</code></pre></div><p><code>backend-protocol</code>ì€ <code>tcp</code>|tls í˜¹ì€ https|httpë¡œ ì„¤ì •ì´ ë ëŠ” ë“¯í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ <code>backend-protocol</code> ë¡œ <code>tcp</code>ë¥¼ ì„¤ì •í•œ ë’¤ <code>ssl-port</code>ë¡œ 443ì„ ì„¤ì •, ì„œë¹„ìŠ¤ì˜ <code>spec</code>ì—ì„œì˜ í¬íŠ¸ë¡œëŠ” <code>80</code>ê³¼ <code>443</code>ì„ ì„¤ì •í•˜ë©´, ìë™ì ìœ¼ë¡œ <code>80</code>ì€ <code>tcp</code>, <code>443</code>ì€ tlsë¥¼ ì´ìš©í•˜ëŠ” NLB listenerë¡œ ì„¤ì •ë˜ê²Œ ë˜ëŠ”ë° http,httpsë„ ë§ˆì°¬ê°€ì§€ë¡œ tcp,tlsë¡œ ì ì ˆíˆ ì„¤ì •ì´ ë©ë‹ˆë‹¤. ë‹¤ë§Œ http,httpsë¥¼ ì„¤ì •í•  ê²½ìš° <code>X-Forwarded-For</code> í—¤ë”ê°€ ì‚½ì…ëœë‹¤ê³  í•©ë‹ˆë‹¤. (ì •í™•í•˜ì§€ëŠ” ì•Šì•„ìš”&mldr; ë”±íˆ NLBì˜ backend protocolì„ L7ìœ¼ë¡œ ì„¤ì •í•˜ëŠ” ê²ƒì´ NLBì˜ ì›ë˜ ìŠ¤í™ì´ ì•„ë‹ˆì—ˆë˜ ì ë„ ìˆê³ , L7ì„ ì´ìš©í•˜ê³  ì‹¶ìœ¼ë©´, ALBë¥¼ ì´ìš©í•˜ëŠ” ê²ƒì´ ë” í¸í•˜ë‹¤ê³  ìƒê°ì´ ë“¤ì–´ì„œ ë”°ë¡œ ê²€ì¦í•´ë³¸ ì ì´ ì—†ê¸° ë•Œë¬¸ì—&mldr; )</p>
<p>âš ï¸<strong>ë‹¨ì </strong>ì´ í•˜ë‚˜ ìˆë‹¤ë©´ ì•„ì§ <strong>httpâ‡’https redirect</strong>ê°€ ë¶ˆê°€ëŠ¥í•˜ë‹¤ëŠ” ê²ƒì¸ë°, ì´ëŠ” ì• ì´ˆì— L4 LBë¥¼ ì´ìš©í•˜ëŠ” ê²ƒê³¼ L7 LBë¥¼ ì´ìš©í•˜ëŠ” ì“°ì„ì— ëŒ€í•œ ì°¨ì´ë¼ê³  ìƒê°ì„ í•˜ê¸° ë•Œë¬¸ì— ê°ìˆ˜ë¥¼ í•´ì•¼í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ L4 NLBì— L7 nginx-ingress-controllerì„ ì—°ê²°í•˜ì—¬ redirectëŠ” nginxê°€ ë‹´ë‹¹í•˜ë„ë¡í•˜ëŠ” ë°©ì‹ì„ ë§ì´ ì´ìš©í•˜ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤. NLBì—ì„œëŠ” L4 ì˜ ë­”ê°€ SSL/TLSí•œ ì‘ì—…ì„ í•˜ê¸° ìœ„í•¨ì´ê³ , L7ì˜ https ì‘ì—…ì´ ì£¼ê°€ ë˜ëŠ” ê²ƒì€ ì•„ë‹ˆë¯€ë¡œ&mldr;? <em>ì‚¬ì‹¤ ì´ ë¶€ë¶„ì€ ì˜ ëª¨ë¥´ê² ìŠµë‹ˆë‹¤&mldr;ğŸ’¦ğŸ’¦ ì˜ ì•„ì‹œëŠ” ë¶„ì´ ê³„ì‹œë‹¤ë©´ ì•Œë ¤ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤. ã…œã…œã…œ</em>( NLBì—ì„œ HTTP, HTTPS redirectê°€ ì•ˆë˜ëŠ” ì´ìœ  ì°¸ê³  - <a class=link href=https://aws.amazon.com/premiumsupport/knowledge-center/redirect-http-https-elb/ target=_blank rel=noopener>https://aws.amazon.com/premiumsupport/knowledge-center/redirect-http-https-elb/</a> )</p>
<h3 id=-nlbë¥¼-í†µí•œ-https-ì„œë²„-êµ¬ì¶•-ê²°ê³¼>â­•ï¸ NLBë¥¼ í†µí•œ HTTPS ì„œë²„ êµ¬ì¶• ê²°ê³¼</h3>
<p>ì–´ì¨Œë“  ìœ„ì˜ annotationì„ í†µí•´ ì˜¬ë°”ë¥´ê²Œ svcë¥¼ ì„¤ì •í•œë‹¤ë©´</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=nx>$</span> <span class=nx>kubectl</span> <span class=nx>get</span> <span class=nx>svc</span>

<span class=nx>nginx</span><span class=o>-</span><span class=nx>nlb</span>    <span class=nx>LoadBalancer</span>   <span class=mf>10.100.180.174</span>   <span class=nx>ae27784521c4f4bcd96b22f2cca2358b</span><span class=o>-</span><span class=mi>4</span><span class=nx>bffb166fafa47f2</span><span class=p>.</span><span class=nx>elb</span><span class=p>.</span><span class=nx>ap</span><span class=o>-</span><span class=nx>northeast</span><span class=o>-</span><span class=mf>2.</span><span class=nx>amazonaws</span><span class=p>.</span><span class=nx>com</span>   <span class=mi>443</span><span class=o>:</span><span class=mi>30014</span><span class=o>/</span><span class=nx>TCP</span>   <span class=mi>37</span><span class=nx>m</span>
</code></pre></div><ul>
<li>Route53 ì„¤ì •ì€ ì¶”ê°€ë¡œ í•´ì£¼ì–´ì•¼í•¨. - ì˜ˆì‹œ
<a class=link href=http://nlb.umidev.net target=_blank rel=noopener>nlb.umidev.net</a> - ALIAS ae2778452xxxxxxxxxxxxxx.elb.ap-northeast-2.amazonaws.com</li>
</ul>
<p>ì´ë ‡ê²Œ serviceê°€ ìƒì„±ë  ê²ƒì´ê³ , (serviceì˜ portë¡œì„œ ì‚¬ìš©í•  80,443 ë“±ì€ service.specì—ì„œ ëª…ì‹œ) ìƒì„± í›„ <code>A Record Alias</code>ë¡œì„œ NLBì˜ <code>DNS</code> nameì„ ë„£ì–´ì£¼ë©´ ì‚¬ì§„ê³¼ ê°™ì´ <code>HTTPS</code> ì ‘ì†ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤!</p>
<p><figure style=flex-grow:274;flex-basis:658px>
<a href=/blog/aws/aws_eks_elb/cert3.png data-size=1660x605><img src=/blog/aws/aws_eks_elb/cert3.png srcset="/blog/aws/aws_eks_elb/cert3_hu4f6093134f3fc61777b52e640067d7a7_152079_480x0_resize_box_3.png 480w, /blog/aws/aws_eks_elb/cert3_hu4f6093134f3fc61777b52e640067d7a7_152079_1024x0_resize_box_3.png 1024w" width=1660 height=605 loading=lazy alt=cert3.png>
</a>
<figcaption>cert3.png</figcaption>
</figure></p>
<h2 id=-ë§ˆì¹˜ë©°>ğŸ³ ë§ˆì¹˜ë©°</h2>
<p>ì–´ì°¨í”¼ í•œ ë²ˆì˜ ê²€ìƒ‰ì´ë©´ ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ìˆëŠ” ëª¨ë“  annotationì´ë‚˜ ê¸°íƒ€ ì„¤ì •ì— ëŒ€í•œ ë‚´ìš©ì„ ë‹¤ë£¨ê¸° ë³´ë‹¨ ë‚˜ë¦„ ì œê°€ <strong>ì‹¤ì œë¡œ ì¿ ë²„ë„¤í‹°ìŠ¤ë¥¼ ê´€ë¦¬í•˜ëŠ”</strong> <strong>ë°ë¸Œì˜µìŠ¤ ì¸í„´ë¡œì„œ ì¼ì„ í•˜ë©´ì„œ í—·ê°ˆë ¸ë˜ ë‚´ìš©</strong>ê³¼ <strong>EKSì—ì„œì˜ ELB ê´€ë¦¬ì— ëŒ€í•œ íë¦„</strong>ì„ ìœ„ì£¼ë¡œ ì„¤ëª…í•˜ë ¤ ë…¸ë ¥í–ˆê³ , ì €ì˜ <code>ì‚½ì§ˆ</code>ì´ ê¹ƒë“  ë‚´ìš©ë“¤ì…ë‹ˆë‹¤ ã…ã…ã…</p>
<p>ì•„ëŠ” ë²”ìœ„ + ì¢€ ë” ì¡°ì‚¬í•˜ì—¬ ì—´ì‹¬íˆ ì •ë¦¬í•´ë³´ì•˜ì§€ë§Œ, ë¶€ì¡±í•œ ë¶€ë¶„ì´ ìˆì„ ìˆ˜ë„ ìˆê³  í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ìˆ˜ë„ ìˆì„í…ë°, ë³´ì™„í•´ì£¼ì‹¤ ë‚´ìš©ì´ ìˆë‹¤ë©´ ë§ì”€í•´ì£¼ì‹œë©´ ì—´ì‹¬íˆ ê²€í† í•´ë³´ê² ìŠµë‹ˆë‹¤~! ê°ì‚¬í•©ë‹ˆë‹¤.</p>
<h2 id=ê¸€ì“´ì´>ğŸ§™â€â™‚ï¸ê¸€ì“´ì´</h2>
<ul>
<li><strong>ë°•ì§„ìˆ˜</strong> - ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘§<code>AUSG</code> (AWS University Student Group) 3ê¸°ë¡œ í™œë™ ì¤‘</li>
<li><strong>ê´€ì‹¬ì‚¬</strong>
<ul>
<li><code>Docker</code>, <code>Kubernetes</code> ë“±ì˜ <strong>ì»¨í…Œì´ë„ˆ ê¸°ìˆ </strong></li>
<li><code>Argo</code>, <code>Spinnaker</code>, <code>Github action</code> ë“±ì˜ <strong>CI/CD íˆ´</strong></li>
<li><code>Terraform</code>, <code>AWS</code>ë¥¼ í†µí•œ <strong>í´ë¼ìš°ë“œ ì¸í”„ë¼ êµ¬ì¶•</strong></li>
</ul>
</li>
<li><strong>Blog</strong> - <a class=link href=https://senticoding.tistory.com target=_blank rel=noopener>https://senticoding.tistory.com</a></li>
<li><strong>Email</strong> - <a class=link href=mailto:bo314@naver.com>bo314@naver.com</a></li>
</ul>
<h2 id=-ì°¸ê³ -references>ğŸ“š ì°¸ê³  (References)</h2>
<ul>
<li>EKSì˜ Required subnet tags
<ul>
<li><a class=link href=https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/load-balancing.html target=_blank rel=noopener>https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/load-balancing.html</a></li>
<li><a class=link href=https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/alb-ingress.html target=_blank rel=noopener>https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/alb-ingress.html</a></li>
</ul>
</li>
<li>Kubernetes Cloud provider aws - <a class=link href=https://kubernetes.io/docs/concepts/cluster-administration/cloud-providers/#aws target=_blank rel=noopener>https://kubernetes.io/docs/concepts/cluster-administration/cloud-providers/#aws</a></li>
<li>ALB ingress controller install - <a class=link href=https://kubernetes-sigs.github.io/aws-alb-ingress-controller/guide/controller/setup/ target=_blank rel=noopener>https://kubernetes-sigs.github.io/aws-alb-ingress-controller/guide/controller/setup/</a></li>
<li>ALB ingress Annotation <a class=link href=https://kubernetes-sigs.github.io/aws-alb-ingress-controller/guide/ingress/annotation/ target=_blank rel=noopener>https://kubernetes-sigs.github.io/aws-alb-ingress-controller/guide/ingress/annotation/</a></li>
<li>NLBì˜ HTTPS redirectê°€ ë¶ˆê°€ëŠ¥í•œ ì´ìœ  -<a class=link href=https://aws.amazon.com/premiumsupport/knowledge-center/redirect-http-https-elb/ target=_blank rel=noopener>https://aws.amazon.com/premiumsupport/knowledge-center/redirect-http-https-elb/</a></li>
<li>NLB service Annotations - <a class=link href=https://kubernetes.io/ko/docs/concepts/services-networking/service/#aws-nlb-support target=_blank rel=noopener>https://kubernetes.io/ko/docs/concepts/services-networking/service/#aws-nlb-support</a></li>
<li>Ingressì˜ classì— ëŒ€í•´ - <a class=link href=https://kubernetes.io/ko/docs/concepts/services-networking/ingress/#%EC%9D%B8%EA%B7%B8%EB%A0%88%EC%8A%A4-%ED%81%B4%EB%9E%98%EC%8A%A4 target=_blank rel=noopener>https://kubernetes.io/ko/docs/concepts/services-networking/ingress/#ì¸ê·¸ë ˆìŠ¤-í´ë˜ìŠ¤</a></li>
</ul>
</section>
<footer class=article-footer>
<section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
</article>
<aside class=related-contents--wrapper>
</aside>
<div class=disqus-container>
<div id=disqus_thread></div>
<script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//umi0410.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</div>
<style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style>
<script>window.addEventListener('onColorSchemeChange',a=>{DISQUS&&DISQUS.reset({reload:!0})})</script>
<footer class=site-footer>
<section class=copyright>
&copy;
2020 -
2022 Jinsu Playground
</section>
<section class=powerby>
<a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a>ë¡œ ë§Œë“¦ <br>
<a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>ì˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=2.4.0>Stack</a></b> í…Œë§ˆ ì‚¬ìš© ì¤‘
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
<aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div>
<h2 class="widget-title section-title">Table of contents</h2>
<div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#-ì‹œì‘í•˜ë©°>ğŸ¶ ì‹œì‘í•˜ë©°</a></li>
<li><a href=#-eks-ì—ì„œ-elbë¥¼-ì‚¬ìš©í•´-ì„œë¹„ìŠ¤ë¥¼-ë…¸ì¶œí‚¬-ë•Œ-ìœ ì˜ì‚¬í•­ë“¤>ğŸ’ğŸ»â€â™‚ï¸ EKS ì—ì„œ ELBë¥¼ ì‚¬ìš©í•´ ì„œë¹„ìŠ¤ë¥¼ ë…¸ì¶œí‚¬ ë•Œ ìœ ì˜ì‚¬í•­ë“¤</a>
<ol>
<li><a href=#-albë¥¼-ì‚¬ìš©í• -ë•Œ-ìœ ì˜í• -ì >âš ï¸ ALBë¥¼ ì‚¬ìš©í•  ë•Œ ìœ ì˜í•  ì </a></li>
<li><a href=#-nlb-clbë¥¼-ì‚¬ìš©í• -ë•Œ-ìœ ì˜í• -ì >âš ï¸ NLB, CLBë¥¼ ì‚¬ìš©í•  ë•Œ ìœ ì˜í•  ì </a></li>
</ol>
</li>
<li><a href=#-albë¥¼-ì‚¬ìš©í•´-ì„œë¹„ìŠ¤ë¥¼-ë…¸ì¶œì‹œí‚¤ëŠ”-ë°©ë²•>ğŸŒ ALBë¥¼ ì‚¬ìš©í•´ ì„œë¹„ìŠ¤ë¥¼ ë…¸ì¶œì‹œí‚¤ëŠ” ë°©ë²•</a>
<ol>
<li><a href=#albë¥¼-ì›í™œíˆ-ì œì–´í•˜ê¸°-ìœ„í•œ-permission-ë¶€ì—¬>ALBë¥¼ ì›í™œíˆ ì œì–´í•˜ê¸° ìœ„í•œ permission ë¶€ì—¬</a></li>
<li><a href=#albê°€-ì‚¬ìš©í• -subnetì—-ì ì ˆí•œ-íƒœê·¸-ë‹¬ê¸°>albê°€ ì‚¬ìš©í•  subnetì— ì ì ˆí•œ íƒœê·¸ ë‹¬ê¸°</a></li>
<li><a href=#alb-ingress-controller-ë°°í¬í•˜ê¸°>alb ingress controller ë°°í¬í•˜ê¸°.</a></li>
<li><a href=#ë…¸ì¶œì‹œí‚¬-ì„œë¹„ìŠ¤-ë°°í¬í•˜ê¸°>ë…¸ì¶œì‹œí‚¬ ì„œë¹„ìŠ¤ ë°°í¬í•˜ê¸°</a></li>
<li><a href=#ingress-ë°°í¬í•˜ê¸°>Ingress ë°°í¬í•˜ê¸°</a></li>
<li><a href=#ì¸ì¦ì„œ-ì„¤ì •ì„-í†µí•´-https-ê¹Œì§€>ì¸ì¦ì„œ ì„¤ì •ì„ í†µí•´ HTTPS ê¹Œì§€?!</a></li>
</ol>
</li>
<li><a href=#-nlbë¥¼-ì‚¬ìš©í•´-ì„œë¹„ìŠ¤ë¥¼-ë…¸ì¶œì‹œí‚¤ëŠ”-ë°©ë²•>ğŸŒ NLBë¥¼ ì‚¬ìš©í•´ ì„œë¹„ìŠ¤ë¥¼ ë…¸ì¶œì‹œí‚¤ëŠ” ë°©ë²•</a>
<ol>
<li><a href=#nlbê°€-ì‚¬ìš©í• -subnetì—-ì ì ˆí•œ-íƒœê·¸-ë‹¬ê¸°>NLBê°€ ì‚¬ìš©í•  subnetì— ì ì ˆí•œ íƒœê·¸ ë‹¬ê¸°</a></li>
<li><a href=#nlbë¡œ-ë…¸ì¶œí• -ì„œë¹„ìŠ¤-ìƒì„±í•˜ê¸°>NLBë¡œ ë…¸ì¶œí•  ì„œë¹„ìŠ¤ ìƒì„±í•˜ê¸°</a></li>
<li><a href=#ì¸ì¦ì„œ-ì„¤ì •ì„-í†µí•´-httpsê¹Œì§€>ì¸ì¦ì„œ ì„¤ì •ì„ í†µí•´ HTTPSê¹Œì§€?!</a></li>
<li><a href=#-nlbë¥¼-í†µí•œ-https-ì„œë²„-êµ¬ì¶•-ê²°ê³¼>â­•ï¸ NLBë¥¼ í†µí•œ HTTPS ì„œë²„ êµ¬ì¶• ê²°ê³¼</a></li>
</ol>
</li>
<li><a href=#-ë§ˆì¹˜ë©°>ğŸ³ ë§ˆì¹˜ë©°</a></li>
<li><a href=#ê¸€ì“´ì´>ğŸ§™â€â™‚ï¸ê¸€ì“´ì´</a></li>
<li><a href=#-ì°¸ê³ -references>ğŸ“š ì°¸ê³  (References)</a></li>
</ol>
</nav>
</div>
</section>
</aside>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</body>
</html>