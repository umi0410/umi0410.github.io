<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Network on Jinsu Playground</title><link>https://umi0410.github.io/categories/network/</link><description>Recent content in Network on Jinsu Playground</description><generator>Hugo -- gohugo.io</generator><language>ko-kr</language><lastBuildDate>Thu, 11 Aug 2022 03:20:00 +0900</lastBuildDate><atom:link href="https://umi0410.github.io/categories/network/index.xml" rel="self" type="application/rss+xml"/><item><title>Virtual Serviceì™€ Destination Ruleì„ ì´ìš©í•´ mesh ë‚´ë¶€ íŠ¸ë˜í”½ì„ ì›í•˜ëŠ” ëŒ€ë¡œ ë¼ìš°íŒ…í•´ë³´ê¸°</title><link>https://umi0410.github.io/blog/devops/virtual-service-destination-rule-mesh-internal-traffic/</link><pubDate>Thu, 11 Aug 2022 03:20:00 +0900</pubDate><guid>https://umi0410.github.io/blog/devops/virtual-service-destination-rule-mesh-internal-traffic/</guid><description>&lt;img src="https://umi0410.github.io/blog/devops/virtual-service-destination-rule-mesh-internal-traffic/preview.png" alt="Featured image of post Virtual Serviceì™€ Destination Ruleì„ ì´ìš©í•´ mesh ë‚´ë¶€ íŠ¸ë˜í”½ì„ ì›í•˜ëŠ” ëŒ€ë¡œ ë¼ìš°íŒ…í•´ë³´ê¸°" />&lt;h2 id="ì‹œì‘í•˜ë©°">ì‹œì‘í•˜ë©°&lt;/h2>
&lt;p>ë°ë¸Œì˜µìŠ¤ ì—”ì§€ë‹ˆì–´ë¡œ ì…ì‚¬í•œ ë’¤ ì£¼ë¡œ ë§¡ê³  ìˆëŠ” ì‘ì—…ì€ &lt;code>Istio&lt;/code> ê´€ë ¨ ì‘ì—…ì´ë‹¤. í‰ì†Œ ì°¸ ê´€ì‹¬ ìˆì—ˆë˜ ë¶„ì•¼ì´ê¸°ë„ í•˜ê³  istio ë¿ë§Œ ì•„ë‹ˆë¼ ë„¤íŠ¸ì›Œí¬ì— ëŒ€í•´ ê°œì¸ì ìœ¼ë¡œ ì •ë§ ê³µë¶€í•´ë³´ê³ ì‹¶ì—ˆëŠ”ë° ë•ë¶„ì— ì¬ë¯¸ìˆê²Œ ê³µë¶€í•˜ê³  ì„±ì¥í•˜ë©° ê·¼ë¬´í•˜ê³  ìˆëŠ” ê²ƒ ê°™ë‹¤. ğŸ˜Š&lt;/p>
&lt;p>ê·¼ë° ìš”ì¦˜ ë“¤ì–´ ì ì  ë‹¨ìˆœíˆ â€˜ì–´ë–»ê²Œ ì €ë–»ê²Œ í•˜ë‹ˆê¹Œ ëŒì•„ëŠ”ê°€ë„¤~ ì˜¤.. ë‚˜ istio ì¢€ íŒŒì•…í•œë“¯?ã…‹ã…‹â€™ ìˆ˜ì¤€ì˜ ìì„¸ë¡œëŠ” íŠ¸ëŸ¬ë¸”ìŠˆíŒ…ì„ í•˜ê±°ë‚˜ ì˜¬ë°”ë¥´ê²Œ ì„¤ê³„í•˜ê¸°ê°€ ì‰½ì§€ ì•Šì€ ê²½ìš°ë“¤ì´ ì¦ì•„ì¡Œë‹¤.&lt;/p>
&lt;p>ë”°ë¼ì„œ í‰ì†Œ ê¶ê¸ˆí–ˆë˜ ë‚´ìš© ì¤‘ í•˜ë‚˜ë¥¼ ì‚´ì§ íŒŒí—¤ì³ë³¼ê¹Œí•œë‹¤.&lt;/p>
&lt;p>ë‚˜ëŠ” ì£¼ë¡œ istio &lt;code>ingress gateway&lt;/code>ì™€ ê´€ë ¨ëœ ì‘ì—…ì„ ë§ì´ í–ˆì—ˆê³  ì´ ê²½ìš° Virtual ServiceëŠ” í•­ìƒ ingress gatewayë¥¼ ì°¸ì¡°í•˜ë„ë¡ ì„¤ì •í•´ì™”ë‹¤. ê·¼ë° istioë¥¼ ì²˜ìŒ ë°°ìš¸ ë•ŒëŠ” ë¶„ëª… â€˜client ì¸¡ì—ì„œ outbound handlerë¡œì„œì˜ Envody ì‚¬ì´ë“œì¹´ì„ í†µí•´ ì•Œì•„ì„œ ìš°ë¦¬ê°€ ì˜ë„í•˜ëŠ” ëª©ì ì§€ë¥¼ ì°¾ì•„ì„œ ìš”ì²­ì„ ë³´ë‚¸ë‹¤.â€™ ì´ëŸ° ì‹ìœ¼ë¡œ ë°°ì› ë˜ ê²ƒ ê°™ì€ë° â€˜ì™œ ë‚˜ëŠ” Virtual Serviceë¥¼ ì´ìš©í•  ë•Œ í•­ìƒ Gatewayë¥¼ ì„¤ì •í•´ì¤˜ì•¼í•˜ëŠ” ê²ƒì´ì—ˆì„ê¹Œ?â€™í•˜ëŠ” ê¶ê¸ˆì¦ì´ ìƒê²¼ë‹¤.&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Virtual ServiceëŠ” Gatewayì— ingress gatewayë¥¼ ì„¤ì •í•´ì£¼ì§€ ì•Šì•„ë„ ë˜ëŠ” ê²ƒì¼ê¹Œ?&lt;/strong>&lt;/li>
&lt;li>&lt;strong>Virtual Serviceì— ì„¤ì •í•œ ë‚´ìš©ì€ ingress gatewayë¡œ ë“¤ì–´ì˜¨ ìš”ì²­ë¿ë§Œ ì•„ë‹ˆë¼ mesh ë‚´ë¶€ì—ì„œì˜ ìš”ì²­ì—ë„ ì ìš©ë  ìˆ˜ ìˆëŠ” ê²ƒì¸ê°€?&lt;/strong>&lt;/li>
&lt;li>&lt;strong>Destination Ruleì€ ë­í•˜ëŠ” ë…€ì„ì¼ê¹Œ? ì£¼ë¡œ ì–˜ëŠ” Virtual Serviceì™€ í•¨ê»˜ ì“°ëŠ” ì˜ˆì‹œê°€ ë§ì´ ë³´ì´ë˜ë° ê¼­ Virtual Serviceì™€ í•¨ê»˜ ì¨ì•¼í•˜ëŠ” ê±¸ê¹Œ?&lt;/strong>&lt;/li>
&lt;/ul>
&lt;p>ë”°ë¼ì„œ ì´ë²ˆ ê¸€ì—ì„œëŠ” ìœ„ì™€ ê°™ì€ ê¶ê¸ˆì¦ë“¤ì— ëŒ€í•´ ì‚½ì§ˆí•´ë³¸ ë‚´ìš©ì„ ì •ë¦¬í•´ë³´ë ¤í•œë‹¤. ì‘ì—…í•´ë³¸ ë‚´ìš©ì€ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p>
&lt;ol>
&lt;li>&lt;strong>ingress gatewayë¥¼ í†µí•´ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì´ ì•„ë‹ˆë¼ mesh ë‚´ë¶€ì—ì„œ ë³´ë‚´ëŠ” ìš”ì²­ì— ëŒ€í•´ ì ìš©ë  ìˆ˜ ìˆë„ë¡ Virtual Serviceë¥¼ ì •ì˜í•œ ë’¤ mesh ë‚´ë¶€ì—ì„œ ìš”ì²­ì„ ë³´ë‚´ë³´ê¸°&lt;/strong>&lt;/li>
&lt;li>&lt;strong>Virtual Service ì—†ì´ Destination ì´ìš©í•´ë³´ê¸°&lt;/strong>&lt;/li>
&lt;/ol>
&lt;h2 id="virtual-serviceì™€-destination-ruleì—-ëŒ€í•´-ì§šê³ -ë„˜ì–´ê°€ë³´ì">Virtual Serviceì™€ Destination Ruleì— ëŒ€í•´ ì§šê³  ë„˜ì–´ê°€ë³´ì.&lt;/h2>
&lt;blockquote>
&lt;p>virtual services as how you route your trafficÂ toÂ a given destination, and then you use destination rules to configure what happens to trafficÂ forÂ that destination. Destination rules are applied after virtual service routing rules are evaluated, so they apply to the trafficâ€™s â€œrealâ€ destination.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a class="link" href="https://istio.io/latest/docs/concepts/traffic-management/#destination-rules" target="_blank" rel="noopener"
>https://istio.io/latest/docs/concepts/traffic-management/#destination-rules&lt;/a>&lt;/p>
&lt;blockquote>
&lt;/blockquote>
&lt;p>istioë¥¼ ì²˜ìŒ ë°°ìš¸ ë•Œì—ëŠ” (ë¬¼ë¡  ì´ ê¸€ì„ ì“°ê¸° ì „ê¹Œì§€ë„.. ã…ã…;;) Virtual Serviceì™€ Destination Ruleì´ ì°¸ í—·ê°ˆë ¸ë‹¤.&lt;/p>
&lt;p>Virtual ServiceëŠ” Gatewayë¥¼ í†µí•´ &lt;code>hosts&lt;/code> ì„¤ì •í•œ í˜¸ìŠ¤íŠ¸ë¥¼ ì´ìš©í•´ ë“¤ì–´ì˜¨ ìš”ì²­ì„ ì–´ë–¤ ê¸°ì¤€ìœ¼ë¡œ ì–´ë–¤ (ì•½ê°„ì€ ê°€ìƒì¸) ëª©ì ì§€ë¡œ ë³´ë‚´ì¤„ ê²ƒì¸ê°€ë¥¼ ì˜ë¯¸í•œë‹¤. ì´ ë§ë„ ì¢€ í—·ê°ˆë¦´ ìˆ˜ ìˆëŠ”ë° ì˜ˆë¥¼ ë“¤ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/p>
&lt;ul>
&lt;li>ingress gateway ë¥¼ í†µí•´&lt;/li>
&lt;li>Virtual Serviceì˜ hostsì¸ [â€&lt;a class="link" href="http://foo.jinsu.me/" target="_blank" rel="noopener"
>foo.jinsu.me&lt;/a>â€] ì¤‘ í•˜ë‚˜ì¸ foo.jinsu.meë¥¼ ì´ìš©í•´ ë“¤ì–´ì˜¨ ìš”ì²­ì„&lt;/li>
&lt;li>subsetì´ë‚˜ weightì— ë”°ë¼ foo v1 ì´ë‚˜ foo v2 ë¡œ ë³´ë‚¸ë‹¤.&lt;/li>
&lt;/ul>
&lt;p>ìœ„ì™€ ê°™ì€ ì„¤ì •ì„ í•´ì£¼ëŠ” ê²ƒì´ Virtual Serviceì´ë‹¤.&lt;/p>
&lt;p>ê·¸ëŸ¼ foo v1ê³¼ foo v2ëŠ” ëˆ„ê°€ ì •ì˜í•´ì¤„ê¹Œ? ê·€ì‹  ê°™ì´ ì•Œì•„ì„œ v1ì— ëŒ€í•œ endpointì™€ v2ì— ëŒ€í•œ endpointë¥¼ ë¶„ë¥˜í•  ìˆ˜ëŠ” ì—†ì„í…ë° ë§ì´ë‹¤. ë°”ë¡œ ì´ë•Œ Destination Ruleì´ ë“±ì¥í•œë‹¤.&lt;/p>
&lt;p>Destination Ruleì€ ì–´ë–¤ ê¸°ì¤€ìœ¼ë¡œ íŠ¹ì • Service(ì¿ ë²„ì˜ ê¸°ë³¸ ë¦¬ì†ŒìŠ¤ íƒ€ì…)ì— ëŒ€í•œ subsetì„ ë‚˜ëˆŒì§€ ì •ì˜í•  ìˆ˜ ìˆë‹¤. í˜¹ì€ ê·¸ ì™¸ì—ë„ ê¸°ë³¸ì ìœ¼ë¡œ Serviceê°€ ì œê³µí•˜ì§€ ì•ŠëŠ” ìœ ìš©í•œ ë°©ì‹ë“¤ì„ í†µí•´ Endpointê°€ ê´€ë¦¬ë  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤. ì´ë•Œ ë§í•˜ëŠ” EndpointëŠ” ì¿ ë²„ì˜ ê¸°ë³¸ ë¦¬ì†ŒìŠ¤ íƒ€ì… ì¤‘ í•˜ë‚˜ì¸ Endpointê°€ ì•„ë‹ˆë¼ Destination Ruleì„ í†µí•´ ì‹¤ì œë¡œ íŠ¸ë˜í”½ì´ í˜ë ¤ë³´ë‚´ì§„ë‹¤ëŠ” ì˜ë¯¸ì˜ Endpointë¥¼ ì˜ë¯¸í•œë‹¤.&lt;/p>
&lt;p>ê·¼ë° ë­,,, ë‚˜ë¦„ëŒ€ë¡œ ë‘ ê°œë…ì„ ì •ë¦¬í•´ë³´ë ¤í–ˆëŠ”ë° ì‹œì›í•œ ì •ë¦¬ëŠ” ì•„ë‹Œ ê²ƒ ê°™ë‹¤â€¦ ì“°ë‹¤ë³´ë©´ ê°ì´ì˜¤ëŠ”ë° ì•„ì§ ë”± ê¹”ë”í•˜ê²Œ ì •ë¦¬í•  ìˆ˜ ìˆëŠ” ìˆ˜ì¤€ì˜ ì´í•´ëŠ” ì•„ë‹Œê°€ë³´ë‹¤.&lt;/p>
&lt;h2 id="mesh-ë‚´ë¶€ì˜-í†µì‹ ì—ì„œë„-virtual-serviceë‚˜-destination-ruleì´-ë™ì‘í•˜ëŠ”ê°€">mesh ë‚´ë¶€ì˜ í†µì‹ ì—ì„œë„ virtual serviceë‚˜ destination ruleì´ ë™ì‘í•˜ëŠ”ê°€?&lt;/h2>
&lt;p>ì•ì„œ Virtual Serviceì— ëŒ€í•´ ì„¤ëª…í•  ë•Œ â€œGatewayë¥¼ í†µí•´ ë“¤ì–´ì˜¨ ìš”ì²­ì´ â€¦(ìƒëµ)â€ ì´ë¼ë©° ì„¤ëª…ì„ í–ˆëŠ”ë° ê·¸ë ‡ë‹¤ë©´ &lt;strong>Virtual ServiceëŠ” ingress gatewayë¥¼ í†µí•´ ë“¤ì–´ì˜¨ ìš”ì²­ì— ëŒ€í•œ ì„¤ì •ë§Œ ì •ì˜ê°€ ê°€ëŠ¥í•˜ëƒë¼ê³ í•˜ë©´ ê·¸ê±´ ë‹¹ì—°íˆ ì•„ë‹ˆë‹¤.&lt;/strong> ì• ì´ˆì— istioë¥¼ í†µí•´ ìš°ë¦¬ê°€ ì–»ê³  ì‹¶ì€ ê²ƒì€ ingressì— ëŒ€í•œ ê¸°ëŠ¥ë¿ë§Œ ì•„ë‹ˆë¼ mesh ë‚´ë¶€ í†µì‹ ì— ëŒ€í•œ ê¸°ëŠ¥ë„ í° ë¶€ë¶„ì¼ ê²ƒì´ë‹ˆ ë§ì´ë‹¤.&lt;/p>
&lt;blockquote>
&lt;p>The reserved word mesh is used to imply all the sidecars in the mesh. When this field is omitted, the default gateway (mesh) will be used, which would apply the rule to all sidecars in the mesh.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a class="link" href="https://istio.io/latest/docs/reference/config/networking/virtual-service/#VirtualService" target="_blank" rel="noopener"
>https://istio.io/latest/docs/reference/config/networking/virtual-service/#VirtualService&lt;/a>&lt;/p>
&lt;blockquote>
&lt;/blockquote>
&lt;p>&lt;strong>Virtual Serviceê°€ &lt;code>mesh&lt;/code> ë¼ëŠ” ì˜ˆì•½ëœ gateway ì´ë¦„ì„ ì´ìš©í•˜ë©´ ê·¸ê²ƒì€ mesh ë‚´ì˜ sidecarë“¤ì—ê²Œ ëª¨ë‘ ì ìš©ë˜ëŠ” ruleì´ ëœë‹¤.&lt;/strong> Virtual Serviceì˜ gatewaymesh ë‚´ë¶€ í†µì‹ ì— ìˆì–´ Virtual Serviceì˜ ì—­í• ì´ í¼ì—ë„ ë¶ˆêµ¬í•˜ê³  ì•„ì´ëŸ¬ë‹ˆí•˜ê²Œë„ ìœ„ì™€ ê°™ì€ ë‚´ìš©ì„ ì°¾ì•„ë³¼ ìˆ˜ ìˆëŠ” ë¬¸ì„œê°€ ë§ì§€ëŠ” ì•Šì•˜ë‹¤.&lt;/p>
&lt;p>ì •ë¦¬í•˜ìë©´ â€œmesh ë‚´ë¶€ì˜ í†µì‹ ì—ì„œë„ virtual serviceë‚˜ destination ruleì´ ë™ì‘í•˜ëŠ”ê°€?â€ì— ëŒ€í•œ ëŒ€ë‹µì€ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Virtual Serviceì˜ gatewaysì— &lt;code>mesh&lt;/code> ê°€ í¬í•¨ë˜ì–´ìˆê±°ë‚˜ &lt;code>gateways&lt;/code> ê°€ ìƒëµë˜ì—ˆê³ , client ì¸¡ envoy sidecarê°€ outbound handler ì—­í• ì„ ìˆ˜í–‰í•œë‹¤ë©´ â†’ YES&lt;/strong>&lt;/li>
&lt;li>Virtual Serviceì˜ gatewaysë¥¼ ì •ì˜í–ˆëŠ”ë° &lt;code>mesh&lt;/code> ê°€ í¬í•¨ë˜ì–´ìˆì§€ ì•Šë‹¤ë©´ â†’ NO&lt;/li>
&lt;li>client ì¸¡ envoy sidecarê°€ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜ outbound handler ì—­í• ì„ ì œëŒ€ë¡œ ìˆ˜í–‰í•˜ì§€ ëª»í•œë‹¤ë©´ â†’ NO&lt;/li>
&lt;/ul>
&lt;p>ê·¸ëŸ¼ í•œ ë²ˆ ì‹¤ìŠµì„ í†µí•´ í™•ì¸í•´ë³´ì.&lt;/p>
&lt;h2 id="mesh-ë‚´ë¶€-í†µì‹ ì—ì„œ-virtual-service--destination-ruleì„-í†µí•´-service-subsetê³¼-weight-ì´ìš©í•´ë³´ê¸°">mesh ë‚´ë¶€ í†µì‹ ì—ì„œ Virtual Service + Destination Ruleì„ í†µí•´ Service subsetê³¼ weight ì´ìš©í•´ë³´ê¸°&lt;/h2>
&lt;p>&lt;code>httpping-without-sidecar&lt;/code>ë¼ëŠ” ì´ë¦„ì˜ ì„œë¹„ìŠ¤ë¥¼ ë°°í¬í•´ë‘ì—ˆê³ , ì´ëŠ” golangìœ¼ë¡œ ë§Œë“¤ì–´ì§„ ìš”ì²­ì´ ë“¤ì–´ì˜¬ ë•Œ â€œpongâ€ ë¡œê·¸ë¥¼ ë‚¨ê¸°ëŠ” ë‹¨ìˆœí•œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë‹¤. ì´ ì„œë¹„ìŠ¤ì˜ Podë“¤ì€ Envoy ì‚¬ì´ë“œì¹´ë¥¼ ì£¼ì…ë°›ì§€ ì•ŠëŠ”ë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ kubectl get pod -l &lt;span class="nv">app&lt;/span>&lt;span class="o">=&lt;/span>httpping-without-sidecar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">httpping-without-sidecar-v1-7fd6bfdb57-bcpdh 1/1 Running &lt;span class="m">0&lt;/span> 2m54s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">httpping-without-sidecar-v1-7fd6bfdb57-s4smn 1/1 Running &lt;span class="m">0&lt;/span> 2m54s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">httpping-without-sidecar-v1-7fd6bfdb57-zg8td 1/1 Running &lt;span class="m">0&lt;/span> 2m54s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">httpping-without-sidecar-v2-5df8b7f656-n4cvh 1/1 Running &lt;span class="m">0&lt;/span> 2m53s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">httpping-without-sidecar-v2-5df8b7f656-nfm6q 1/1 Running &lt;span class="m">0&lt;/span> 2m53s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">httpping-without-sidecar-v2-5df8b7f656-vbgpr 1/1 Running &lt;span class="m">0&lt;/span> 2m53s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>v1 ê³¼ v2ì— ëŒ€í•œ Deployment ê°ê° ë°°í¬í•´ë‘ì—ˆë‹¤.&lt;/p>
&lt;p>ê° ë²„ì „ë³„ë¡œ 3ê°œì˜ Podê°€ ë°°í¬ë˜ì–´ìˆë‹¤.&lt;/p>
&lt;p>ë²„ì „ ë³„ë¡œ Podë“¤ì€ ë‹¤ìŒê³¼ ê°™ì´ ë¼ë²¨ì´ ë¶™ì–´ìˆë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># v1 Podì˜ ê²½ìš°&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">httpping-without-sidecar&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># v2 Podì˜ ê²½ìš°&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">httpping-without-sidecar&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Service, Destination Rule, Virtual ServiceëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Service&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">namespace&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">infra-jinsu-lab&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">httpping-without-sidecar&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">selector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">httpping-without-sidecar&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">protocol&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">TCP&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">8080&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">targetPort&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">80&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ServiceëŠ” versionì„ ëª…ì‹œí•˜ì§€ ì•Šì€ ì±„ appë§Œì„ ëª…ì‹œí•˜ëŠ” ìˆ˜í¼ì…‹ìœ¼ë¡œì„œ ì •ì˜í–ˆë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">networking.istio.io/v1alpha3&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">DestinationRule&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">namespace&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">infra-jinsu-lab&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">httpping-without-sidecar-destination&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">host&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">httpping-without-sidecar&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">subsets&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">labels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">httpping-without-sidecar&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">labels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">httpping-without-sidecar&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Destination Ruleì€ Serviceì— í•´ë‹¹í•˜ëŠ” Endpointë“¤ì˜ Subsetì²˜ëŸ¼ ì •ì˜ëœë‹¤.&lt;/p>
&lt;p>version ë¼ë²¨ì´ ì¶”ê°€ë˜ì—ˆë‹¤.&lt;/p>
&lt;p>hostëŠ” Serviceë¥¼ ê°€ë¦¬í‚¬ ìˆ˜ ìˆëŠ” ì´ë¦„ì´ì–´ì•¼í•œë‹¤. ê°™ì€ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì¼ ê²½ìš° Short nameìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ë„ ìˆê³ , ì–¸ì œëŠ” FQDN(e.g. httpping-with-sidecar.infra-jinsu.lab.svc.cluster.local)ìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ë„ ìˆë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">networking.istio.io/v1alpha3&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">VirtualService&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">namespace&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">infra-jinsu-lab&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">httpping-without-sidecar&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">hosts&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;httpping-without-sidecar&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">gateways&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">mesh&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">match&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">uri&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">prefix&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">route&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">destination&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">host&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">httpping-without-sidecar&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">subset&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">number&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">8080&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">weight&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">10&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">destination&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">host&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">httpping-without-sidecar&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">subset&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">number&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">8080&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">weight&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">90&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ì•ì„œ ë§í•œëŒ€ë¡œ í´ëŸ¬ìŠ¤í„° ë‚´ë¶€ í†µì‹ ì— ëŒ€í•´ Virtual Serviceë¥¼ ì ìš©í•˜ë ¤ë©´ &lt;code>gateways&lt;/code> ë¥¼ ìƒëµí•˜ê±°ë‚˜ &lt;code>mesh&lt;/code> ë¼ëŠ” ì˜ˆì•½ëœ ì´ë¦„ì˜ ê²Œì´íŠ¸ì›¨ì´ë¥¼ í¬í•¨ì‹œì¼œì¤€ë‹¤. ë˜í•œ mesh ë‚´ë¶€ í†µì‹ ì— ëŒ€í•´ì„œëŠ” hostsì— Destination Ruleì²˜ëŸ¼ Serviceë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆëŠ” ì´ë¦„ì„ ì ì–´ì¤€ë‹¤.&lt;/p>
&lt;p>ê·¸ë¦¬ê³ ì„œëŠ” Destination Ruleì—ì„œ ì •ì˜í•œ v1 subsetì€ weightë¥¼ 10ìœ¼ë¡œ, v2 subsetì€ weightë¥¼ 90ìœ¼ë¡œ ì„¤ì •í•´ì¤¬ë‹¤. ì´ë ‡ê²Œ ë˜ë©´ &lt;strong>ëˆ„êµ°ê°€ê°€ ì„œë¹„ìŠ¤ë¥¼ í–¥í•´ ìš”ì²­ì„ ë³´ëƒˆì„ ë•Œ v1ê³¼ v2ê°€ 1ëŒ€9ì˜ ë¹„ìœ¨ë¡œ ë¡œë“œë°¸ëŸ°ìŠ¤ê°€ ë  ê²ƒì´ë‹¤&lt;/strong> ğŸ™‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">curl -H &lt;span class="s1">&amp;#39;foo: bar&amp;#39;&lt;/span> http://httpping-without-sidecar.infra-jinsu-lab:8080/ping
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://umi0410.github.io/blog/devops/virtual-service-destination-rule-mesh-internal-traffic/weight.png"
width="2558"
height="1409"
srcset="https://umi0410.github.io/blog/devops/virtual-service-destination-rule-mesh-internal-traffic/weight_hu479968be15567657f18e71d11f31e69a_283588_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/devops/virtual-service-destination-rule-mesh-internal-traffic/weight_hu479968be15567657f18e71d11f31e69a_283588_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="ì¢Œì¸¡ì€ weightê°€ 10ì¸ v1 Pod 3ê°œ | ìš°ì¸¡ì€ weightê°€ 90ì¸ v2 Pod 3ê°œ"
class="gallery-image"
data-flex-grow="181"
data-flex-basis="435px"
>&lt;/p>
&lt;p>Envoy ì‚¬ì´ë“œì¹´ê°€ ì‚½ì…ëœ ì–´ë–¤ Podì—ì„œ ìœ„ì˜ ì»¤ë§¨ë“œë¥¼ í†µí•´ &lt;code>httpping-without-sidecar&lt;/code> ì„œë¹„ìŠ¤ë¡œ ìš”ì²­ì„ ë³´ë‚¸ ê²½ìš°ì˜ ëª¨ìŠµì´ë‹¤. ì¢Œì¸¡ ë¡œê·¸ëŠ” v1 Pod 3ê°œì˜ ë¡œê·¸ì´ê³ , ìš°ì¸¡ ë¡œê·¸ëŠ” v2 Pod 3ê°œì˜ ë¡œê·¸ì´ë‹¤.&lt;/p>
&lt;p>&lt;strong>Virtual Serviceì—ì„œ ì •ì˜í•œëŒ€ë¡œ ëŒ€ë¶€ë¶„ì˜ íŠ¸ë˜í”½ì€ v2ë¡œ í˜ëŸ¬ê°”ê³  Destination Ruleì—ì„œ ì •ì˜í•œ ëŒ€ë¡œ v1, v2ì— ëŒ€í•œ subsetì´ ì˜ ë¶„ë¥˜ëœ ë“¯í•˜ë‹¤!&lt;/strong>&lt;/p>
&lt;p>ì°¸ê³ ë¡œ ë‹¹ì—°íˆë„ í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ Enovyê°€ outbound handlingì„ í•´ì£¼ì§€ ëª»í•œë‹¤ë©´(í˜¹ì€ sidecarê°€ ì‚½ì…ë˜ì§€ ì•Šì•˜ë‹¤ë©´) weight ì¡°ì ˆë„ ë˜ì§€ ì•Šê³  ê·¸ëƒ¥ ë¼ìš´ë“œë¡œë¹ˆìœ¼ë¡œ ë¶€í•˜ê°€ ë¶„ì‚°ë  ê²ƒì´ë‹¤.&lt;/p>
&lt;h2 id="virtual-service-ì—†ì´-destination-ruleë§Œìœ¼ë¡œ-ì›í•˜ëŠ”-ë°©ì‹ì„-í†µí•´-ë¶€í•˜-ë¶„ì‚°ì‹œí‚¤ê¸°">Virtual Service ì—†ì´ Destination Ruleë§Œìœ¼ë¡œ ì›í•˜ëŠ” ë°©ì‹ì„ í†µí•´ ë¶€í•˜ ë¶„ì‚°ì‹œí‚¤ê¸°&lt;/h2>
&lt;p>ì´ë²ˆì—ëŠ” &lt;strong>Virtual Service ì—†ì´ Destination Ruleì˜ ê¸°ëŠ¥ ì¤‘ í•˜ë‚˜ì¸ consistentHashë¥¼ í†µí•œ ë¡œë“œë°¸ëŸ°ìŠ¤ë¥¼ í•´ë³¼ ê²ƒì´ë‹¤. ì´ë¥¼ ì´ìš©í•˜ë©´ íŠ¹ì • í‚¤ì— ëŒ€í•œ ê°’ì„ í•´ì‹±í•´ì„œ í•´ë‹¹ í•´ì‹œ ê°’ì„ ë‹´ë‹¹í•˜ëŠ” Podì—ê²Œ ìš”ì²­ì„ ë³´ë‚¼ ê²ƒì´ë‹¤!&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ kubectl delete virtualservice httpping-without-sidecar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">virtualservice.networking.istio.io &lt;span class="s2">&amp;#34;httpping-without-sidecar&amp;#34;&lt;/span> deleted
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Virtual Service ì—†ì´ ë™ì‘í•¨ì„ ë¶„ëª…íˆ í•˜ê¸° ìœ„í•´ ì‚­ì œí•´ì¤€ë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">networking.istio.io/v1alpha3&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">DestinationRule&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">namespace&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">infra-jinsu-lab&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">httpping-without-sidecar-destination&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">host&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">httpping-without-sidecar&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">trafficPolicy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">loadBalancer&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">consistentHash&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">httpHeaderName&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">foo&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ì´ë²ˆì—ëŠ” Destinationì„ ìœ„ì™€ ê°™ì´ ì‘ì„±í•´ì¤Œìœ¼ë¡œì¨ í—¤ë” ì¤‘ fooë¼ëŠ” í‚¤ì— ëŒ€í•œ ê°’ì— ë”°ë¼ ë¶€í•˜ê°€ ë¶„ì‚°ë˜ë„ë¡ í•  ê²ƒì´ë‹¤. &lt;strong>ê°™ì€ ê°’ìœ¼ë¡œ ìš”ì²­ì„ ë³´ë‚´ë©´ ë‹´ë‹¹í•˜ëŠ” í•´ì‹œ ê°’ì´ ë³€ê²½ë˜ì§€ ì•ŠëŠ” í•œ ê°™ì€ Podë¡œë§Œ ìš”ì²­&lt;/strong>ì´ ê°ˆ ê²ƒì´ë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">curl -H &lt;span class="s1">&amp;#39;foo: bar&amp;#39;&lt;/span> http://httpping-with-sidecar.infra-jinsu-lab:8080/ping
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Envoy ì‚¬ì´ë“œì¹´ê°€ ì‚½ì…ë˜ì–´ outbound handlerê°€ ì˜ ë™ì‘ ì¤‘ì¸ ë‹¤ë¥¸ Podì—ì„œ ìœ„ì™€ ê°™ì´ ìš”ì²­ì„ ì—¬ëŸ¬ ì°¨ë¡€ ë³´ë‚´ë´¤ë‹¤.&lt;/p>
&lt;p>&lt;img src="https://umi0410.github.io/blog/devops/virtual-service-destination-rule-mesh-internal-traffic/consistent-hash.png"
width="2560"
height="1395"
srcset="https://umi0410.github.io/blog/devops/virtual-service-destination-rule-mesh-internal-traffic/consistent-hash_huec96e079d93944483a2dbb05770995ea_198415_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/devops/virtual-service-destination-rule-mesh-internal-traffic/consistent-hash_huec96e079d93944483a2dbb05770995ea_198415_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="Consistent Hash ì„¤ì • í›„ foo: barë¼ëŠ” ë™ì¼í•œ í—¤ë”ë¡œ ìš”ì²­ì„ ë³´ë‚¸ ê²½ìš°ì˜ ë¡œê·¸"
class="gallery-image"
data-flex-grow="183"
data-flex-basis="440px"
>&lt;/p>
&lt;p>ìœ„ì™€ ê°™ì´ í•˜ë‚˜ì˜ Podë¡œë§Œ ìš”ì²­ì´ ê°„ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤!&lt;/p>
&lt;h2 id="ë§ˆì¹˜ë©°">ë§ˆì¹˜ë©°&lt;/h2>
&lt;p>ì´ë²ˆ ì£¼ì— ì—…ë¬´ê°€ ì •ë§ ë§ì•˜ëŠ”ë° ì´ë˜ ì €ë˜ ì˜¤ê°”ë˜ ëŒ€í™” ì¤‘ì— í—·ê°ˆë¦¬ëŠ” ë¶€ë¶„ì´ ìˆì–´ì„œ ê°‘ìê¸° ì•¼ë°¤ì— ì´ë ‡ê²Œ ë‚´ìš©ì„ ì •ë¦¬í•´ë´¤ë‹¤. ê³µì‹ ë¬¸ì„œë¥¼ ë‹¤ì‹œ í•œ ë²ˆ ì •ë…í•œ ë’¤ â€˜ì•„~ ì–˜ì˜ ì—­í• ì€ ì´ê±°ë‹ˆê¹Œ ì´ë ‡ê²Œ í•˜ë©´ ì´ë ‡ê²Œ ë˜ê² êµ°!â€™ì´ë¼ë©° ì‚´ì§ì¿µ ì´í•´ë¥¼ í•œ ë’¤ì— ì‹¤ìŠµì„ í•´ë´¤ê³  ê²°ê³¼ê°€ ì˜ ë‚˜ì™€ì„œ ë¿Œë“¯í•˜ë‹¤. ë§˜ í¸íˆ ì˜ ìˆ˜ ìˆì„ ë“¯.&lt;/p>
&lt;p>ë‹¤ë§Œ ë¬¸ì„œ ë‚´ìš©ê³¼ ì»¨ì…‰ë“¤ì˜ â€œì—­í• &amp;quot;ì´ë‚˜ â€œì˜ë¯¸&amp;quot;ì— ëŒ€í•œ ì´í•´ ë¿ë§Œ ì•„ë‹ˆë¼ ì‹¤ì œ ë™ì‘ í”Œë¡œìš°ê¹Œì§€ë„ ì•Œê³  ì‹¶ì€ ë§ˆìŒì€ ìˆëŠ”ë° ë„ˆë¬´ ì¡°ê¸‰í•´í•˜ëŠ” ê²ƒë³´ë‹¤ëŠ” ë¹ ë¥´ì§„ ì•Šë”ë¼ë„ ê¾¸ì¤€í•˜ê²Œ ì´ë ‡ê²Œ í•˜ë‚˜ í•˜ë‚˜ ê³µë¶€í•´ë‚˜ê°€ë©´ ë  ê²ƒì´ë¼ê³  ë¯¿ëŠ”ë‹¤!&lt;/p>
&lt;h2 id="ì°¸ê³ ">ì°¸ê³ &lt;/h2>
&lt;ul>
&lt;li>ê°ì¢… istio ë¬¸ì„œë“¤
&lt;ul>
&lt;li>Traffic Management ì»¨ì…‰ &lt;a class="link" href="https://istio.io/latest/docs/concepts/traffic-management/" target="_blank" rel="noopener"
>https://istio.io/latest/docs/concepts/traffic-management/&lt;/a>&lt;/li>
&lt;li>Traffic Management, Networking config ê´€ë ¨ ë¬¸ì„œ &lt;a class="link" href="https://istio.io/latest/docs/reference/config/networking/" target="_blank" rel="noopener"
>https://istio.io/latest/docs/reference/config/networking/&lt;/a>
&amp;laquo;&amp;laquo;&amp;laquo;&amp;lt; HEAD&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Using Istio VirtualService from inside of the cluster - &lt;a class="link" href="https://stackoverflow.com/questions/65626962/using-istio-virtualservice-from-inside-of-the-cluster" target="_blank" rel="noopener"
>https://stackoverflow.com/questions/65626962/using-istio-virtualservice-from-inside-of-the-cluster&lt;/a>
=======&lt;/li>
&lt;li>Using Istio VirtualService from inside of the cluster - &lt;a class="link" href="https://stackoverflow.com/questions/65626962/using-istio-virtualservice-from-inside-of-the-cluster" target="_blank" rel="noopener"
>https://stackoverflow.com/questions/65626962/using-istio-virtualservice-from-inside-of-the-cluster&lt;/a>&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;blockquote>
&lt;blockquote>
&lt;blockquote>
&lt;blockquote>
&lt;blockquote>
&lt;blockquote>
&lt;p>a5aea5fa65117a37072d4d860951c123a5333dcf&lt;/p>
&lt;/blockquote>
&lt;/blockquote>
&lt;/blockquote>
&lt;/blockquote>
&lt;/blockquote>
&lt;/blockquote>
&lt;/blockquote></description></item><item><title>istioì™€ envoy proxyë¥¼ í†µí•´ ê²½í—˜í•´ë³´ëŠ” ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ (istio 1.10)</title><link>https://umi0410.github.io/blog/devops/istio-1-10-network-interface/</link><pubDate>Sun, 17 Jul 2022 22:00:00 +0900</pubDate><guid>https://umi0410.github.io/blog/devops/istio-1-10-network-interface/</guid><description>&lt;img src="https://umi0410.github.io/blog/devops/istio-1-10-network-interface/preview.png" alt="Featured image of post istioì™€ envoy proxyë¥¼ í†µí•´ ê²½í—˜í•´ë³´ëŠ” ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ (istio 1.10)" />&lt;h2 id="ì‹œì‘í•˜ë©°">ì‹œì‘í•˜ë©°&lt;/h2>
&lt;p>ìš”ì¦˜ istioë¥¼ ê³µë¶€í•˜ë˜ ì¤‘ istioê°€ ë³€í™”í•´ì˜¨ ê³¼ì •ì— ëŒ€í•´ì„œë„ í¥ë¯¸ê°€ ìƒê²¨ ì§€ë‚œ ë²„ì „ë“¤ì˜ ë¦´ë¦¬ì¦ˆ ë…¸íŠ¸ë“¤ë„ ì½ì–´ë³´ê³  ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë˜ ì¤‘ í˜„ ì‹œì (2022ë…„ 7ì›”)ì—ëŠ” ì´ë¯¸ ê³µì‹ì ì¸ End of Lifeê°€ ì§€ë‚œ &lt;strong>2021ë…„ 3ì›” ì²˜ìŒ ë¦´ë¦¬ì¦ˆëœ istio 1.10ì˜ ë¦´ë¦¬ì¦ˆ ë…¸íŠ¸ë¥¼ ë³´ë‹¤ê°€ ì¬ë¯¸ìˆëŠ” ì ì„ í•˜ë‚˜ ë°œê²¬&lt;/strong>í•  ìˆ˜ ìˆì—ˆëŠ”ë°ìš”.&lt;/p>
&lt;p>ë°”ë¡œ &lt;strong>envoy proxyê°€ &lt;code>eth0&lt;/code>ì— ëŒ€í•œ ìš”ì²­ì„ ë„˜ê²¨ì£¼ëŠ” containerì˜ network interfaceê°€ &lt;code>lo&lt;/code> ì—ì„œ &lt;code>eth0&lt;/code> ë¡œ ë³€ê²½ë˜ì—ˆë‹¤&lt;/strong>ëŠ” ì ì…ë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ì— ëŒ€í•´, ê·¸ ì¤‘ì—ì„œë„ íŠ¹íˆ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì— ëŒ€í•´ ì˜ ëª°ëë˜ ë•Œì—ëŠ” ì´ ë³€ê²½ì‚¬í•­ì— ê·¸ë‹¥ ê´€ì‹¬ì´ ì•ˆ ê°”ì„ ê²ƒ ê°™ì€ë° ìµœê·¼ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì— ëŒ€í•´ ê³µë¶€ë¥¼ í•´ì„œì¸ì§€ ì´ ë³€ê²½ì‚¬í•­ì— ê´€ì‹¬ì´ ê°”ìŠµë‹ˆë‹¤.&lt;/p>
&lt;p>ê·¸ë˜ì„œ ì´ë²ˆ ê¸€ì—ì„œëŠ” ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì™€ ê´€ë ¨ëœ &lt;code>istio&lt;/code> &lt;code>1.9&lt;/code> â†’ &lt;code>1.10&lt;/code>ì˜ ë³€ê²½ì‚¬í•­ì„ ì‹¤ì œ ì‘ì—…ì„ í†µí•´ í™•ì¸í•´ë³´ë ¤í•©ë‹ˆë‹¤. ì‹¤ì œ ì‘ì—…ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.&lt;/p>
&lt;ul>
&lt;li>&lt;strong>istio 1.9&lt;/strong> - ì„œë²„ë¥¼ &lt;code>lo&lt;/code> (ë£¨í”„ë°± ì¸í„°í˜ì´ìŠ¤)ì˜ IP(127.0.0.1)ë¡œ ë„ìš´ ê²½ìš° Serviceì— ìš”ì²­ì„ ë³´ë‚´ ì„±ê³µì ì¸ ì‘ë‹µì„ ë°›ì„ ìˆ˜ ìˆìŒì„ í™•ì¸&lt;/li>
&lt;li>&lt;strong>istio 1.9&lt;/strong> - ì„œë²„ë¥¼ &lt;code>eth0&lt;/code> ì˜ IPë¡œ ë„ìš´ ê²½ìš° Serviceì— ìš”ì²­ì„ ë³´ë‚´ë„ ìš”ì²­ì´ ì œëŒ€ë¡œ ì „ë‹¬ë˜ì§€ ì•ŠìŒì„ í™•ì¸&lt;/li>
&lt;li>&lt;strong>istio 1.10&lt;/strong> - ì„œë²„ë¥¼ &lt;code>lo&lt;/code> (ë£¨í”„ë°± ì¸í„°í˜ì´ìŠ¤)ì˜ IP(127.0.0.1)ë¡œ ë„ìš´ ê²½ìš° Serviceì— ìš”ì²­ì„ ë³´ë‚´ë„ ìš”ì²­ì´ ì œëŒ€ë¡œ ì „ë‹¬ë˜ì§€ ì•ŠìŒì„ í™•ì¸&lt;/li>
&lt;li>&lt;strong>istio 1.10&lt;/strong> - ì„œë²„ë¥¼ &lt;code>eth0&lt;/code> ì˜ IPë¡œ ë„ìš´ ê²½ìš° Serviceì— ìš”ì²­ì„ ë³´ë‚´ ì„±ê³µì ì¸ ì‘ë‹µì„ ë°›ì„ ìˆ˜ ìˆìŒì„ í™•ì¸&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://umi0410.github.io/blog/devops/istio-1-10-network-interface/version-compatibility.png"
width="2602"
height="710"
srcset="https://umi0410.github.io/blog/devops/istio-1-10-network-interface/version-compatibility_hu9ee91d2674eb5146d2a8fafcbb1eff3a_90034_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/devops/istio-1-10-network-interface/version-compatibility_hu9ee91d2674eb5146d2a8fafcbb1eff3a_90034_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="istio &amp;lt;-&amp;gt; k8s ë²„ì „ í˜¸í™˜ì„±"
class="gallery-image"
data-flex-grow="366"
data-flex-basis="879px"
>&lt;/p>
&lt;p>&lt;code>k8s&lt;/code> ë²„ì „ì€ istio 1.9ì™€ istio 1.10 ëª¨ë‘ì™€ í˜¸í™˜ë˜ëŠ” k8s &lt;code>1.20&lt;/code> ì„ ì´ìš©í•  ê²ƒì´ê³  k8sëŠ” &lt;code>minikube&lt;/code>ë¥¼ í†µí•´ ë¡œì»¬ì—ì„œ êµ¬ì„±í•  ê²ƒì…ë‹ˆë‹¤.&lt;/p>
&lt;p>âš ï¸ ì°¸ê³ ë¡œ M1 ë§¥ë¶ì˜ minikubeì—ì„  envoy proxyê°€ ë™ì‘í•˜ì§€ ì•Šì•„ì„œì¸ì§€ istioë¥¼ ì œëŒ€ë¡œ ì´ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì €ëŠ” ubuntuì—ì„œ minikubeë¥¼ í†µí•´ ì‘ì—…í–ˆìŠµë‹ˆë‹¤.&lt;/p>
&lt;h2 id="istio-19--110-ë³€ê²½ì‚¬í•­-ì¤‘-ì¬ë¯¸ìˆëŠ”-ì ">istio 1.9 â†’ 1.10 ë³€ê²½ì‚¬í•­ ì¤‘ ì¬ë¯¸ìˆëŠ” ì &lt;/h2>
&lt;p>&lt;img src="https://umi0410.github.io/blog/devops/istio-1-10-network-interface/networking-change.png"
width="2280"
height="970"
srcset="https://umi0410.github.io/blog/devops/istio-1-10-network-interface/networking-change_hu6fe6d6382b53ebbea105f054157c1f5e_208679_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/devops/istio-1-10-network-interface/networking-change_hu6fe6d6382b53ebbea105f054157c1f5e_208679_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="1.10 ë¦´ë¦¬ì¦ˆ ë…¸íŠ¸"
class="gallery-image"
data-flex-grow="235"
data-flex-basis="564px"
>&lt;/p>
&lt;p>(ì°¸ê³ : &lt;a class="link" href="https://istio.io/latest/news/releases/1.10.x/announcing-1.10/" target="_blank" rel="noopener"
>https://istio.io/latest/news/releases/1.10.x/announcing-1.10/&lt;/a>)&lt;/p>
&lt;p>1.10 ë²„ì „ì˜ ë³€ê²½ì‚¬í•­ì— ëŒ€í•´ ì¢€ ë” ìì„¸íˆ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤. ì´ì „ ë²„ì „ì—ì„œëŠ” Sidecar Envoy Proxyê°€ &lt;code>eth0&lt;/code>ìœ¼ë¡œ ë“¤ì–´ì˜¨ ìš”ì²­ì„ &lt;code>lo&lt;/code>ë¡œ ë„˜ê²¨ì¤˜ì™”ëŠ”ë° ì´ë²ˆ ë²„ì „(1.10)ì—ì„œë¶€í„°ëŠ” &lt;code>eth0&lt;/code>ë¡œ ë“¤ì–´ì˜¨ ìš”ì²­ì„ eth0ë¡œ ë„˜ê²¨ì¤€ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.&lt;/p>
&lt;p>ëŒ€ë¶€ë¶„ ì„œë²„ë¥¼ ë„ìš¸ ë•Œ &lt;code>0.0.0.0&lt;/code>ì„ í†µí•´ loopback interfaceì™€ ethernet interface ëª¨ë‘ì— ì„œë²„ë¥¼ ë„ìš°ëŠ” ê²½ìš°ê°€ ë§ì•„ í•´ë‹¹ ë‚´ìš©ì´ í° ë³€í™”ë¥¼ ê°€ì ¸ì˜¤ì§„ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p>
&lt;p>í•˜ì§€ë§Œ ë§Œì•½ ê¸°ì¡´ì— íŠ¹ì • interfaceì˜ IPë§Œì„ ì§€ì •í•´ì„œ ì„œë²„ë¥¼ ë„ìš°ëŠ” ê²½ìš°ê°€ ìˆì—ˆë‹¤ë©´ ì´ ë³€ê²½ì‚¬í•­ìœ¼ë¡œ ì¸í•´ í†µì‹  ì¥ì• ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p>
&lt;ul>
&lt;li>loopback interfaceì˜ IPë¡œë§Œ ì„œë²„ë¥¼ ë„ìš´ ê²½ìš° â†’ &lt;code>eth0&lt;/code>ë¡œ ë³´ë‚¸ ìš”ì²­ì„ sidecarë¥¼ ê±°ì³ &lt;code>lo&lt;/code>ê°€ ë°›ì„ ìˆ˜ ìˆë˜ ì»¨í…Œì´ë„ˆê°€ ìš”ì²­ì„ ë°›ì„ ìˆ˜ ì—†ì–´ì§.&lt;/li>
&lt;li>eth0 interfaceì˜ IPë¡œë§Œ ì„œë²„ë¥¼ ë ìš´ ê²½ìš° â†’ &lt;code>eth0&lt;/code>ë¡œ ë³´ë‚¸ ìš”ì²­ì„ sidecarë¥¼ ê±°ì³ ì—¬ì „íˆ &lt;code>eth0&lt;/code>ê°€ ìš”ì²­ì„ ë°›ì„ ìˆ˜ ìˆì–´ì§.&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>ì´ëŸ¬í•œ ë³€ê²½ ì‚¬í•­ì´ ì¶”ê°€ëœ ì´ìœ ëŠ”?&lt;/strong>&lt;/p>
&lt;p>On-premiseë‚˜ non-k8s í™˜ê²½ì—ì„œëŠ” ë³´í†µ &lt;code>lo&lt;/code> ì— ì„œë²„ë¥¼ ë„ìš°ëŠ” ê²½ìš°ëŠ” ì™¸ë¶€ì—ì„œì˜ ì ‘ì†ì„ ë§‰ìœ¼ë ¤ëŠ” ê²½ìš°ì¼ ê²ƒì…ë‹ˆë‹¤. ë°˜ë©´ &lt;code>eth0&lt;/code> ì— ì„œë²„ë¥¼ ë„ìš°ëŠ” ê²½ìš°ëŠ” ì™¸ë¶€ì—ì„œì˜ ì ‘ì†ì„ í—ˆìš©í•˜ë ¤ëŠ” ê²½ìš°ì¼ ê²ƒì…ë‹ˆë‹¤.&lt;/p>
&lt;p>í•˜ì§€ë§Œ ì´ì „ì—ëŠ” ì´ëŸ¬í•œ ê¸°ì¡´ í™˜ê²½ì—ì„œ istioë¥¼ ë„ì…í•˜ê²Œ ë˜ë©´ ê¸°ì¡´ì˜ ì˜ë„ì™€ ë°˜ëŒ€ë˜ê²Œ ì˜¤íˆë ¤ &lt;code>lo&lt;/code> ì— ì„œë²„ë¥¼ ë„ìš´ ê²½ìš° ì˜¤íˆë ¤ envoy sidecarì—ê²Œ ìš”ì²­ì„ ì „ë‹¬ë°›ì„ ìˆ˜ ìˆì–´ì§€ê³ , &lt;code>eth0&lt;/code> ì— ì„œë²„ë¥¼ ë„ìš´ ê²½ìš°ëŠ” ì˜¤íˆë ¤ enovy sidecarì—ê²Œ ìš”ì²­ì„ ì „ë‹¬ë°›ì„ ìˆ˜ ì—†ì—ˆë˜ ëª¨ìˆœëœ ìƒí™©ì´ ë°œìƒí–ˆë‹¤ê³  í•©ë‹ˆë‹¤.&lt;/p>
&lt;p>ë”°ë¼ì„œ ì´ëŸ¬í•œ ëª¨ìˆœëœ ìƒí™©ë“¤ì„ ë°©ì§€í•˜ê³ ì ì´ëŸ¬í•œ ë³€ê²½ì‚¬í•­ì´ ì¶”ê°€ë˜ì—ˆë‹¤ê³  í•©ë‹ˆë‹¤.&lt;/p>
&lt;h2 id="minikubeë¥¼-í†µí•´-k8s-12015-í™˜ê²½-êµ¬ì¶•í•˜ê¸°">minikubeë¥¼ í†µí•´ k8s 1.20.15 í™˜ê²½ êµ¬ì¶•í•˜ê¸°&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ minikube start --profile k8s-1-20 --kubernetes-version 1.20.15
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ìœ„ì˜ ëª…ë ¹ì–´ë¥¼ í†µí•´ íŠ¹ì • k8s ë²„ì „(1.20.15)ì˜ í™˜ê²½ì„ ë¡œì»¬ì— êµ¬ì¶•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p>
&lt;h2 id="k8sì—-istio-19ì™€-110-ì„¤ì¹˜í•˜ê¸°">k8sì— istio 1.9ì™€ 1.10 ì„¤ì¹˜í•˜ê¸°&lt;/h2>
&lt;p>istioctlì„ í†µí•´ ë‘ ë²„ì „ì˜ istioë¥¼ k8s clusterì— ë°°í¬í•´ì¤„ ê²ƒì…ë‹ˆë‹¤.&lt;/p>
&lt;p>istioctlì˜ ë²„ì „ì— ë§ê²Œ istioê°€ ì„¤ì¹˜ë˜ê¸° ë•Œë¬¸ì— ê·¸ë•Œ ê·¸ë•Œ í¸ë¦¬í•˜ê²Œ istioctlì˜ ë²„ì „ì„ ë³€ê²½í•´ì•¼í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ì €ëŠ” &lt;a class="link" href="https://github.com/asdf-vm/asdf" target="_blank" rel="noopener"
>asdf&lt;/a>ë¼ëŠ” ë„êµ¬ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. ìŠ¤íƒ€ ìˆ˜ëŠ” ì ì§€ë§Œ &lt;a class="link" href="https://github.com/virtualstaticvoid/asdf-istioctl" target="_blank" rel="noopener"
>asdfì˜ istioctl plugin&lt;/a>ì„ ì´ìš©í•˜ê¸°ë„ í–ˆìŠµë‹ˆë‹¤.&lt;/p>
&lt;p>&lt;img src="https://umi0410.github.io/blog/devops/istio-1-10-network-interface/istioctl-profiles.png"
width="3182"
height="582"
srcset="https://umi0410.github.io/blog/devops/istio-1-10-network-interface/istioctl-profiles_huc2f3f759952870d04254f07cdea3bebc_60119_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/devops/istio-1-10-network-interface/istioctl-profiles_huc2f3f759952870d04254f07cdea3bebc_60119_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="ë¯¸ë¦¬ ì •ì˜ë˜ì–´ ìˆëŠ” Profile ëª©ë¡"
class="gallery-image"
data-flex-grow="546"
data-flex-basis="1312px"
>&lt;/p>
&lt;p>ì°¸ê³ : &lt;a class="link" href="https://istio.io/latest/docs/setup/additional-setup/config-profiles/" target="_blank" rel="noopener"
>https://istio.io/latest/docs/setup/additional-setup/config-profiles/&lt;/a>&lt;/p>
&lt;p>istioctlì„ í†µí•´ istioë¥¼ í´ëŸ¬ìŠ¤í„°ì— ë°°í¬í•  ë•Œì—ëŠ” ë¯¸ë¦¬ ì •ì˜ë˜ì–´ìˆëŠ” profileì´ë¼ëŠ” ê²ƒì„ ì´ìš©í•´ ì¢€ ë” í¸ë¦¬í•˜ê²Œ ì„¤ì •ì„ í•´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë²ˆ ì‘ì—…ì—ì„œ gatewayë“¤ì€ í•„ìš” ì—†ê¸° ë•Œë¬¸ì— ì €ëŠ” minimal profileì„ í†µí•´ ì„¤ì¹˜í•´ì£¼ê² ìŠµë‹ˆë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">asdf plugin-add istioctl https://github.com/virtualstaticvoid/asdf-istioctl.git &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>asdf install istioctl 1.9.9 &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>asdf install istioctl 1.10.6
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ìœ„ì˜ ëª…ë ¹ì–´ë¥¼ í†µí•´ istioctl 1.9.9ì™€ 1.10.6 ë‘ ë²„ì „ì„ ëª¨ë‘ ì„¤ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ asdf global istioctl 1.9.9 &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> istioctl version
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">no running Istio pods in &lt;span class="s2">&amp;#34;istio-system&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1.9.9
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>istioctl 1.9.9ë¥¼ ì´ìš©í•˜ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">istioctl install --set &lt;span class="nv">profile&lt;/span>&lt;span class="o">=&lt;/span>minimal --set &lt;span class="nv">revision&lt;/span>&lt;span class="o">=&lt;/span>1-9 --set values.global.proxy.holdApplicationUntilProxyStarts&lt;span class="o">=&lt;/span>&lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">! values.global.proxy.holdApplicationUntilProxyStarts is deprecated&lt;span class="p">;&lt;/span> use meshConfig.defaultConfig.holdApplicationUntilProxyStarts instead
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">! Istio is being downgraded from 1.9.0 -&amp;gt; 1.9.9.This will install the Istio 1.9.9 minimal profile with &lt;span class="o">[&lt;/span>&lt;span class="s2">&amp;#34;Istio core&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;Istiod&amp;#34;&lt;/span>&lt;span class="o">]&lt;/span> components into the cluster. Proceed? &lt;span class="o">(&lt;/span>y/N&lt;span class="o">)&lt;/span> y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ” Istio core installed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ” Istiod installed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ” Installation &lt;span class="nb">complete&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>istio 1.9.9ë¥¼ &lt;code>1-9&lt;/code>ë¼ëŠ” revisionìœ¼ë¡œ ê¹”ì•„ì¤ë‹ˆë‹¤.&lt;/p>
&lt;p>&lt;code>values.global.proxy.holdApplicationUntilProxyStarts&lt;/code>ì™€ &lt;code>meshConfig.defaultConfig.holdApplicationUntilProxyStarts&lt;/code>ëŠ” envoy proxyê°€ ì¤€ë¹„ëœ ë’¤ì—
ìš°ë¦¬ê°€ ì •ì˜í•œ ì‹¤ì œ ì»¨í…Œì´ë„ˆë¥¼ ì‹œì‘í•˜ëŠ” ì˜µì…˜ì…ë‹ˆë‹¤. ì „ìëŠ” Deprecated ë˜ì—ˆë‹¤ê³  ê²½ê³ ê°€ ëœ¨ì§€ë§Œ ì ìš©í•´ë³¸ ê²°ê³¼ 1.9 ë²„ì „ ëŒ€ì—ì„œëŠ” ì—¬ì „íˆ ì „ìë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒ ê°™ë”ë¼êµ¬ìš”.
ë”°ë¼ì„œ ì €ëŠ” 1.9.9 ë²„ì „ì—ì„œëŠ” ì „ìì˜ ì¸ìë¥¼, 1.10.6 ë²„ì „ì—ì„œëŠ” í›„ìì˜ ì¸ìë¥¼ ì ìš©í•´ì£¼ì—ˆìŠµë‹ˆë‹¤.&lt;/p>
&lt;p>ë§Œì•½ envoy proxyê°€ ì™„ì „íˆ ì¤€ë¹„ë˜ê¸° ì „ì— ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆì—ì„œ ë„¤íŠ¸ì›Œí¬ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë©´ í•´ë‹¹ ì‘ì—…ì€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜í–‰ë˜ì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ asdf global istioctl 1.10.6 &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> istioctl version
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">client version: 1.10.6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">control plane version: 1.9.9
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">data plane version: none
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>istioctl 1.10.6ì„ ì´ìš©í•˜ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ istioctl install --set &lt;span class="nv">profile&lt;/span>&lt;span class="o">=&lt;/span>minimal --set &lt;span class="nv">revision&lt;/span>&lt;span class="o">=&lt;/span>1-10 --set meshConfig.defaultConfig.holdApplicationUntilProxyStarts&lt;span class="o">=&lt;/span>&lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WARNING: Istio is being upgraded from 1.9.9 -&amp;gt; 1.10.6.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WARNING: Before upgrading, you may wish to use &lt;span class="s1">&amp;#39;istioctl analyze&amp;#39;&lt;/span> to check forIST0002 and IST0135 deprecation warnings.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">This will install the Istio 1.10.6 minimal profile with &lt;span class="o">[&lt;/span>&lt;span class="s2">&amp;#34;Istio core&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;Istiod&amp;#34;&lt;/span>&lt;span class="o">]&lt;/span> components into the cluster. Proceed? &lt;span class="o">(&lt;/span>y/N&lt;span class="o">)&lt;/span> y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ” Istio core installed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ” Istiod installed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ” Installation &lt;span class="nb">complete&lt;/span> Thank you &lt;span class="k">for&lt;/span> installing Istio 1.10. Please take a few minutes to tell us about your install/upgrade experience! https://forms.gle/KjkrDnMPByq7akrYA
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>istio 1.10.6ì„ &lt;code>1-10&lt;/code>ì´ë¼ëŠ” revisionìœ¼ë¡œ ê¹”ì•„ì¤ë‹ˆë‹¤.&lt;/p>
&lt;p>ì›Œë‹ì´ ë– ìˆê¸´ í•˜ì§€ë§Œ ê·¸ë‹¥ ìƒê´€ì€ ì—†ìŠµë‹ˆë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ kubectl get pod -n istio-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">istiod-1-10-5cd4d5b44d-b98xm 1/1 Running &lt;span class="m">0&lt;/span> 84s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">istiod-1-9-6b549b9d87-9f76b 1/1 Running &lt;span class="m">0&lt;/span> 2m56s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ì˜ ê¹”ë ¸ë‹¤ë©´ ìœ„ì™€ ê°™ì´ Podë“¤ì´ ì„±ê³µì ìœ¼ë¡œ ë–´ì„ ê²ƒì…ë‹ˆë‹¤.&lt;/p>
&lt;h2 id="istio-sidecarê°€-injectedëœ-netcat-server--client-pod-ë°°í¬í•˜ê¸°">istio sidecarê°€ injectedëœ netcat server &amp;amp; client Pod ë°°í¬í•˜ê¸°&lt;/h2>
&lt;p>ì´ì œ netcat serverì´ì clientê°€ ë  Pod ë“¤ì„ ë°°í¬í•´ì¤„ ê²ƒì…ë‹ˆë‹¤.&lt;/p>
&lt;p>ë°°í¬í•  ë¦¬ì†ŒìŠ¤ë“¤ì€ ëª¨ë‘ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Namespace rev-1-9&lt;/strong> - istio 1.9ì˜ sidecar injectë¥¼ ë°›ì„ Namespace&lt;/li>
&lt;li>&lt;strong>Namespace rev-1-10&lt;/strong> - istio 1.10ì˜ sidecar injectë¥¼ ë°›ì„ Namespace&lt;/li>
&lt;li>&lt;strong>Pod netcat-client&lt;/strong> - &lt;code>default&lt;/code> Namespaceì—ì„œ ê° Serviceë¥¼ í†µí•´ netcat ìš”ì²­ì„ ë‚ ë ¤ì¤„ client&lt;/li>
&lt;li>&lt;strong>Pod netcat-lo&lt;/strong> - &lt;code>lo&lt;/code> ì¸í„°í˜ì´ìŠ¤ì˜ IP ì— netcat ì„œë²„ë¥¼ ë„ìš°ëŠ” Pod.&lt;/li>
&lt;li>&lt;strong>Pod netcat-eth0&lt;/strong> - &lt;code>eth0&lt;/code> ì¸í„°í˜ì´ìŠ¤ì˜ IPì— netcat ì„œë²„ë¥¼ ë„ìš°ëŠ” Pod.&lt;/li>
&lt;li>&lt;strong>Service lo&lt;/strong> - &lt;code>lo&lt;/code> ì¸í„°í˜ì´ìŠ¤ì˜ IPì— netcat ì„œë²„ë¥¼ ë„ìš´ Podë¥¼ ë…¸ì¶œì‹œì¼œì¤„ Service&lt;/li>
&lt;li>&lt;strong>Service eth0&lt;/strong> - &lt;code>eth0&lt;/code> ì¸í„°í˜ì´ìŠ¤ì˜ IPì— netcat ì„œë²„ë¥¼ ë„ìš´ Podë¥¼ ë…¸ì¶œì‹œì¼œì¤„ Service&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>(netcat ì„œë²„ PodëŠ” 8080 í¬íŠ¸ì— ìš”ì²­ì´ TCP ì»¤ë„¥ì…˜ì´ í˜•ì„±ë˜ë©´ â€œpongâ€ìœ¼ë¡œ ì‘ë‹µí•˜ëŠ” Podì…ë‹ˆë‹¤.)&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Namespace&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">labels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">istio.io/rev&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1-9&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rev-1-9&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nn">---&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Namespace&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">labels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">istio.io/rev&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1-10&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rev-1-10&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nn">---&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">namespace&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">default&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">netcat-client&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu:22.04&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;/bin/bash&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;-c&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> apt update &amp;amp;&amp;amp; apt install -y ncat
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> while true;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> do sleep 60;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> done;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">imagePullPolicy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">IfNotPresent&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">netcat-client&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">restartPolicy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Always&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nn">---&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">namespace&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rev-1-9&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">netcat-lo&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">labels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rev-1-9-lo&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu:22.04&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;/bin/bash&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;-c&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> apt update &amp;amp;&amp;amp; apt install -y net-tools ncat
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> ifconfig eth0 | grep &amp;#39;inet &amp;#39; | awk &amp;#39;{print $2}&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> while true
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> do echo &amp;#39;pong&amp;#39; | nc -l 127.0.0.1 8080
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> sleep 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> done&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">imagePullPolicy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">IfNotPresent&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">containerPort&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">8080&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">restartPolicy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Always&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nn">---&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">namespace&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rev-1-10&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">netcat-lo&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">labels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">istio.io/rev&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1-10&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rev-1-10-lo&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu:22.04&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;/bin/bash&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;-c&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> apt update &amp;amp;&amp;amp; apt install -y net-tools ncat
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> while true
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> do echo &amp;#39;pong&amp;#39; | nc -l 127.0.0.1 8080
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> sleep 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> done&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">imagePullPolicy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">IfNotPresent&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">containerPort&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">8080&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">restartPolicy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Always&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nn">---&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">namespace&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rev-1-9&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">netcat-eth0&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">labels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">istio.io/rev&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1-9&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rev-1-9-eth0&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu:22.04&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;/bin/bash&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;-c&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> apt update &amp;amp;&amp;amp; apt install -y net-tools ncat
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> ifconfig eth0 | grep &amp;#39;inet &amp;#39; | awk &amp;#39;{print $2}&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> while true
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> do echo &amp;#39;pong&amp;#39; | nc -l $(ifconfig eth0 | grep &amp;#39;inet &amp;#39; | awk &amp;#39;{print $2}&amp;#39;) 8080
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> sleep 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> done&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">imagePullPolicy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">IfNotPresent&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">containerPort&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">8080&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">restartPolicy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Always&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nn">---&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">namespace&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rev-1-10&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">netcat-eth0&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">labels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">istio.io/rev&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1-10&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rev-1-10-eth0&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu:22.04&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;/bin/bash&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;-c&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> apt update &amp;amp;&amp;amp; apt install -y net-tools ncat
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> ifconfig eth0 | grep &amp;#39;inet &amp;#39; | awk &amp;#39;{print $2}&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> while true
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> do echo &amp;#39;pong&amp;#39; | nc -l $(ifconfig eth0 | grep &amp;#39;inet &amp;#39; | awk &amp;#39;{print $2}&amp;#39;) 8080
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> done&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">imagePullPolicy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">IfNotPresent&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">containerPort&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">8080&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">restartPolicy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Always&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nn">---&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Service&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">namespace&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rev-1-9&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">lo&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">8080&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">protocol&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">TCP&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">selector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rev-1-9-lo&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nn">---&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Service&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">namespace&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rev-1-9&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">eth0&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">8080&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">protocol&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">TCP&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">selector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rev-1-9-eth0&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nn">---&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Service&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">namespace&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rev-1-10&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">lo&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">8080&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">protocol&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">TCP&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">selector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rev-1-10-lo&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nn">---&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Service&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">namespace&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rev-1-10&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">eth0&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">8080&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">protocol&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">TCP&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">selector&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">rev-1-10-eth0&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ kubectl apply -f tmp.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">namespace/rev-1-9 created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">namespace/rev-1-10 created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/netcat-client created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/netcat-lo created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/netcat-lo created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/netcat-eth0 created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/netcat-eth0 created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">service/lo created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">service/eth0 created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">service/lo created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">service/eth0 created
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ìœ„ì˜ ëª…ë ¹ì–´ë“¤ì„ ì´ìš©í•´ sidecarê°€ injectedë  netcat ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ Podë¥¼ ë°°í¬í•´ì¤ë‹ˆë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ kubectl get pod -A
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAMESPACE NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">default netcat-client 1/1 Running &lt;span class="m">0&lt;/span> 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">istio-system istiod-1-10-5cd4d5b44d-8lv2h 1/1 Running &lt;span class="m">0&lt;/span> 145m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">istio-system istiod-1-9-5ccbd888d8-scdzz 1/1 Running &lt;span class="m">0&lt;/span> 107m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rev-1-10 netcat-eth0 2/2 Running &lt;span class="m">0&lt;/span> 18m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rev-1-10 netcat-lo 2/2 Running &lt;span class="m">0&lt;/span> 18m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rev-1-9 netcat-eth0 2/2 Running &lt;span class="m">1&lt;/span> 17m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rev-1-9 netcat-lo 2/2 Running &lt;span class="m">1&lt;/span> 17m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ kubectl get svc -A
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAMESPACE NAME TYPE CLUSTER-IP EXTERNAL-IP PORT&lt;span class="o">(&lt;/span>S&lt;span class="o">)&lt;/span> AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">default kubernetes ClusterIP 10.96.0.1 &amp;lt;none&amp;gt; 443/TCP 3h10m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">istio-system istiod-1-10 ClusterIP 10.110.227.112 &amp;lt;none&amp;gt; 15010/TCP,15012/TCP,443/TCP,15014/TCP 3h3m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">istio-system istiod-1-9 ClusterIP 10.107.205.100 &amp;lt;none&amp;gt; 15010/TCP,15012/TCP,443/TCP,15014/TCP 145m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system kube-dns ClusterIP 10.96.0.10 &amp;lt;none&amp;gt; 53/UDP,53/TCP,9153/TCP 3h10m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rev-1-10 eth0 ClusterIP 10.111.38.103 &amp;lt;none&amp;gt; 8080/TCP 35m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rev-1-10 lo ClusterIP 10.106.100.209 &amp;lt;none&amp;gt; 8080/TCP 35m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rev-1-9 eth0 ClusterIP 10.105.29.177 &amp;lt;none&amp;gt; 8080/TCP 35m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rev-1-9 lo ClusterIP 10.100.228.64 &amp;lt;none&amp;gt; 8080/TCP 35m
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ì„±ê³µì ìœ¼ë¡œ ë°°í¬í–ˆë‹¤ë©´ ìœ„ì™€ ê°™ì„ ê²ƒì…ë‹ˆë‹¤.&lt;/p>
&lt;h2 id="netcat-ì„œë²„ë“¤ì—ê²Œ-ìš”ì²­-ë³´ë‚´ë³´ê¸°">netcat ì„œë²„ë“¤ì—ê²Œ ìš”ì²­ ë³´ë‚´ë³´ê¸°&lt;/h2>
&lt;p>kubectl execì™€ netcat ëª…ë ¹ì–´ë¥¼ í†µí•´ &lt;code>netcat-client&lt;/code> ì˜ ì´ë¦„ìœ¼ë¡œ ë°°í¬í•œ Podë¡œ ê° Serviceë“¤ì„ ê±°ì³ ê° Podì—ê²Œ ìš”ì²­ì„ ë³´ë‚´ë³¼ ê²ƒì…ë‹ˆë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ kubectl &lt;span class="nb">exec&lt;/span> -n default netcat-client -- bash -c &lt;span class="s2">&amp;#34;echo &amp;#39;ping&amp;#39; | nc lo.rev-1-9 8080&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pong
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ kubectl &lt;span class="nb">exec&lt;/span> -n default netcat-client -- bash -c &lt;span class="s2">&amp;#34;echo &amp;#39;ping&amp;#39; | nc eth0.rev-1-9 8080&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Ncat: Connection reset by peer.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">command&lt;/span> terminated with &lt;span class="nb">exit&lt;/span> code &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ê° Podì˜ netcat serverê°€ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ë©´ ìœ„ì™€ ê°™ì´ &lt;code>netcat-client&lt;/code> Podë¥¼ ì´ìš©í•´ ëª…ë ¹ì„ ë‚ ë ¤ ì‘ë‹µì„ ë°›ì•„ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p>
&lt;p>(&lt;strong>ì´ˆê¸° ì„œë²„ê°€ êµ¬ë™ë˜ê¸°ê¹Œì§€ ë‹¤ì†Œ ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/strong> ì´ ê²½ìš° ì„œë²„ì˜ ë¡œê·¸ë¥¼ í†µí•´ ì„œë²„ê°€ êµ¬ë™ëëŠ”ì§€ë¥¼ í™•ì¸í•´ë³´ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.)&lt;/p>
&lt;p>&lt;code>eth0&lt;/code>ì˜ IPì— ì„œë²„ë¥¼ ë„ìš´ Podë¥¼ ëª©ì ì§€ë¡œ í•˜ëŠ” Serviceì—ê²Œ ìš”ì²­ì„ ë³´ë‚¼ ê²½ìš° í•´ë‹¹ ëª©ì ì§€ Podê°€ istio 1.9ì— ì˜í•´ sidecar injection ë˜ì—ˆë‹¤ë©´ Pod ë‚´ì˜ ì„œë²„ëŠ” ì˜¬ë°”ë¥´ê²Œ ìš”ì²­ì„ ì „ë‹¬ë°›ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ kubectl &lt;span class="nb">exec&lt;/span> -n default netcat-client -- bash -c &lt;span class="s2">&amp;#34;echo &amp;#39;ping&amp;#39; | nc lo.rev-1-10 8080&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Ncat: Connection reset by peer.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">command&lt;/span> terminated with &lt;span class="nb">exit&lt;/span> code &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ kubectl &lt;span class="nb">exec&lt;/span> -n default netcat-client -- bash -c &lt;span class="s2">&amp;#34;echo &amp;#39;ping&amp;#39; | nc eth0.rev-1-10 8080&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pong
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>istio 1.10ì„ ì´ìš©í•œ ê²½ìš° ê²°ê³¼ëŠ” ì˜ˆìƒëŒ€ë¡œ istio 1.9ì™€ ë°˜ëŒ€ì…ë‹ˆë‹¤.&lt;/p>
&lt;p>&lt;code>lo&lt;/code> ì˜ IPì— ì„œë²„ë¥¼ ë„ìš´ Podë¥¼ ëª©ì ì§€ë¡œ í•˜ëŠ” Serviceì—ê²Œ ìš”ì²­ì„ ë³´ë‚¼ ê²½ìš° í•´ë‹¹ ëª©ì ì§€ Podê°€ istio 1.10ì— ì˜í•´ sidecar injection ë˜ì—ˆë‹¤ë©´ Pod ë‚´ì˜ ì„œë²„ëŠ” ì˜¬ë°”ë¥´ê²Œ ìš”ì²­ì„ ì „ë‹¬ë°›ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.&lt;/p>
&lt;h2 id="ë§ˆì¹˜ë©°">ë§ˆì¹˜ë©°&lt;/h2>
&lt;p>ìš”ì¦˜ ë²„ì „ì´ ì°¸ ì¤‘ìš”í•˜ë‹¤ëŠ” ìƒê°ì´ ë“­ë‹ˆë‹¤. ì‹¤ì œë¡œ &lt;strong>ì´ë ‡ê²Œ ë²„ì „ì— ë”°ë¼ í†µì‹ ì´ ë˜ê³  ì•ˆ ë˜ê³ ê°€ ê²°ì •ë  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ í™•ì¸í•´ë³´ë‹ˆ í•œì¸µ ë” ë²„ì „ì´ ì¤‘ìš”í•˜ê²Œ ëŠê»´ì§‘ë‹ˆë‹¤.&lt;/strong>&lt;/p>
&lt;p>ë”°ë¡œ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ì œì‘í•˜ê³  imagePullSecretì„ ê¸°ì…í•˜ê¸° ê·€ì°®ì•„ì„œ ê¸°ì¡´ì— ì¡´ì¬í•˜ëŠ” Ubuntu ì´ë¯¸ì§€ë¥¼ í™œìš©í•˜ë ¤ë‹¤ ë³´ë‹ˆ ê°„ë‹¨í•˜ê²Œ ë„¤íŠ¸ì›Œí¬ í†µì‹ ì„ í•˜ê¸° ìœ„í•´ netcatì„ ì ê·¹ í™œìš©í•´ë´¤ìŠµë‹ˆë‹¤. ì˜¤íˆë ¤ ë„ˆë¬´ ì½”ë“œê°€ ê¸¸ì–´ì¡Œë‚˜ ì‹¶ê¸°ë„í•˜ë„¤ìš”.&lt;/p>
&lt;p>ì´ ì‘ì—…ì„ í•˜ë©´ì„œ ì™„ì „íˆ ì´í•´í•˜ì§€ ëª»í•œ ë¶€ë¶„ì´ í•œ ê°€ì§€ ì¡´ì¬í•˜ê¸´ í•©ë‹ˆë‹¤. ì‘ì—…í•˜ë©° ê²½í—˜í•œ ë°”ë¡œëŠ” Podì˜ IPë¡œ ìš”ì²­ì„ ë³´ë‚´ëŠ” ê²½ìš°ì—ëŠ” istio ë²„ì „ì— ë¬´ê´€í•˜ê²Œ eth0ì˜ IPë¡œ ì„œë²„ë¥¼ ë„ì›Œì•¼ë§Œ ì™¸ë¶€(ë™ë£Œ Podë“¤)ì—ì„œëŠ” ì ‘ì†ì´ ê°€ëŠ¥í•˜ê³ , loì˜ IPë¡œ ì„œë²„ë¥¼ ë„ìš°ëŠ” ê²½ìš° Podì˜ IPë¡œ ì ‘ì†ì´ ë¶ˆê°€ëŠ¥í–ˆëŠ”ë°ìš”. ì‚¬ì‹¤ ì´ë¡œ ì¸í•´ ë§ì€ ì‚½ì§ˆì„ í–ˆìŠµë‹ˆë‹¤â€¦ ì™œ ì„œë¹„ìŠ¤ë¡œ ì ‘ì†í•  ë•Œì—ëŠ” ì˜ˆìƒëŒ€ë¡œ ë²„ì „ì— ë§ëŠ” ë™ì‘ì„ í•˜ëŠ”ë°, Podì˜ IPë¡œ ì§ì ‘ ì ‘ì†í•  ë•Œì—ëŠ” ë¬´ì¡°ê±´ eth0ì˜ IPë¡œ ì„œë²„ë¥¼ ë„ìš´ ê²½ìš°ì—ë§Œ ì™¸ë¶€ì—ì„œ ì ‘ê·¼ì´ ê°€ëŠ¥í•œì§€ëŠ” ì˜ ëª¨ë¥´ê² ìŠµë‹ˆë‹¤.&lt;/p>
&lt;p>í•˜ì§€ë§Œ ê³¼ê±° ë²„ì „ì˜ istioë¥¼ í†µí•´ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì˜ ë™ì‘ì„ í™•ì¸í•´ë³´ëŠ” ê²ƒì€ ì´ ì •ë„ë¡œ ì¶©ë¶„í•  ê²ƒ ê°™ë‹¤ê³  ìƒê°ì´ ë“¤ì–´ ì´ë²ˆ ê¸€ì€ ì—¬ê¸°ì„œ ë§ˆë¬´ë¦¬ ì§€ìœ¼ë ¤í•©ë‹ˆë‹¤. ğŸ™‚&lt;/p></description></item></channel></rss>