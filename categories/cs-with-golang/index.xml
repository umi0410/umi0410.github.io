<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Golangìœ¼ë¡œ ì ìš©í•´ë³´ëŠ” Computer Science on Jinsu Playground</title><link>https://umi0410.github.io/categories/cs-with-golang/</link><description>Recent content in Golangìœ¼ë¡œ ì ìš©í•´ë³´ëŠ” Computer Science on Jinsu Playground</description><generator>Hugo -- gohugo.io</generator><language>ko-kr</language><lastBuildDate>Sat, 13 Feb 2021 14:10:54 +0900</lastBuildDate><atom:link href="https://umi0410.github.io/categories/cs-with-golang/index.xml" rel="self" type="application/rss+xml"/><item><title>Go ì–¸ì–´ë¡œ ì ìš©í•´ë³´ëŠ” Computer Science - Mutexì™€ Semaphore</title><link>https://umi0410.github.io/blog/golang/go-mutex-semaphore/</link><pubDate>Wed, 20 Jan 2021 15:25:54 +0900</pubDate><guid>https://umi0410.github.io/blog/golang/go-mutex-semaphore/</guid><description>&lt;img src="https://umi0410.github.io/blog/golang/go-mutex-semaphore/mutex-2.png" alt="Featured image of post Go ì–¸ì–´ë¡œ ì ìš©í•´ë³´ëŠ” Computer Science - Mutexì™€ Semaphore" />&lt;p>Go ì–¸ì–´ë¡œ ì ìš©í•´ë³´ëŠ” Computer Scienceì˜ ì²« ë²ˆì§¸ ë‚´ìš©ìœ¼ë¡œ OS ê´€ë ¨ ë‚´ìš© ì¤‘ ì´ë¡ ì ìœ¼ë¡œëŠ” í”í•˜ê²Œ ì ‘í•  ìˆ˜ ìˆì§€ë§Œ ì‹¤ì œ ì ìš©ì— ëŒ€í•œ ë‚´ìš©ì€
ì°¾ì•„ë³´ê¸° í˜ë“¤ì—ˆë˜ &lt;code>Mutex&lt;/code>, &lt;code>Semaphore&lt;/code>ì— ëŒ€í•´ ì•Œì•„ë³´ë ¤í•œë‹¤.&lt;/p>
&lt;p>Mutexì™€ Semaphoreì€ ê°ê°ì˜ ì¶”ìƒì ì¸ ê°œë…ì„ ë°”íƒ•ìœ¼ë¡œ OSë‚˜ Go ë“±ì—ì„œ ì‚¬ìš©ë  ìˆ˜ ìˆê¸°ì— ì„¸ë¶€ì ì¸ ë‚´ìš©ì€ ë¬¸ë§¥ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤ê³  ìƒê°í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ Goì—ì„œì˜ MutexëŠ” ì£¼ë¡œ &lt;code>sync.Mutex&lt;/code>ë¥¼ ì´ìš©í•œ ì„œë¡œ ë‹¤ë¥¸ Goroutineì˜ ë™ì‹œ ì ‘ê·¼ì— ëŒ€í•œ ì œì–´ë¥¼ ì˜ë¯¸í•˜ëŠ” ë°˜ë©´, ë‹¤ë¥¸ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë‚˜ OSì—ì„œëŠ” ì£¼ë¡œ ì„œë¡œ ë‹¤ë¥¸ Kernel threadë‚˜ Processì— ëŒ€í•œ ë™ì‹œ ì ‘ê·¼ ì œì–´ë¥¼ ì˜ë¯¸í•  ìˆ˜ ìˆë‹¤.&lt;/p>
&lt;h2 id="mutex">Mutex&lt;/h2>
&lt;p>&lt;code>Mutex&lt;/code>ëŠ” &lt;strong>Mutual Exclusion&lt;/strong>ì˜ ì¤„ì„ë§ë¡œ &lt;strong>ìƒí˜¸ ë°°ì œ&lt;/strong>ë¥¼ ì˜ë¯¸í•œë‹¤. ì¦‰ &lt;strong>ì„œë¡œ ë‹¤ë¥¸ ì›Œì»¤ê°€ ê³µìœ  ìì›ì— ì ‘ê·¼í•˜ëŠ” ê²ƒì„ ì œí•œ&lt;/strong>í•œë‹¤ëŠ” ë§ì´ë‹¤. &lt;code>Go&lt;/code>ì—ì„œëŠ” ì´ &amp;ldquo;&lt;strong>ì›Œì»¤&lt;/strong>&amp;ldquo;ê°€ &lt;code>Goroutine&lt;/code>ì´ ë˜ê³ , ì»¨í…ìŠ¤íŠ¸ì— ë”°ë¼ í”„ë¡œì„¸ìŠ¤ê°€ ë  ìˆ˜ë„, ìŠ¤ë ˆë“œê°€ ë  ìˆ˜ë„ ê·¸ ì™¸ì˜ ë‹¤ë¥¸ ì¡´ì¬ê°€ ë  ìˆ˜ë„ ìˆë‹¤. &lt;code>ê³µìœ  ìì›&lt;/code>ì´ë€ ì—¬ëŸ¬ ì›Œì»¤ê°€ ë™ì‹œì— ì ‘ê·¼í•˜ëŠ” ìì›ì„ ë§í•˜ê³  ì´ &lt;strong>ê³µìœ  ìì›ì— ëŒ€í•œ ë™ì‹œ ì ‘ê·¼ì„ ì œí•œí•´ thread-safeí•˜ê²Œ ì‘ì—…í•˜ê³ ì í•˜ëŠ” ì˜ì—­&lt;/strong>ì„ &lt;code>Critical section&lt;/code>ì´ë¼ê³  í•œë‹¤. Cricical sectionì€ Mutexê°€ Lockì„ ìˆ˜í–‰í•œ ë’¤ Unlockë˜ê¸° ì „ê¹Œì§€ì˜ ì˜ì—­ì´ë©°, Lockê³¼ Unlockì€ Atomicí•œ ì‘ì—…ì´ê¸°ë•Œë¬¸ì— ì–´ë– í•œ ê²½ìš°ì—ë„ ë™ì‹œì ìœ¼ë¡œ ìˆ˜í–‰ë  ìˆ˜ ì—†ë‹¤.&lt;/p>
&lt;p>&lt;img src="https://umi0410.github.io/blog/golang/go-mutex-semaphore/mutex-1.png"
width="817"
height="547"
srcset="https://umi0410.github.io/blog/golang/go-mutex-semaphore/mutex-1_hu76213fc7fff91be05fb9c7f7e7037656_79471_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/golang/go-mutex-semaphore/mutex-1_hu76213fc7fff91be05fb9c7f7e7037656_79471_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="mutex-1.png"
class="gallery-image"
data-flex-grow="149"
data-flex-basis="358px"
>&lt;/p>
&lt;p>ì´í•´í•˜ê¸° ì‰½ê²Œ ì˜ˆì‹œë¥¼ í†µí•´ ì ‘ê·¼í•´ë³´ê² ë‹¤. ì›ë˜ í™”ì¥ì‹¤ ì˜ˆì œë¥¼ ë³´ê³  êµ‰ì¥íˆ ì™€ë‹¿ì•˜ëŠ”ë°, í™”ì¥ì‹¤ë³´ë‹¤ëŠ” í”¼íŒ…ë£¸ì´ ì¢€ ë” ì²­ê²°í•œ ê²ƒ ê°™ì•„ì„œ í”¼íŒ…ë£¸ìœ¼ë¡œ ì˜ˆë¥¼ ë“¤ì–´ë³´ê² ë‹¤. ìš°ë¦¬ ê·€ì—¬ìš´ ê³ í¼ê°€ &lt;strong>í”¼íŒ…ë£¸ì„ í•œ ê°œë§Œ ìš´ì˜í•˜ëŠ” ì˜·ê°€ê²Œì— ë°©ë¬¸&lt;/strong>í–ˆë‹¤ê³  ê°€ì •í•´ë³´ì.&lt;/p>
&lt;p>&lt;img src="https://umi0410.github.io/blog/golang/go-mutex-semaphore/mutex-2.png"
width="831"
height="331"
srcset="https://umi0410.github.io/blog/golang/go-mutex-semaphore/mutex-2_hu253887d6f424b5a6c4c14b3309becda5_68035_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/golang/go-mutex-semaphore/mutex-2_hu253887d6f424b5a6c4c14b3309becda5_68035_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="mutex-2.png"
class="gallery-image"
data-flex-grow="251"
data-flex-basis="602px"
>&lt;/p>
&lt;ul>
&lt;li>í”¼íŒ…ë£¸ - Critical section&lt;/li>
&lt;li>ê³ í¼ê°€ í”¼íŒ…ë£¸ì— ë“¤ì–´ê°€ì„œ ì˜·ì„ ì…ëŠ” ì‘ì—…ì€ í•˜ë‚˜ì˜ Goroutine&lt;/li>
&lt;/ul>
&lt;p>ë™ì‹œì— ì—¬ëŸ¬ ê³ í¼ê°€ í•˜ë‚˜ì˜ í”¼íŒ…ë£¸ì—ì„œ ì˜·ì„ ê°ˆì•„ì…ìœ¼ë ¤í•œë‹¤ë©´ ğŸ˜Ÿ ë‚œì²˜í•œ ìƒí™©ì´ ë°œìƒí•  ê²ƒì´ë‹¤. ê·¸ë ‡ê¸°ë•Œë¬¸ì— í”¼íŒ…ë£¸ì—ëŠ” Lock, Unlock ê¸°ëŠ¥ì´ ì¡´ì¬í•´ì•¼í•˜ëŠ”ë°, ì´ ê¸°ëŠ¥ì„ êµ¬í˜„í•œë‹¤í•´ë„ &lt;strong>Atomic&lt;/strong>í•˜ê²Œ ë™ì‘í•  ìˆ˜ ìˆë„ë¡ ì œëŒ€ë¡œ êµ¬í˜„í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ &lt;strong>í•œ ì›Œì»¤ê°€ Lockì„ í•˜ëŠ” ì‚¬ì´ì— ë‹¤ë¥¸ ì›Œì»¤ê°€ ë™ì‹œì— Lock&lt;/strong>ì„ ê±¸ë ¤í•  ìˆ˜ ìˆê³ , ê·¸ ê²½ìš° ë‘ ì›Œì»¤ê°€ ë™ì‹œì— í•œ í”¼íŒ…ë£¸(Critical Section)ì—ì„œ ì‘ì—…ì„ í•˜ë ¤í•  ê²ƒì´ë‹¤. ê·¸ë ‡ê¸°ë•Œë¬¸ì— &lt;strong>Lock, Unlockì€ Atomicí•´ì•¼í•˜ë©° ì´ë ‡ê²Œ ê° ì›Œì»¤ë¥¼ ìƒí˜¸ ë°°ì œì‹œì¼œ ë™ì‹œì— ì‘ì—…í•  ìˆ˜ ì—†ë„ë¡ í•˜ëŠ” ê²ƒ&lt;/strong>ì´ ë°”ë¡œ &lt;code>Mutex&lt;/code>ì´ë‹¤.&lt;/p>
&lt;h3 id="mutexë¥¼-ì´ìš©í•œ-go-program---counter">Mutexë¥¼ ì´ìš©í•œ Go program - Counter&lt;/h3>
&lt;p>&lt;strong>Count = 0ì—ì„œ ì‹œì‘í•´ ë™ì‹œì ìœ¼ë¡œ +1ì„ 10ë§Œ ë²ˆ, -1ì„ 10ë§Œ ë²ˆ ìˆ˜í–‰í•˜ëŠ” ì¹´ìš´í„° í”„ë¡œê·¸ë¨&lt;/strong>&lt;/p>
&lt;p>ê·¸ëŸ¼ ì‹¤ìƒí™œì— ë¹„ìœ í•œ MutexëŠ” ì´ ì •ë„ë¡œ ë§ˆì¹˜ê³ , Mutexê°€ ì–´ë–»ê²Œ ì‚¬ìš©ë˜ëŠ”ì§€ Goë¡œ ì§  ê°„ë‹¨í•œ Counter í”„ë¡œê·¸ë¨ì„ í†µí•´ ì•Œì•„ë³´ì.&lt;/p>
&lt;ul>
&lt;li>Mutexë¥¼ ì˜ ì ìš©í•œ ê²½ìš° - ëª‡ ë²ˆì„ ìˆ˜í–‰í•˜ë“  ê²°ê³¼ëŠ” 0.&lt;/li>
&lt;li>Mutexê°€ ì ìš©ë˜ì§€ ì•Šì€ safeí•˜ì§€ ì•Šì€ ê²½ìš° - ê²°ê³¼ê°€ 0ì´ ë‚˜ì˜¤ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤.&lt;/li>
&lt;/ul>
&lt;p>íŠ¹íˆ &lt;code>Go&lt;/code>ì—ì„œëŠ” &lt;code>sync&lt;/code> íŒ¨í‚¤ì§€ì˜ &lt;code>Mutex&lt;/code>ë¼ëŠ” typeì„ í†µí•´ ê°„ë‹¨í•˜ê²Œ Mutex ê¸°ëŠ¥ì„ ì´ìš©í•  ìˆ˜ ìˆë‹¤. &lt;strong>ë™ì¼í•œ Mutex structë¥¼ ì°¸ì¡°í•œë‹¤ë©´ ê°™ì€ Keyë¥¼ ì´ìš©í•œë‹¤ëŠ” ê°œë…&lt;/strong>ì´ê³ , &lt;code>mutex.Lock()&lt;/code>ì„ í˜¸ì¶œí•œ ë’¤ &lt;code>mutex.Unlock()&lt;/code>ì´ í˜¸ì¶œë˜ê¸° ì´ì „ê¹Œì§€ê°€ Critical sectionì´ ë˜ë©° ë‹¤ë¥¸ goroutineë“¤ì€ ê°™ì€ Mutex(ì¦‰ í‚¤)ì— ì˜í•œ Critical sectionì— ì§„ì…í•  ìˆ˜ ì—†ë‹¤.&lt;/p>
&lt;p>&lt;em>ë‚´ê°€ ì²˜ìŒ Mutexë¥¼ ì²˜ìŒ ì ‘í–ˆì„ ë•Œ í•œ ê°€ì§€ í—·ê°ˆë ¸ë˜ ê²ƒ&lt;/em>ì€ ë‹¹ì‹œ Critical sectionì´ë¼ëŠ” ê°œë…ì´ ì—†ì—ˆê¸° ë•Œë¬¸ì— Lockì„ í˜¸ì¶œí•˜ê¸°ë§Œ í•˜ë©´ ëŸ°íƒ€ì„ì— &lt;del>ì•Œì•„ì„œ ìŠ¤ë§ˆíŠ¸í•˜ê²Œ Lockê³¼ Unlockì‚¬ì´ì˜ ë³€ìˆ˜ë“¤ì— ëŒ€í•œ ì ‘ê·¼ ì¤‘ ë™ì‹œì ì¸ ì ‘ê·¼ë§Œì„ ì ì‹œ ë¸”ë½í•´ì£¼ëŠ” ì¤„&lt;/del> ì•Œì•˜ëŠ”ë°, ì‚¬ì‹¤ ê·¸ ì‚¬ì´ ë³€ìˆ˜ë“¤ì¤‘ ë™ì‹œì ìœ¼ë¡œ ì ‘ê·¼í•˜ë ¤ëŠ” ë³€ìˆ˜ì— ëŒ€í•´ì„œë§Œ ì ì‹œ ë¸”ë½í•´ì£¼ëŠ” ê²Œ ì•„ë‹ˆë¼ &lt;strong>Lockê³¼ Unlock ì‚¬ì´ë¥¼ Critical sectionìœ¼ë¡œ ë§Œë“œëŠ” ê²ƒ&lt;/strong>ì´ì—ˆë‹¤.&lt;/p>
&lt;p>ì ê·¸ëŸ¼ Countë¼ëŠ” í•˜ë‚˜ì˜ intí˜• ë³€ìˆ˜ì— ë™ì‹œì ìœ¼ë¡œ ì ‘ê·¼ì„ í•˜ëŠ” ìƒí™©ì„ ê·¹ëŒ€í™”í•˜ê¸° ìœ„í•´ ì—¬ëŸ¬ ê³ ë£¨í‹´ìœ¼ë¡œ ì‘ì—…í•´ë³´ê² ë‹¤. +1ì„ 1ë§Œ ë²ˆí•˜ëŠ” ê³ ë£¨í‹´ì„ 10ê°œ, -1ì„ 1ë§Œ ë²ˆí•˜ëŠ” ê³ ë£¨í‹´ì„ ë§ˆì°¬ê°€ì§€ë¡œ 10ê°œ ì´ìš©í•˜ê² ë‹¤.&lt;/p>
&lt;p>ì „ì²´ ì½”ë“œ ì°¸ê³ : &lt;a class="link" href="https://play.golang.org/p/xaLE1YkAdvd" target="_blank" rel="noopener"
>https://play.golang.org/p/xaLE1YkAdvd&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://umi0410.github.io/blog/golang/go-mutex-semaphore/output-1.png"
width="516"
height="443"
srcset="https://umi0410.github.io/blog/golang/go-mutex-semaphore/output-1_hu6e22a3f3f203a0242d8843396eefee7b_63957_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/golang/go-mutex-semaphore/output-1_hu6e22a3f3f203a0242d8843396eefee7b_63957_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="output-1.png"
class="gallery-image"
data-flex-grow="116"
data-flex-basis="279px"
>&lt;/p>
&lt;ul>
&lt;li>ìš°ë¦¬ê°€ ì¼ë°˜ì ìœ¼ë¡œ ìµìˆ™í•œ Sync ì¦‰ ë™ê¸°ì ì¸ ìˆœì°¨ì  ì§„í–‰ ì‹œì—ëŠ” ë‹¹ì—°íˆ 10ë§Œë²ˆ +1, 10ë§Œë²ˆ -1 í›„ì— ê²°ê³¼ê°€ 0ì´ì—ˆë‹¤.&lt;/li>
&lt;li>ë™ì‹œì  ì ‘ê·¼ì„ ìˆ˜í–‰í•˜ì 10ë§Œë²ˆ +1, 10ë§Œë²ˆ -1ì„ í–ˆì§€ë§Œ &lt;code>Count += 1&lt;/code> ì„ ìˆ˜í–‰í•˜ë˜ ì¤‘ ë˜ ë‹¤ë¥¸ &lt;code>Count += 1&lt;/code>ì´ ìˆ˜í–‰ë˜ëŠ” ë“±ì˜ ì›ì¹˜ì•Šë˜ ìƒí™©ì´ ì•¼ê¸°ë  ìˆ˜ ìˆê¸°ì— ê²°ê³¼ê°’ì´ 0ì¸ ê²½ìš°ë¥¼ ì°¾ê¸° í˜ë“¤ë‹¤.&lt;/li>
&lt;li>ì—¬ëŸ¬ Goroutineì´ concurrentí•˜ê²Œ ì§„í–‰í•˜ë˜ &lt;code>Count += 1&lt;/code>, &lt;code>Count -= 1&lt;/code> ê³¼ ê°™ì€ &lt;strong>ë™ì‹œì  ì ‘ê·¼ì´ ìˆ˜í–‰ë˜ì–´ì„œëŠ” ì•ˆë˜ëŠ” ì˜ì—­ì€ Critical Area&lt;/strong>ë¡œ ì„¤ì •í•´ ìƒí˜¸ ë°°ì œì ìœ¼ë¡œ ì‘ì—…ë˜ê²Œ í•˜ê¸° ìœ„í•´ Critical sectionì˜ ì „/í›„ì— &lt;code>sync.Mutex&lt;/code>ë¥¼ ì´ìš©í•´ Lock, Unlock ê¸°ëŠ¥ì„ ë„£ì–´ì£¼ì &lt;strong>ê¸°ëŒ€í–ˆë˜ ëŒ€ë¡œ 0ì˜ ê²°ê³¼&lt;/strong>ë¥¼ ì–»ì„ ìˆ˜ ìˆì—ˆë‹¤.&lt;/li>
&lt;/ul>
&lt;h3 id="-mutex-ê·¸ë˜ì„œ-ì–¸ì œ-ì¨ìš”">ğŸ’¡ Mutex.. ê·¸ë˜ì„œ ì–¸ì œ ì¨ìš”?&lt;/h3>
&lt;p>ì‚¬ì‹¤ Mutexë¼ëŠ” ê°œë…ì´ ê·¸ë ‡ê²Œ ì–´ë ¤ìš´ ê²ƒë„ ì•„ë‹ˆê³ , ì‚¬ìš©ë²• ìì²´ê°€ ì–´ë ¤ìš´ ê²ƒë„ ì•„ë‹ˆë‹¤. ë‚˜ëŠ” í•˜ì§€ë§Œ í•­ìƒ &lt;strong>&amp;ldquo;ì–¸ì œ&amp;rdquo;&lt;/strong>, &lt;strong>&amp;ldquo;ì™œ&amp;rdquo;&lt;/strong> ì¨ì•¼í•˜ëŠ”ì§€ë¥¼ ê¶ê¸ˆí•´í•˜ëŠ” í¸ì´ë‹¤.&lt;/p>
&lt;ol>
&lt;li>Critical sectionì—ì„œ ë§ì€ ì‹œê°„ì´ ì†Œìš”ë˜ëŠ” ê²½ìš°? â‡’ âŒ
ìœ„ì˜ counterì™€ ê°™ì€ ì‘ì—…ì€ ëŒ€ë¶€ë¶„ì˜ ì‘ì—…ì´ critical section ì†ì— ìˆë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤. ì´ ê²½ìš° ë™ì‹œì ì¸ ì‘ì—…ê³¼ í•¨ê»˜ Lock, Unlockì„ í•˜ë©° critical sectionì„ ê´€ë¦¬í•˜ëŠ” ê²ƒë³´ë‹¤ ì• ì´ˆì— ì‘ì—… ìì²´ë¥¼ ë™ê¸°ì ìœ¼ë¡œ ìˆ˜í–‰í•˜ëŠ” ê²Œ ë‚˜ì„ ìˆ˜ ìˆë‹¤. ì™œëƒí•˜ë©´ ë™ì‹œì  ì‘ì—… ì†ì—ì„œ Mutexë¥¼ í†µí•´ ë™ê¸°ì ìœ¼ë¡œ ì‘ì—…í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê²ƒì—ì„œ ì˜¤ëŠ” ì˜¤ë²„í—¤ë“œëŠ” ë¶„ëª…íˆ ì¡´ì¬í•˜ê³ , Critical section ë°–ì—ì„œ íš¨ìœ¨ì ìœ¼ë¡œ ë™ì‹œì ìœ¼ë¡œ ì‘ì—…ì„ ì§„í–‰í–ˆë‹¤í•˜ë”ë¼ë„ critical sectionì—ì„œ ë³‘ëª©ì´ ë°œìƒí•´ë²„ë ¤ ì „ì²´ì ì¸ Throughputì´ ì•ˆ ì¢‹ì•„ì§ˆ ê²ƒì´ë‹¤.&lt;/li>
&lt;li>&lt;strong>Critical sectionì—ì„œëŠ” ì ì€ ì‹œê°„ì´ ì†Œìš”ë˜ê³ , ëŒ€ë¶€ë¶„ì€ ë™ì‹œì ìœ¼ë¡œ ì‘ì—…ì´ ê°€ëŠ¥í•œ ê²½ìš°&lt;/strong>? â‡’ â­•
ì˜ˆë¥¼ ë“¤ì–´ ì–´ë–¤ APIë¥¼ ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œí•œ ë’¤ ê·¸ ì‘ë‹µ ì¤‘ ì¼ë¶€ë¥¼ ê³„ì†í•´ì„œ ë”í•´ ê²°ê³¼ë¥¼ ë‚´ëŠ” Reduce ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤ê³  ì¹˜ì. ìˆœì°¨ì ìœ¼ë¡œ ìˆ˜í–‰í•  ì‹œ ì˜¤ëœ ì‹œê°„ì´ ì†Œìš”ë  API í˜¸ì¶œì€ ë™ì‹œì ìœ¼ë¡œ ì§„í–‰í•˜ê³ , ê²°ê³¼ì— ëŒ€í•œ Reduce ì‘ì—…ë§Œ ì ì‹œ Critical sectionë‚´ì—ì„œ ì‘ì—…í•œë‹¤ë©´ ì•„ì£¼ ì¢‹ì€ ì„±ëŠ¥ê³¼ í•¨ê»˜ ì•ˆì „í•˜ê²Œ ì‘ì—…í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤!&lt;/li>
&lt;/ol>
&lt;h2 id="semaphore">Semaphore&lt;/h2>
&lt;p>&lt;img src="https://umi0410.github.io/blog/golang/go-mutex-semaphore/semaphore.png"
width="884"
height="619"
srcset="https://umi0410.github.io/blog/golang/go-mutex-semaphore/semaphore_hu1456e527b7729559b12f99ce1b9bda34_227201_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/golang/go-mutex-semaphore/semaphore_hu1456e527b7729559b12f99ce1b9bda34_227201_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="semaphore.png"
class="gallery-image"
data-flex-grow="142"
data-flex-basis="342px"
>&lt;/p>
&lt;p>Mutexì—ì„œ ëŒ€ë¶€ë¶„ì˜ Lockì´ë‚˜ Critical sectionì— ëŒ€í•œ ë‚´ìš©ì„ ì„¤ëª…í–ˆê¸° ë•Œë¬¸ì— Semaphoreì—ì„œ ë” ì„¤ëª…í•  ë‚´ìš©ì´ ë§ì§€ëŠ” ì•Šë‹¤. Semaphoreì˜ ë™ì‘ì— ëŒ€í•œ ê°„ë‹¨í•œ ì˜ˆì‹œëŠ” ìœ„ì˜ ê·¸ë¦¼ê³¼ ê°™ì€ë°, 5ë§ˆë¦¬ì˜ ê³ í¼ê°€ ì¡´ì¬í•œë‹¤í•´ë„ ë™ì‹œì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œí•˜ëŠ” ê³ í¼ë¥¼ 3ê°œë¡œ ì œí•œí•œë‹¤ë©´ 2ë§ˆë¦¬ì˜ ê³ í¼ëŠ” í”¼íŒ…ë£¸ì— ë“¤ì–´ê°€ì§€ ëª»í•˜ê³  ë¸”ë½ëœë‹¤. Lockedì™€ Unlocked ìƒíƒœ ë¿ì¸ &lt;code>Mutex&lt;/code>ì™€ ë‹¬ë¦¬ &lt;code>Semaphore&lt;/code>ëŠ” &lt;strong>ì„ì˜ì˜ ê°œìˆ˜ë¥¼ ì„¸ëŠ” Counterì²˜ëŸ¼ ë™ì‘í•´ ì„ì˜ì˜ ê°œìˆ˜ì˜ ì›Œì»¤ë§Œì´ Critical sectionì— ë™ì‹œì ìœ¼ë¡œ ì ‘ê·¼&lt;/strong>í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.&lt;/p>
&lt;p>Counterë¥¼ ì˜ˆë¡œ ë“¤ìë©´ 10ê°œì˜ ì›Œì»¤ê°€ ì¡´ì¬í•œë‹¤í•´ë„ &amp;ldquo;5&amp;quot;ë¥¼ ì„¸ëŠ” SemaphoreëŠ” í•œ ì›Œì»¤ê°€ Critical sectionì— ì§„ì…í•  ë•Œë§ˆë‹¤ Counter ê°’ì„ 1ì”© ë‚®ì¶”ê³ , Critical sectionì„ íƒˆì¶œí•  ë•Œë§ˆë‹¤ Counter ê°’ì„ ë‹¤ì‹œ 1ì”© ë†’ì¸ë‹¤. ë§Œì•½ ì–´ë–¤ ì›Œì»¤ê°€ Critical sectionì— ì§„ì…í•˜ë ¤ëŠ”ë° Count ê°’ì´ 0ì´ë¼ë©´ ì´ˆê¸°ì— ê³„íší–ˆë˜ ëŒ€ë¡œ 5ê°œì˜ ì›Œì»¤ê°€ ì´ë¯¸ ë™ì‹œì ìœ¼ë¡œ ì‘ì—…ì¤‘ì´ë¼ëŠ” ì˜ë¯¸ì´ë¯€ë¡œ ì´ ì›Œì»¤ëŠ” í•œ ì›Œì»¤ê°€ Critical sectionì„ ë‚˜ì˜¤ë©´ì„œ Counter ê°’ì„ ë‹¤ì‹œ 1 ì¦ê°€ì‹œí‚¬ ë•Œê¹Œì§€ Blockëœë‹¤.&lt;/p>
&lt;p>Mutexì˜ Lockê³¼ Unlockì´ Atomicí•˜ê¸°ì— ì–´ë– í•œ ê²½ìš°ì—ë„ ë™ì‹œì ìœ¼ë¡œ ìˆ˜í–‰ë  ìˆ˜ ì—†ì—ˆë“¯ì´ Semaphoreì˜ Counting ì‘ì—… ë˜í•œ Atomicí•´ì•¼í•˜ê³  ê·¸ë˜ì•¼ë§Œ Thread-safeí•œ counterë¡œ ë™ì‘í•  ìˆ˜ ìˆë‹¤. Semaphoreê°€ ìˆ˜í–‰í•˜ëŠ” Counting ì‘ì—…ì€ ì£¼ë¡œ tryë¥¼ ëœ»í•˜ëŠ” ë„¤ëœë€ë“œì–´ Proberenì˜ ì• ê¸€ìë¥¼ ë”´ &lt;code>P&lt;/code>ì™€ incrementë¥¼ ëœ»í•˜ëŠ” Verhogenì˜ ì• ê¸€ìë¥¼ ë”´ &lt;code>V&lt;/code>ë¡œ ë‘ ê°€ì§€ê°€ í‘œí˜„í•˜ëŠ” ë“¯í•˜ë‹¤. &lt;code>P&lt;/code>ëŠ” Count ê°’ì´ 0ì´ ì•„ë‹ˆë©´ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê² ë‹¤ëŠ” ì˜ë¯¸í•˜ë©° ë§Œì•½ Count ê°’ì´ 0ì´ë¼ë©´ 0ì´ ì•„ë‹Œ ê°’ì´ ë  ë•Œê¹Œì§€ waití–ˆë‹¤ê°€ 0 ì•„ë‹Œ ê°’ì´ ë˜ë©´ count ê°’ì„ 1 ê°ì†Œì‹œí‚¤ë©° ì‘ì—…ì„ ì‹œì‘í•œë‹¤. &lt;code>V&lt;/code>ëŠ” ì‘ì—…ì„ ë§ˆì¹˜ë©° count ê°’ì„ ë‹¤ì‹œ 1 ì¦ê°€ì‹œí‚¤ê² ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.&lt;/p>
&lt;h3 id="mutexì™€-binary-semaphoreì˜-ìœ ì‚¬í•œ-ì ">Mutexì™€ Binary semaphoreì˜ ìœ ì‚¬í•œ ì &lt;/h3>
&lt;p>ë™ì‹œ ì ‘ê·¼ ì›Œì»¤ë¥¼ 1ê°œë¡œ ì œí•œí•˜ëŠ” Semaphoreì˜ ê²½ìš° Count ê°’ì´ 0ê³¼ 1 ë‘ ê°œë¡œë§Œ ì¡´ì¬í•  ìˆ˜ ìˆëŠ”ë° ì´ë¥¼ Binary semaphoreë¼ê³ í•œë‹¤. íŠ¹íˆ ì´ëŠ” Lockedì™€ Unlockedë¼ëŠ” ë‘ ê°€ì§€ì˜ ìƒíƒœë§Œì„ ê°–ëŠ” Mutexì™€ ìœ ì‚¬í•˜ë‹¤. í•˜ì§€ë§Œ Binary semaphoreëŠ” mutexê°€ ìœ ì‚¬í•œ ê¸°ëŠ¥ì„ í•  ë¿ ë™ì¼í•˜ì§€ëŠ” ì•Šë‹¤ëŠ” ì˜ê²¬ì´ ë§ë‹¤. ê·¸ ì´ìœ ëŠ” &lt;strong>MutexëŠ” Lock ë°©ì‹ì„ ì´ìš©í•˜ê³  SemaphoreëŠ” Signal(ì‹ í˜¸) ë°©ì‹ì„ ì´ìš©&lt;/strong>í•˜ê¸° ë•Œë¬¸ì´ë‹¤. Lock ë°©ì‹ì˜ ê²½ìš° Lockì„ ìˆ˜í–‰í•œ ì›Œì»¤ë§Œì´ Unlockì„ í•  ìˆ˜ ìˆëŠ” ë°˜ë©´ Signal ë°©ì‹ì€ try(ì‘ì—… ì‹œë„)ë¥¼ ìˆ˜í–‰í•œ ì›Œì»¤ê°€ ì•„ë‹ˆë”ë¼ë„ increment(ì‘ì—… ì™„ë£Œ) ì‹ í˜¸ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆê¸°ì— ì„œë¡œ ëª…ë°±íˆ ë™ì‘ ë°©ì‹ì´ ë‹¤ë¥´ë‹¤ëŠ” ê²ƒì´ë‹¤. (í•˜ì§€ë§Œ ì´ ë¶€ë¶„ì— ëŒ€í•´ì„œëŠ” ì§ì ‘ ì‹¤ìŠµí•´ë³´ì§€ëŠ” ëª»í–ˆë‹¤.)&lt;/p>
&lt;p>*Semaphoreë¥¼ ì´í•´í•˜ëŠ” ë°ì— ìˆì–´ ë‚´ê°€ ì°©ê°í•´ì„œ í—¤ë§¸ë˜ ë¶€ë¶„ì€ ë°”ë¡œ &lt;del>Semaphoreì˜ ìš”ì ì´ thread-safeí•œ countë¼ê³  ì°©ê°&lt;/del>*í–ˆë˜ ê²ƒì´ë‹¤. í•˜ì§€ë§Œ semaphoreì˜ ìš”ì ì€ ì—¬ëŸ¬ ì›Œì»¤ì— ëŒ€í•´ì„œ thread safeí•œ count ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì„ì˜ì˜ ìˆ«ìë§Œí¼ì˜ ë™ì‹œì  ì ‘ê·¼ì„ í—ˆìš©í•˜ê³ , ê·¸ ì´ìƒì€ Block ìƒíƒœë¡œ ëŒ€ê¸°ì‹œí‚¨ë‹¤ëŠ” ê²ƒì´ë‹¤.&lt;/p>
&lt;h3 id="semaphoreë¥¼-ì´ìš©í•œ-go-program-1---counter">Semaphoreë¥¼ ì´ìš©í•œ Go Program 1 - Counter&lt;/h3>
&lt;p>goì—ì„œ Semaphoreë¥¼ ì´ìš©í•˜ëŠ” ë°©ë²•ì€ í¬ê²Œ 2ê°€ì§€ê°€ ìˆëŠ” ê²ƒ ê°™ë‹¤. ì•„ë˜ ë‘ ê°€ì§€ ë°©ë²• ì¤‘ ì¢€ ë” GoìŠ¤ëŸ¬ìš´ &lt;code>channel&lt;/code>ì„ ì´ìš©í•´ë³´ê² ë‹¤.&lt;/p>
&lt;ol>
&lt;li>Go íŠ¹ìœ ì˜ ìë£Œí˜•ì¸ &lt;code>channel&lt;/code>ì„ ì´ìš©í•˜ê¸° - channelì€ ì—¬ëŸ¬ goroutineì˜ concurrentí•œ ì‘ì—…ê°„ ë°ì´í„° ì „ì†¡ì€ ë¬¼ë¡ ì´ê³  ë™ì‹œì ì¸ ì‘ì—… ì¤‘ ë°ì´í„°ë¥¼ í¸ë¦¬í•˜ê²Œ ë™ê¸°í™”í•´ì£¼ëŠ” ë…€ì„ì´ë‹¤. ë”°ë¼ì„œ ë™ê¸°ì ì¸ countì™€ ìœ ì‚¬í•œ ê¸°ëŠ¥ì„ ë‚´ì¬í•˜ê³ ìˆë‹¤.&lt;/li>
&lt;li>&lt;a class="link" href="http://golang.org/x/sync/semaphore" target="_blank" rel="noopener"
>golang.org/x/sync/semaphore&lt;/a>ì˜ Weightedë¥¼ ì´ìš©í•˜ê¸° - Semaphoreì˜ Pë¥¼ Acquire, Vë¥¼ Releaseë¡œ êµ¬í˜„í•´ ì´ìš©í•  ìˆ˜ ìˆê²Œ í–ˆë‹¤.&lt;/li>
&lt;/ol>
&lt;p>ì „ì²´ ì½”ë“œëŠ” Mutexì™€ ë™ì¼í•˜ë©° ë§ˆì°¬ê°€ì§€ë¡œ ë‹¤ìŒ ë§í¬ë¡œ ì°¸ê³ í•´ë³¼ ìˆ˜ ìˆë‹¤: &lt;a class="link" href="https://play.golang.org/p/xaLE1YkAdvd" target="_blank" rel="noopener"
>https://play.golang.org/p/xaLE1YkAdvd&lt;/a>&lt;/p>
&lt;h3 id="buffered-channelì„-ì´ìš©í•œ-semaphore-in-go">Buffered channelì„ ì´ìš©í•œ Semaphore in Go&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">DoSemaphore&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">maxConcurrent&lt;/span> &lt;span class="kt">int64&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Count&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">wg&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">sync&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">WaitGroup&lt;/span>&lt;span class="p">{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">sem&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kd">struct&lt;/span>&lt;span class="p">{},&lt;/span> &lt;span class="nx">maxConcurrent&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">wg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="nf">Add1Sem&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">wg&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">sem&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="nf">Sub1Sem&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">wg&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">sem&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">wg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Wait&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Concurrent goroutines + Semaphore&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">maxConcurrent&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Result(Desired 0):&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Count&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;=====================================&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">Sub1Sem&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">wg&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">sync&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">WaitGroup&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">sem&lt;/span> &lt;span class="kd">chan&lt;/span> &lt;span class="kd">struct&lt;/span>&lt;span class="p">{}){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">defer&lt;/span> &lt;span class="nx">wg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Done&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="mi">10000&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">sem&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="kd">struct&lt;/span>&lt;span class="p">{}{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Count&lt;/span> &lt;span class="o">-=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">sem&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>channelì„ ì´ìš©í•œ Semaphore ì½”ë“œë¥¼ ì„¤ëª…í•˜ê¸° ìœ„í•´ ì „ì²´ ì½”ë“œ ì¤‘ ì¼ë¶€ë¥¼ ê°€ì ¸ì™€ë³´ì•˜ë‹¤. Semaphoreë¥¼ ì´ìš©í•˜ê¸° ìœ„í•´ &lt;code>Unbuffered channel&lt;/code>ì´ ì•„ë‹Œ &lt;code>Buffered channel&lt;/code>ì„ ì´ìš©í•˜ëŠ” ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ì€ Unbuffered channelì˜ ë™ì‘ ë°©ì‹ì´ Semaphoreì˜ ë™ì‘ ë°©ì‹ê³¼ ë™ì¼í•˜ê¸° ë•Œë¬¸ì´ë‹¤.&lt;/p>
&lt;ul>
&lt;li>Bufferì˜ í¬ê¸°ë§Œí¼ì€ ë™ì‹œì ìœ¼ë¡œ channelì— ê°’ì„ ë„£ìœ¼ë ¤ëŠ” ì‹œë„ê°€ í—ˆìš©ë¨.&lt;/li>
&lt;li>buffered channelì´ ê½‰ ì°¬ ê²½ìš° ì±„ë„ì—ì„œ ê°’ì„ êº¼ë‚´ì§€ ì•ŠëŠ” ì´ìƒì€ ì¶”ê°€ì ìœ¼ë¡œ Channelì— ê°’ì„ ë„£ìœ¼ë ¤ì‹œë„í•˜ëŠ” goroutineì€ Blockë¨.&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://umi0410.github.io/blog/golang/go-mutex-semaphore/output-2.png"
width="534"
height="313"
srcset="https://umi0410.github.io/blog/golang/go-mutex-semaphore/output-2_hu5c9eb1f96e3e02a52a6b354b1459125f_26935_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/golang/go-mutex-semaphore/output-2_hu5c9eb1f96e3e02a52a6b354b1459125f_26935_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="output-2.png"
class="gallery-image"
data-flex-grow="170"
data-flex-basis="409px"
>&lt;/p>
&lt;p>(ì•ì„œ ì½”ë“œë¥¼ ë§í¬í•œ go playgroundì—ì„œ ì½”ë“œë¥¼ ë°”ë¡œ ì‹¤í–‰í•´ë³¼ ìˆ˜ ìˆë‹¤.)&lt;/p>
&lt;p>ë™ì‹œ ì ‘ê·¼ ì›Œì»¤ë¥¼ 1ê°œë¡œ ì œí•œí•˜ëŠ” SemaphoreëŠ” &lt;strong>Binary Semaphoreë¡œì„œ Mutexë¥¼ ì´ìš©í–ˆì„ ë•Œì™€ ìœ ì‚¬í•˜ë‹¤ê³  ë§í–ˆë“¯ì´ thread-safeí•˜ê²Œ count ì‘ì—…ì´ ì´ë£¨ì–´ì ¸ ì˜ˆìƒë˜ëŠ” ê°’ì´ì—ˆë˜ 0ì´ ì¶œë ¥ë¨&lt;/strong>ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ë™ì‹œì ‘ê·¼ì´ ê°€ëŠ¥í•œ ì›Œì»¤ê°€ 1ê°œ ì´ìƒì´ ë˜ë©´ thread-safeí•˜ì§€ ì•Šê²Œ ë˜ê³ , ë™ì‹œì ‘ê·¼ ì›Œì»¤ ê°œìˆ˜ê°€ ë§ì•„ì§ˆìˆ˜ë¡ ê²°ê³¼ê°€ ë” ë¶€ì •í™•í•œ ê²½í–¥ì´ ìˆëŠ” ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¬ë‹¤.&lt;/p>
&lt;h3 id="-semaphore-ê·¸ë˜ì„œ-ì–¸ì œ-ì“°ë‚˜ìš”">ğŸ’¡ Semaphore.. ê·¸ë˜ì„œ ì–¸ì œ ì“°ë‚˜ìš”?&lt;/h3>
&lt;blockquote>
&lt;p>MutexëŠ” thread-safeí•œ ì‘ì—…ì„ í•  ë•Œ ì‚¬ìš©í•˜ë©´ ë˜ëŠ” ê²ƒ ê°™ì€ë° SemaphoreëŠ” ê°œë…ì€ ì•Œê² ëŠ”ë° ì–¸ì œ ì¨ì•¼í•  ì§€ë¥¼ ì˜ ëª¨ë¥´ê² ë„¤ìš”. ì¼ì • ê°œìˆ˜ë§Œí¼ë§Œ ë™ì‹œ ì ‘ê·¼ì„ í—ˆìš©í•˜ë ¤ëŠ” ê²½ìš°ê°€ ìˆì„ê¹Œìš”?&lt;/p>
&lt;/blockquote>
&lt;p>Semaphoreì„ ì‚¬ìš©í•˜ê¸° ì¢‹ì€ ì¼€ì´ìŠ¤ëŠ” &lt;strong>ë™ì‹œì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ì›Œì»¤ ìˆ˜ë¥¼ ì œí•œí•˜ëŠ” ê²½ìš°&lt;/strong>ì´ê³ , ì´ëŠ” ì£¼ë¡œ &lt;strong>ì „ì²´ ì‘ì—…ì´ ëŠ˜ì–´ì§€ëŠ” ê²ƒì„ ë°©ì§€í•˜ê³ ì í•˜ëŠ” ê²½ìš°&lt;/strong>ì— ì´ìš©ëœë‹¤. ë§ì€ ì‘ì—…ì„ ë™ì‹œì— ìˆ˜í–‰í•˜ë ¤í•˜ë©´ ë¨¼ì € ìˆ˜í–‰ë  ìˆ˜ ìˆëŠ” ì‘ì—…ì€ ë¨¼ì € ìˆ˜í–‰ë˜ë„ë¡ í•˜ê¸°ë³´ë‹¤ëŠ” ì „ì²´ì ìœ¼ë¡œ ëª¨ë“  ì‘ì—…ì´ ëŠ˜ì–´ì§€ê²Œ ë˜ê³  CPUë‚˜ Memory ë¦¬ì†ŒìŠ¤ë¥¼ ë§ì´ ì†Œëª¨í•˜ê²Œ ë˜ê³  ì´ëŠ” ì„œë²„ì˜ ì•ˆì •ì„±ì—ë„ ì¢‹ì§€ ì•Šë‹¤. Semaphoreë¥¼ ì´ìš©í•´ ë™ì‹œ ì ‘ê·¼ ì›Œì»¤ ìˆ˜ë¥¼ ì œí•œí•˜ê³ ìí•˜ëŠ” ì¼€ì´ìŠ¤ëŠ” Goì˜ Worker pool íŒ¨í„´ì„ ì´ìš©í•˜ëŠ” ê²½ìš°ë‚˜ Pipeline patternì„ ì´ìš©í•˜ëŠ” ê²½ìš°ì™€ ìœ ì‚¬í•˜ë‹¤.(&lt;em>ì²˜ìŒì—” Goì˜ ëª¨ë“  Concurrent patternë“¤ì„ ê°œë³„ì ìœ¼ë¡œ êµ¬ë³„ì§€ìœ¼ë ¤í–ˆì—ˆëŠ”ë°, ê³µë¶€í•˜ë‹¤ë³´ë‹ˆ ì¼ì •í•œ ê°œìˆ˜ì˜ Workerë¥¼ ì´ìš©í•˜ëŠ” Worker Pool pattern, Channelì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì—… ë‚´ì—­ì„ ìª¼ê°œì–´ ì‹¤ì‹œê°„ ì²˜ë¦¬í•˜ëŠ” Pipeline, í•œ ì±„ë„, ì—¬ëŸ¬ Goroutineì„ ì´ìš©í•˜ëŠ” Fan-in Fan-out pattern ë“±ë“± ë‹¤ë“¤ ìœ ì‚¬í•˜ê³  ì—°ê´€ì´ ë˜ì–´ìˆë”ë¼.&lt;/em>)&lt;/p>
&lt;p>&lt;strong>Semaphoreë¡œ ë™ì‹œ ì ‘ê·¼ Worker ìˆ˜ë¥¼ ì œí•œí•˜ì§€ ì•Šê³  ëª¨ë“  Goroutineì„ ë™ì‹œì ìœ¼ë¡œ ìˆ˜í–‰í•˜ëŠ” ê²½ìš°ì—” ì–´ë–»ê²Œ ë ê¹Œ?&lt;/strong>&lt;/p>
&lt;p>Logical Processor ê°œìˆ˜ë¥¼ í›¨ì”¬ ë„˜ëŠ” ëª¨ë“  Goroutine ë™ì‹œì ìœ¼ë¡œ ì‘ì—…ì„ ì§„í–‰í•  ê²½ìš° ì•„ë¬´ë¦¬ Goroutineì´ concurrentí•œ ì‘ì—… ìˆ˜í–‰ì— ë›°ì–´ë‚œ ì„±ëŠ¥ì„ ë³´ì¸ë‹¤í• ì§€ë¼ë„ ê³¼í•˜ê²Œ ë§ì€ ìˆ˜ì˜ Goroutineì€ ì„±ëŠ¥ ì €í•˜ë¥¼ ì•¼ê¸°í•˜ì§€ ì•Šì„ê¹Œ ì˜ˆìƒí–ˆë‹¤. í•˜ì§€ë§Œ user-level thread í˜¹ì€ green level threadì˜ ì¼ì¢…ì¸ Goroutineì€ OS(í˜¹ì€ Kernel) threadì™€ ë‹¬ë¦¬ Context switchë¡œ ì¸í•œ penaltyê°€ ê±°ì˜ ì—†ì–´ì„œì¸ì§€ ê±°ì˜ Throughput ë©´ì—ì„œì˜ ì„±ëŠ¥ ì°¨ì´ê°€ ì—†ì—ˆë‹¤.&lt;/p>
&lt;blockquote>
&lt;p>Kernel level threadëŠ” OSê°€ ìŠ¤ì¼€ì¥´ë§ì„ ë‹´ë‹¹í•˜ê¸° ë•Œë¬¸ì— Go í”„ë¡œê·¸ë¨ì´ ë­ ì–´ë–»ê²Œ í•  ìˆ˜ ìˆëŠ” ê²Œ ì•„ë‹ˆì§€ë§Œ Goroutineì€ í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰ë˜ëŠ” ë™ì•ˆ Go ëŸ°íƒ€ì„ì´ ìŠ¤ì¼€ì¥´ë§ì„ ë‹´ë‹¹í•œë‹¤. ê°™ì€ Kernel level threadì— ì†í•œ User level threadì¸ goroutineê°„ì˜ switchëŠ” costê°€ ê±°ì˜ ì—†ë‹¤. ì¦‰ goroutineì´ ë§ë“  ì ë“  Kernel level threadê°„ì˜ context switch costëŠ” ë™ì¼í•˜ë‹¤ê³  ë³¼ ìˆ˜ ìˆê³ , í•´ë‹¹ Kernel level threadì— ì†í•œ goroutineê°„ì˜ context switch costëŠ” ê±°ì˜ ì—†ë‹¤.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>ì°¸ê³ : Kernel level threadì— ëŒ€í•œ ìŠ¤ì¼€ì¥´ë§ì€ ì£¼ë¡œ Preemptive ë°©ì‹ì„, User level threadì— ëŒ€í•œ ìŠ¤ì¼€ì¥´ë§ì€ ì£¼ë¡œ Cooperativeí•œ ë°©ì‹ì„ ì´ìš©í•˜ì§€ë§Œ Goroutineì€ User level threadì„ì—ë„ Go 1.14 ë²„ì „ë¶€í„°ëŠ” 10nsë¥¼ ê¸°ì¤€ìœ¼ë¡œ goroutineì„ switch í•  ìˆ˜ ìˆëŠ” asynchronously preemptiveí•œ ìŠ¤ì¼€ì¥´ ë°©ì‹ì„ ì§€ì›í•œë‹¤ê³  í•œë‹¤. í•˜ì§€ë§Œ Go 1.14ê°€ ë¦´ë¦¬ì¦ˆëœ ì§€ ì–¼ë§ˆë˜ì§€ ì•Šì•„ì„œì¸ì§€, asynchorously preemptive schedulingì— ëŒ€í•´ì„œëŠ” ëª…í™•íˆ ì„¤ëª…ëœ ë¬¸ì„œë¥¼ ì°¾ê¸° í˜ë“¤ì—ˆë‹¤.
User level threadì˜ ì˜ˆë¡œëŠ” RxJava in Java, Coroutine in Kotlin, Goroutine in Golangì´ ìˆë‹¤.&lt;/p>
&lt;/blockquote>
&lt;p>í•˜ì§€ë§Œ Throughput ì ì¸ ì¸¡ë©´ë³´ë‹¤ëŠ” Machineì˜ Resource ì†Œëª¨ ì¸¡ë©´ì—ì„œëŠ” ëª¨ë“  Goroutineì´ ë™ì‹œì ìœ¼ë¡œ ìˆ˜í–‰ë˜ëŠ” êµ¬ì¡°ë³´ë‹¤ëŠ” &lt;strong>Semaphoreì„ ë°”íƒ•ìœ¼ë¡œí•œ ë™ì‹œì— ì¼ì • ê°œìˆ˜ì˜ ì›Œì»¤ë§Œì´ ì‘ì—…í•˜ëŠ” Worker Pool êµ¬ì¡°ê°€ í›¨ì”¬ Memoryë‚˜ CPU ë¦¬ì†ŒìŠ¤ë¥¼ ì ê²Œ ì†Œëª¨&lt;/strong>í•˜ëŠ” ë“¯ í–ˆë‹¤. ë˜í•œ 100ê°œì˜ ë™ì‹œ ìš”ì²­ì„ ìˆ˜í–‰í•˜ëŠ”ë° ë™ì¼í•œ Throughputìœ¼ë¡œ ì•½ 10ì´ˆê°€ ê±¸ë¦°ë‹¤ê³  ì¹˜ë©´, ìš”ì²­ë‹¹ goroutineì„ ìƒì„±í•˜ëŠ” ê²½ìš°ëŠ” ì²« ë²ˆì§¸ ìš”ì²­ë„ ê±°ì˜ 10ì´ˆê°€ ê±¸ë¦° ë°˜ë©´ Semaphoreì„ ì´ìš©í•œ ê²½ìš°ëŠ” ë¨¼ì € ì˜¨ ìš”ì²­ì€ ëŒ€ì²´ë¡œ ë¹ ë¥´ê²Œ ë¨¼ì € ì²˜ë¦¬ë˜ëŠ” ê²½í–¥ì„ ë³´ì˜€ë‹¤. ì´ ì°¨ì´ëŠ” &lt;strong>ì²˜ìŒ ìš”ì²­ì„ ë³´ë‚¸ ì‚¬ìš©ì ë§ˆì € 10ì´ˆë¥¼ ê¸°ë‹¤ë¦¬ê²Œ í•  ê²ƒì´ëƒ, 0.1ì´ˆë§Œì— ì‘ë‹µì„ ë°›ë„ë¡ í•  ê²ƒì´ëƒì˜ ì°¨ì´&lt;/strong>ì´ë‹¤. ë˜í•œ &lt;strong>ì „ì²´ ì‘ì—…ì´ ëŠ˜ì–´ì§€ë©´ ê·¸ ì‘ì—…ì— ëŒ€í•œ ë©”ëª¨ë¦¬ ì ìœ ê°€ ì§€ì†&lt;/strong>ë˜ê¸°ì— ë©”ëª¨ë¦¬ ì¸¡ë©´ì—ì„œë„ ë¹„íš¨ìœ¨ì ì´ë‹¤.&lt;/p>
&lt;h3 id="semaphoreì„-ì´ìš©í•œ-go-program-2---ì´ë¯¸ì§€-í¬ê¸°-ë³€í™˜ê¸°">Semaphoreì„ ì´ìš©í•œ Go Program 2 - ì´ë¯¸ì§€ í¬ê¸° ë³€í™˜ê¸°&lt;/h3>
&lt;p>ë§ˆì¹¨ ì´ë²ˆì— í”„ë¡œì íŠ¸ì—ì„œ thumbnail ìƒì„±, image í¬ê¸° ë³€í™˜, hashed uri ìƒì„± ì‘ì—… ë“±ì„ ë‹´ë‹¹í•˜ëŠ” &lt;code>image processing ì„œë²„&lt;/code>ë¥¼ ê°œë°œí•˜ë ¤í–ˆëŠ”ë°, imageë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” I/O ì‘ì—… ì´í›„ì˜ image processingì€ CPU Bound í•œ ì‘ì—…ì´ê¸° ë•Œë¬¸ì— ë™ì‹œì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” Goroutineì´ ì¼ì • ìˆ«ì(ëŒ€ê²Œ Logical Processor ê°œìˆ˜) ì´ìƒìœ¼ë¡œëŠ” ë§ì•„ì ¸ë´¤ì í¬ê²Œ íš¨ìœ¨ì´ ì—†ì„ ê²ƒì´ë¼ ì˜ˆìƒí–ˆê³ , ê·¸ì™€ ê´€ë ¨í•´ ê°„ë‹¨í•˜ê²Œ ì´ë¯¸ì§€ í¬ê¸° ë³€í™˜ í”„ë¡œê·¸ë¨ì„ í•˜ë‚˜ ë§Œë“¤ì–´ í…ŒìŠ¤íŠ¸ í•´ë³´ì•˜ë‹¤.&lt;/p>
&lt;p>ì•½ 2MBì˜ ì´ë¯¸ì§€ì— ëŒ€í•œ í¬ê¸° ë³€í™˜ ì‘ì—… ìš”ì²­ì´ ë™ì‹œì— 30ê°œ ë“¤ì–´ì™”ë‹¤ëŠ” ê°€ì •ì„ í–ˆê³ , semaphoreì„ ì´ìš©í•œ ê²½ìš° ë™ì‹œì ìœ¼ë¡œ ìµœëŒ€ 4ê°œì˜ worker(goroutine)ì´ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ, concurrentë¥¼ ì´ìš©í•œ ê²½ìš°ëŠ” 30ê°œì˜ ìš”ì²­ ëª¨ë‘ ë™ì‹œì ìœ¼ë¡œ ì‘ì—…ì„ í•˜ëŠ” ê²½ìš°ì´ë‹¤.&lt;/p>
&lt;p>(ì½”ë“œ ì°¸ê³ (ì¸í„°ë„· ì•¡ì„¸ìŠ¤ë¥¼ í•˜ëŠ” ê²½ìš° Playgroundì—ì„œ ë™ì‘í•˜ì§€ëŠ” ì•ŠëŠ”ë“¯í•˜ë‹¤): &lt;a class="link" href="https://play.golang.org/p/Vfyw6uCOIuL" target="_blank" rel="noopener"
>https://play.golang.org/p/Vfyw6uCOIuL&lt;/a>)&lt;/p>
&lt;blockquote>
&lt;p>ì‚¬ì‹¤ Logical Processor 8ê°œ, RAM 16GBì˜ ê°œì¸ ë…¸íŠ¸ë¶ìœ¼ë¡œëŠ” ê·¸ ì°¨ì´ê°€ ë§ì´ ë‚˜ì§€ëŠ” ì•Šì•„ì„œ AWS EC2 t2.micro instanceì—ì„œ ì„±ëŠ¥ì„ í…ŒìŠ¤íŠ¸í•´ë´¤ë‹¤.&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">ubuntu&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">ip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">172&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="err">~$&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sem&lt;/span> &lt;span class="nx">semaphore&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">ë³€í™˜í•˜ê³ ìí•˜ëŠ”&lt;/span> &lt;span class="nx">Imageë“¤ì„&lt;/span> &lt;span class="nx">ë©”ëª¨ë¦¬ì—&lt;/span> &lt;span class="nx">Loadí–ˆìŠµë‹ˆë‹¤&lt;/span>&lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">2021&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mo">01&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">18&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">28&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">13&lt;/span> &lt;span class="nx">Elapsed&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">1.974380959&lt;/span>&lt;span class="nx">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span> &lt;span class="nx">ìƒëµ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">2021&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mo">01&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">18&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">28&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span> &lt;span class="nx">Elapsed&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">1.159552779&lt;/span>&lt;span class="nx">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">2021&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mo">01&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">18&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">28&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span> &lt;span class="nx">Elapsed&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">1.016627316&lt;/span>&lt;span class="nx">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">2021&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mo">01&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">18&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">28&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span> &lt;span class="nx">Total&lt;/span> &lt;span class="nx">elapsed&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">14.959516003&lt;/span>&lt;span class="nx">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">ubuntu&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">ip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">172&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="err">~$&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sem&lt;/span> &lt;span class="nx">concurrent&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">ë³€í™˜í•˜ê³ ìí•˜ëŠ”&lt;/span> &lt;span class="nx">Imageë“¤ì„&lt;/span> &lt;span class="nx">ë©”ëª¨ë¦¬ì—&lt;/span> &lt;span class="nx">Loadí–ˆìŠµë‹ˆë‹¤&lt;/span>&lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Killed&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ë†€ëê²Œë„ ë™ì‹œì ìœ¼ë¡œ 30ê°œì˜ ìš”ì²­ì„ ë³´ë‚´ëŠ” ê²½ìš°ì— 30ê°œì˜ ëª¨ë“  goroutineì´ ë™ì‹œì— ì‘ì—…ì„ ì‹œë„í•  ë•Œì—ëŠ” ê³¼ë„í•œ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ìœ¼ë¡œ ì¸í•´ ì•„ì˜ˆ OSê°€ í”„ë¡œì„¸ìŠ¤ë¥¼ Killí•´ë²„ë ¸ë‹¤. ì¦‰ &lt;strong>Semaphoreë¡œ ë™ì‹œ ì ‘ê·¼ Worker ìˆ˜ë¥¼ ì œí•œí•˜ì§€ ì•ŠëŠ” ê²½ìš° t2.micro ì¸ìŠ¤í„´ìŠ¤ë¡œ ëŒë¦¬ëŠ” image ì„œë²„ì— ë™ì‹œì— 30ê°œì˜ image resizing ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ processê°€ ì£½ì–´ë²„ë¦°ë‹¤&lt;/strong>ëŠ” ë§ì´ë‹¤&amp;hellip;!&lt;/p>
&lt;p>ë˜í•œ ì•ì„œ ë§í–ˆë“¯ì´ ë™ì‹œì— ìš”ì²­í•˜ëŠ” ì‚¬ìš©ìê°€ ë§ì•„ì§€ë”ë¼ë„ Semaphoreì„ ì´ìš©í•œ ê²½ìš°ëŠ” ë‚˜ì¤‘ì— ë“¤ì–´ì˜¨ ìš”ì²­ì¼ ìˆ˜ë¡ ì²˜ë¦¬ê°€ ëŠ˜ì–´ì§€ì§€ë§Œ, Semaphoreë¥¼ í†µí•´ ë™ì‹œ ì‘ì—…ì„ ì œí•œí•˜ì§€ ì•ŠëŠ” ê²½ìš°ëŠ” ì „ì²´ ì‘ì—…ì´ ëŠ˜ì–´ì§„ë‹¤.&lt;/p>
&lt;p>ì´ë ‡ê²Œ SemaphoreëŠ” ë™ì‹œ ì ‘ê·¼ ì›Œì»¤ ìˆ˜ë¥¼ ì œí•œí•˜ì—¬ ì „ì²´ì ì¸ Throughput ì¸¡ë©´ë³´ë‹¤ëŠ” ë¦¬ì†ŒìŠ¤ ì†Œëª¨ì ì¸ ì¸¡ë©´ê³¼ ë¨¼ì € ì²˜ë¦¬ë  ìˆ˜ ìˆëŠ” ì‘ì—…ì€ ë¨¼ì € ì²˜ë¦¬ë˜ë„ë¡ í•  ìˆ˜ ìˆë‹¤ëŠ” ë©´ì—ì„œ ì¥ì ì´ ìˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.&lt;/p>
&lt;h2 id="ë§ˆì¹˜ë©°">ë§ˆì¹˜ë©°&lt;/h2>
&lt;p>Mutexë‚˜ Semaphoreì˜ ê°œë…ì´ë‚˜ ì„¤ëª…ê³¼ ê°™ì€ ì´ë¡ ì ì¸ ë‚´ìš©ì€ êµ¬ê¸€ë§ì„ í†µí•´ ì–´ë µì§€ ì•Šê²Œ ì–»ì„ ìˆ˜ ìˆëŠ” í”í•œ ì§€ì‹ì¸ ë°˜ë©´, ì •í™•íˆ ì–¸ì œ ì“°ë©´ ì¢‹ì„ì§€, ì–¸ì œ ì“°ì¼ ìˆ˜ ìˆì„ì§€ì™€ ê°™ì€ ì‹¤ìš©ì ì¸ ë‚´ìš©ì€ ì°¾ì•„ë³´ê¸° ì–´ë ¤ì› ê¸°ë•Œë¬¸ì— Goë¥¼ í†µí•´ Mutexì™€ Semaphoreì„ ì´ìš©í•´ë³´ëŠ” ê°„ë‹¨í•œ í”„ë¡œê·¸ë¨ì„ ë§Œë“¤ì–´ ì‹¤ìŠµí•´ë³´ì•˜ë‹¤.&lt;/p>
&lt;p>ì˜ˆì œ í”„ë¡œê·¸ë¨ìœ¼ë¡œì„œ ì½”ë“œë¥¼ ê°„ê²°í•˜ê³  ì½ê¸° ì‰½ê²Œ ê¹”ë”í•˜ê²Œ ì œê³µí•´ë³´ê³ ìí–ˆëŠ”ë°, ê·¸ëŸ¬ê¸° ì‰½ì§€ ì•Šì•˜ë˜ ê²ƒ ê°™ì•„ ì•„ì‰½ë‹¤. ë‹¤ìŒì—” ê¸°íšŒê°€ ë˜ë©´ goì˜ benchmark testë¥¼ ì´ìš©í•´ë³´ë©´ ì–´ë–¨ê¹Œì‹¶ë‹¤.&lt;/p>
&lt;h2 id="ì°¸ê³ ">ì°¸ê³ &lt;/h2>
&lt;p>&lt;strong>Goroutineê³¼ Goroutine schedulingì— ëŒ€í•´&lt;/strong> - &lt;a class="link" href="https://thegopher.tistory.com/3" target="_blank" rel="noopener"
>https://thegopher.tistory.com/3&lt;/a>&lt;/p>
&lt;p>í™”ì¥ì‹¤ì— ë¹„ìœ í•œ ë®¤í…ìŠ¤ì™€ ì„¸ë§ˆí¬ì–´ - &lt;a class="link" href="https://worthpreading.tistory.com/90" target="_blank" rel="noopener"
>https://worthpreading.tistory.com/90&lt;/a>&lt;/p>
&lt;p>semaphore in Go &lt;a class="link" href="https://medium.com/@deckarep/gos-extended-concurrency-semaphores-part-1-5eeabfa351ce" target="_blank" rel="noopener"
>https://medium.com/@deckarep/gos-extended-concurrency-semaphores-part-1-5eeabfa351ce&lt;/a>&lt;/p>
&lt;p>cooperative vs preemptive - &lt;a class="link" href="https://medium.com/traveloka-engineering/cooperative-vs-preemptive-a-quest-to-maximize-concurrency-power-3b10c5a920fe" target="_blank" rel="noopener"
>https://medium.com/traveloka-engineering/cooperative-vs-preemptive-a-quest-to-maximize-concurrency-power-3b10c5a920fe&lt;/a>&lt;/p>
&lt;p>preemptive scheduling in go - &lt;a class="link" href="https://blog.puppyloper.com/menus/Golang/articles/Goroutine%EA%B3%BC%20Go%20scheduler" target="_blank" rel="noopener"
>https://blog.puppyloper.com/menus/Golang/articles/Goroutineê³¼ Go scheduler&lt;/a>&lt;/p></description></item><item><title>Go ì–¸ì–´ë¡œ ì ìš©í•´ë³´ëŠ” Computer Science - Deadlock</title><link>https://umi0410.github.io/blog/golang/go-deadlock/</link><pubDate>Sun, 31 Jan 2021 18:25:54 +0900</pubDate><guid>https://umi0410.github.io/blog/golang/go-deadlock/</guid><description>&lt;img src="https://umi0410.github.io/blog/golang/go-deadlock/pprof-debugging-1.png" alt="Featured image of post Go ì–¸ì–´ë¡œ ì ìš©í•´ë³´ëŠ” Computer Science - Deadlock" />&lt;h2 id="ì‹œì‘í•˜ë©°">ì‹œì‘í•˜ë©°&lt;/h2>
&lt;p>ê°œë°œ ê³µë¶€ë¥¼ ì‹œì‘í•˜ê³  ì—¬íƒœê¹Œì§€ ëª‡ ë…„ê°„ ë°ë“œë½ì„ ì‹¤ì œë¡œ ì ‘í•  ì¼ì€ ì—†ì—ˆë‹¤. ì‚¬ì‹¤ ë™ì‹œì„±ì„ ì£¼ì˜í•´ì•¼í•˜ëŠ” ì‘ì—…ì„ í•´ë³¸ ì ë„ ì—†ì—ˆê³ , íŠ¸ëœì­ì…˜ì— ëŒ€í•œ ê°œë…ë„ ì—†ì—ˆê¸° ë•Œë¬¸ì¼ ìˆ˜ë„ ìˆë‹¤. ì „ê³µ ê³¼ëª©ì—ì„œ ë°ë“œë½ì— ëŒ€í•œ ë‚´ìš©ì„ ë“£ê³ ì„œë„ &amp;lsquo;&lt;em>ì•„ ì´ëŸ° ê²Œ ìˆêµ¬ë‚˜&lt;/em>&amp;rsquo; ì •ë„ë¡œë§Œ ìƒê°í•˜ê³  ë„˜ê²¼ì—ˆë‹¤. í•˜ì§€ë§Œ Go ì–¸ì–´ë¥¼ í†µí•´ ê°œë°œì„ í•˜ë˜ ë„ì¤‘ &lt;code>Channel&lt;/code>ì´ë‚˜ &lt;code>Mutex&lt;/code>ë¡œ ì¸í•´ ì¢…ì¢… ë°ë“œë½ì„ ê²½í—˜í•  ìˆ˜ ìˆì—ˆê³ , ì´ ê²½ìš° í”„ë¡œê·¸ë¨ì´ ì™„ì „íˆ ë©ˆì¶°ë²„ë¦¬ëŠ” í¬ë¦¬í‹°ì»¬í•œ ë¬¸ì œê°€ ë°œìƒí•˜ê¸°ë„ í–ˆê³ , ë””ë²„ê¹…í•˜ê¸° í˜ë“  ê²½ìš°ë„ ìˆì—ˆë‹¤. ê·¸ëŸ° ê²½í—˜ì„ í•˜ë©´ì„œ &amp;lsquo;&lt;em>ë°ë“œë½ ì´ ë…€ì„&amp;hellip; ë§Œë§Œì¹˜ ì•Šêµ¬ë‚˜&lt;/em>&amp;lsquo;ë¼ëŠ” ìƒê°ì„ í•˜ê³¤ í–ˆë‹¤.&lt;/p>
&lt;p>ì´ë²ˆ ê¸€ì—ì„œëŠ” &lt;strong>&lt;code>Golang&lt;/code> ì¦‰ &lt;code>Go&lt;/code> ì–¸ì–´ë¥¼ í†µí•´ ì–´ë–¤ ê²½ìš°ì— &lt;code>Deadlock&lt;/code>ì´ ë°œìƒí•  ìˆ˜ ìˆëŠ”ì§€ ì‹¤ì œ í”„ë¡œê·¸ë¨ì„ í†µí•´ ì•Œì•„ë³´ë ¤í•œë‹¤.&lt;/strong> Mutexì— ëŒ€í•œ &lt;code>Lock&lt;/code>ê³¼ ê°™ì´ ì¼ë°˜ì ìœ¼ë¡œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë°ë“œë½ë¶€í„° &lt;code>channel&lt;/code>ì´ë‚˜ &lt;code>goroutine&lt;/code>ì— ëŒ€í•œ &lt;code>Cooperative scheduling&lt;/code>ê³¼ ê°™ì€ Go ì–¸ì–´ì— íŠ¹í™”ëœ ë‚´ìš©ê¹Œì§€ë¥¼ ì •ë¦¬í•´ë³´ì•˜ë‹¤.&lt;/p>
&lt;h2 id="deadlockì´ë€">Deadlockì´ë€&lt;/h2>
&lt;blockquote>
&lt;p>Deadlockì´ë€ êµì°©ìƒíƒœë¥¼ ì˜ë¯¸í•˜ë©° ë‘ ê°œ ì´ìƒì˜ ì‘ì—…ì´ ì„œë¡œ ìƒëŒ€ë°©ì˜ ì‘ì—…ì´ ëë‚˜ê¸°ë§Œì„ ê¸°ë‹¤ë¦¬ê³  ìˆê¸° ë•Œë¬¸ì— ê²°ê³¼ì ìœ¼ë¡œ ì•„ë¬´ê²ƒë„ ì™„ë£Œë˜ì§€ ëª»í•˜ëŠ” ìƒíƒœë¥¼ ê°€ë¦¬í‚¨ë‹¤. - ìœ„í‚¤ë°±ê³¼ -&lt;/p>
&lt;/blockquote>
&lt;p>ë°ë“œë½ì˜ ê°œë… ìì²´ëŠ” ê·¸ë¦¬ ì–´ë µì§€ ì•Šê³ , ì˜ˆì‹œë¥¼ í†µí•´ì„œ ì‰½ê²Œ ì´í•´ê°€ ê°€ëŠ¥í•˜ë‹¤. ìœ„í‚¤ ë°±ê³¼ì— ë‚˜ì˜¨ ì˜ˆì‹œë¥¼ ì¸ìš©í•˜ìë©´ í•˜ë‚˜ì˜ ì‚¬ë‹¤ë¦¬ì— ìœ„ì—ì„œ ë‚´ë ¤ì˜¤ë ¤ëŠ” ì‚¬ëŒ, ì•„ë˜ì—ì„œ ì˜¬ë¼ê°€ëŠ” ì‚¬ëŒì´ ë™ì‹œì— ì˜¬ë¼ê°€ìˆìœ¼ë©´ ì•„ë¬´ë„ ë‚´ë ¤ì˜¤ê±°ë‚˜ ì˜¬ë¼ê°€ì§€ ëª»í•˜ëŠ” ê²½ìš°ë¥¼ ì˜ˆë¡œ ë“¤ ìˆ˜ ìˆë‹¤.&lt;/p>
&lt;h3 id="êµì°©-ìƒíƒœì˜-ì¡°ê±´">êµì°© ìƒíƒœì˜ ì¡°ê±´&lt;/h3>
&lt;p>ë” ìì„¸íˆ ì •ì˜ë‚˜ ì˜ë¯¸ì— ëŒ€í•´ ì„¤ëª…í•  ê²ƒì€ ì—†ì„ ë“¯í•˜ê³ , í•™ë¬¸ì ìœ¼ë¡œëŠ” ì£¼ë¡œ ì•„ë˜ì˜ 4ê°€ì§€ ì¡°ê±´ì„ í†µí•´ ë°œìƒí•œë‹¤ê³  ì„¤ëª…í•˜ëŠ” ê²ƒ ê°™ë‹¤.&lt;/p>
&lt;ol>
&lt;li>ìƒí˜¸ ë°°ì œ (Mutual exclusion) - í•˜ë‚˜ì˜ ìì›ì„ ë™ì‹œì— ì‚¬ìš©í•˜ì§€ ëª»í•˜ë„ë¡ í•˜ëŠ” ê²ƒ&lt;/li>
&lt;li>ì ìœ  ìƒíƒœë¡œ ëŒ€ê¸° (Hold and wait) - í•˜ë‚˜ì˜ ìì›ì„ ì†Œìœ í•œ ìƒíƒœë¡œ ë‹¤ë¥¸ ìì›ì„ ê¸°ë‹¤ë¦¬ê³  ìˆëŠ” ìƒíƒœ&lt;/li>
&lt;li>ì„ ì  ë¶ˆê°€ (No preemption) - ì»´í“¨í„° ë¶„ì•¼ì—ì„œì˜ ì„ ì ì€ í•œêµ­ë§ì˜ ì„ ì ê³¼ ë‹¤ì†Œ ë‹¤ë¥¸ ì˜ë¯¸. process í˜¹ì€ goroutineì˜ ìì›ì„ ë¹¼ì•—ëŠ” ê²ƒì„ ì„ ì ì´ë¼ê³  í•¨. ì„ ì  ë¶ˆê°€ë€ ê·¸ëŸ´ ìˆ˜ ì—†ëŠ” ìƒíƒœ.&lt;/li>
&lt;li>ìˆœí™˜ì„± ëŒ€ê¸° (Circular wait) - ê° í”„ë¡œì„¸ìŠ¤ê°€ ìˆœí™˜ì ìœ¼ë¡œ ë‹¤ìŒ í”„ë¡œì„¸ìŠ¤ê°€ ìš”êµ¬í•˜ëŠ” ìì›ì„ ê°€ì§€ê³ ìˆë‹¤. ì‰½ê²Œ 2ê°œì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ì˜ˆë¡œ ë“¤ë©´ AëŠ” Bê°€ ì†Œìœ  ì¤‘ì¸ ìì›ì„, BëŠ” Aê°€ ì†Œìœ  ì¤‘ì¸ ìì›ì„ ì–»ìœ¼ë ¤ê³  ëŒ€ê¸° ì¤‘ì¸ ìƒí™©ì„ ë§í•¨.&lt;/li>
&lt;/ol>
&lt;p>Deadlockì˜ ê°œë… ìì²´ê°€ ì–´ë µë‹¤ê±°ë‚˜ ìœ„ì˜ 4ê°€ì§€ ì¡°ê±´ì„ ì•”ê¸°í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•œ ê²ƒì€ ì•„ë‹ˆë¼ê³  ìƒê°í•œë‹¤. ì¤‘ìš”í•œ ê²ƒì€ ì‹¤ì œë¡œ ì–´ë–¤ ê²½ìš°ì— ë°ë“œë½ì´ ë°œìƒí•  ìˆ˜ ìˆì„ ì§€ íŒŒì•…í•˜ê³  ì£¼ì˜í•˜ëŠ” ê²ƒê³¼ ê·¸ ê²½ìš° ì–´ë–»ê²Œ í•´ê²°í•  ìˆ˜ ìˆì„ì§€ ì¸ì§€í•˜ëŠ” ê²ƒì´ë¼ê³  ìƒê°í•œë‹¤. ê·¸ëŸ¼ Go ì–¸ì–´ë¡œ ê°„ë‹¨í•œ í”„ë¡œê·¸ë¨ì„ ì§œë³´ë©° ì•Œì•„ë³´ì.&lt;/p>
&lt;h2 id="goì—ì„œ-ë°œìƒí• -ìˆ˜-ìˆëŠ”-deadlock">Goì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” Deadlock&lt;/h2>
&lt;h3 id="channel">Channel&lt;/h3>
&lt;p>ì£¼ë¡œ ì±„ë„ì„ ì ‘í•œ ì§€ ì–¼ë§ˆ ì•ˆ ë˜ì–´ ê·¸ ë™ì‘ ë°©ì‹ì„ ì˜ ì´í•´í•˜ì§€ ëª»í•œ ì±„ ì‚¬ìš©í•  ê²½ìš° ì±„ë„ë¡œ ì¸í•œ ë°ë“œë½ì´ ë°œìƒí•œë‹¤.&lt;/p>
&lt;h4 id="unbuffered-channel">Unbuffered channel&lt;/h4>
&lt;p>&lt;img src="https://umi0410.github.io/blog/golang/go-deadlock/unbuffered-channel-1.png"
width="658"
height="523"
srcset="https://umi0410.github.io/blog/golang/go-deadlock/unbuffered-channel-1_hu10a616b58d6a106d3f4b8196ebfc4c11_56914_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/golang/go-deadlock/unbuffered-channel-1_hu10a616b58d6a106d3f4b8196ebfc4c11_56914_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="unbuffered-channel-1.png"
class="gallery-image"
data-flex-grow="125"
data-flex-basis="301px"
>&lt;/p>
&lt;p>íŠ¹íˆë‚˜ unbuffered channelì— ëŒ€í•œ ë¯¸ìˆ™í•œ ì‚¬ìš©ì€ ìì£¼ ë°ë“œë½ì„ ì•¼ê¸°í•œë‹¤. &lt;code>unbuffered channel&lt;/code>ì—ì„œ ë°œìƒí•˜ëŠ” ì¼ë°˜ì ì¸ ë°ë“œë½ì˜ ì˜ë¯¸ì¸ 2ê°œ ì´ìƒì˜ ì‘ì—… ì„œë¡œì˜ ì‘ì—…ì´ ì™„ë£Œë˜ê¸°ë¥¼ ëŒ€ê¸°í•˜ëŠ” êµì°© ìƒíƒœì™€ëŠ” ì•½ê°„ ë‹¤ë¥´ë‹¤ê³  ë³¼ ìˆ˜ë„ ìˆë‹¤. ì™œëƒí•˜ë©´ &lt;code>sender&lt;/code>ì™€ &lt;code>receiver&lt;/code> ì¤‘ ëˆ„êµ°ê°€ê°€ ë¨¼ì € ì‘ì—…ì„ ëë‚´ì•¼ì§€ ê·¸ ë‹¤ìŒìœ¼ë¡œ ëˆ„êµ°ê°€ê°€ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ê²ƒì´ ì•„ë‹ˆë¼ &lt;strong>ì„œë¡œ ë™ì‹œì— í˜‘ë ¥í•´ì•¼ë§Œ unbuffered channelì— ëŒ€í•œ ëŒ€ê¸°ë¥¼ ëë‚¼ ìˆ˜ ìˆëŠ”ë° ì´ ê²½ìš°ëŠ” ë™ì‹œì— í˜‘ë ¥í•´ì¤„ ê·¸ ëˆ„êµ°ê°€(receiver)ê°€ ì—†ëŠ” ê²½ìš°&lt;/strong>ì´ê¸° ë•Œë¬¸ì´ë‹¤.&lt;/p>
&lt;p>&lt;img src="https://umi0410.github.io/blog/golang/go-deadlock/unbuffered-channel-2.png"
width="524"
height="280"
srcset="https://umi0410.github.io/blog/golang/go-deadlock/unbuffered-channel-2_huc23feddb7907332ddbd012773a8469b8_20930_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/golang/go-deadlock/unbuffered-channel-2_huc23feddb7907332ddbd012773a8469b8_20930_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="unbuffered-channel-2.png"
class="gallery-image"
data-flex-grow="187"
data-flex-basis="449px"
>&lt;/p>
&lt;p>ê·¸ë ‡ë‹¤ê³ í•´ì„œ ìœ„ì™€ ê°™ì´ ìê¸° í˜¼ì sendì™€ receiveë¥¼ í•˜ë ¤í•´ë´¤ì Unbuffered channelì€ senderì™€ receiverê°€ ëª¨ë‘ readyì—¬ì•¼ ì‘ì—…ì„ ì§„í–‰í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë¶ˆê°€ëŠ¥í•˜ë‹¤. (&lt;em>Unbuffered channelì˜ ë™ì‘ì— ëŒ€í•´ ì¢€ ë” ê¶ê¸ˆí•˜ì‹  ë¶„ë“¤ì€ ì œê°€ ë²ˆì—­ì— ì°¸ì—¬í•œ &lt;a class="link" href="https://go-tour-ko.appspot.com/concurrency/2" target="_blank" rel="noopener"
>A Tour of Go&lt;/a>ë¥¼ ì°¸ê³ í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤!&lt;/em>)&lt;/p>
&lt;p>&lt;img src="https://umi0410.github.io/blog/golang/go-deadlock/unbuffered-channel-3.png"
width="667"
height="474"
srcset="https://umi0410.github.io/blog/golang/go-deadlock/unbuffered-channel-3_hu79ddac0bd959ff7fccac87fc3364f23d_48295_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/golang/go-deadlock/unbuffered-channel-3_hu79ddac0bd959ff7fccac87fc3364f23d_48295_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="unbuffered-channel-3.png"
class="gallery-image"
data-flex-grow="140"
data-flex-basis="337px"
>&lt;/p>
&lt;p>ë”°ë¼ì„œ &lt;strong>ë‹¤ë¥¸ goroutineì—ì„œ Aì— ëŒ€í•œ receiver ì—­í• ì„ í•´ì£¼ë©´ ëœë‹¤.&lt;/strong>&lt;/p>
&lt;h3 id="buffered-channel">Buffered channel&lt;/h3>
&lt;blockquote>
&lt;p>Buffered channelì„ ì´ìš©í•˜ë©´ ì–´ë–¨ì§€ ì¢€ ë” ìì„¸íˆ ë“¤ì–´ê°€ë³´ì. ë…ìë¶„ê»˜ì„œ Goì˜ channelì— ëŒ€í•´ ë³„ ê´€ì‹¬ì´ ì—†ë‹¤ë©´ íŒ¨ìŠ¤~!&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://umi0410.github.io/blog/golang/go-deadlock/buffered-channel-1.png"
width="668"
height="474"
srcset="https://umi0410.github.io/blog/golang/go-deadlock/buffered-channel-1_hu3ce95aebbfcae3388bc01c477c5405bf_44856_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/golang/go-deadlock/buffered-channel-1_hu3ce95aebbfcae3388bc01c477c5405bf_44856_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="buffered-channel-1.png"
class="gallery-image"
data-flex-grow="140"
data-flex-basis="338px"
>&lt;/p>
&lt;p>ë§¨ ì²˜ìŒì— Unbuffered channelì—ì„œëŠ” ìœ„ì™€ ê°™ì´ í•œ goroutineì—ì„œ senderì™€ receiver ì—­í•  ëª¨ë‘ë¥¼ ìˆ˜í–‰í•˜ë ¤í•´ë„ ì´ë¯¸ senderì—ì„œ blockì´ ê±¸ë ¤ë²„ë ¤ deadlockì„ ì•¼ê¸°í•œë‹¤ê³  í–ˆìœ¼ë‚˜ buffered channelì—ì„œëŠ” ê·¸ë ‡ì§€ ì•Šë‹¤! &lt;strong>buffered channelì€ buffer sizeê¹Œì§€ëŠ” ì…ë ¥ ì‘ì—…ì´ ë¸”ë½ë˜ì§€ ì•Šê¸° ë•Œë¬¸&lt;/strong>ì´ë‹¤.&lt;/p>
&lt;p>&lt;img src="https://umi0410.github.io/blog/golang/go-deadlock/buffered-channel-2.png"
width="672"
height="609"
srcset="https://umi0410.github.io/blog/golang/go-deadlock/buffered-channel-2_hu5d060740dcd194dde0764aece5d1bf11_61778_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/golang/go-deadlock/buffered-channel-2_hu5d060740dcd194dde0764aece5d1bf11_61778_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="buffered-channel-2.png"
class="gallery-image"
data-flex-grow="110"
data-flex-basis="264px"
>&lt;/p>
&lt;p>í•˜ì§€ë§Œ &lt;strong>buffer sizeë¥¼ ë„˜ì–´ì„œëŠ” ìˆœê°„ë¶€í„°ëŠ” receiverê°€ channel ë‚´ì˜ ì•„ì´í…œì„ êº¼ë‚´ì–´ ì¤„ ë•Œê¹Œì§€ blockë˜ì–´ë²„ë¦¬ë¯€ë¡œ ì£¼ì˜&lt;/strong>í•´ì•¼í•œë‹¤.&lt;/p>
&lt;h3 id="mutexlockì˜-ì¤‘ì²©">Mutex.Lockì˜ ì¤‘ì²©&lt;/h3>
&lt;p>&lt;code>Mutex&lt;/code>ì˜ êµ¬í˜„ì— ë”°ë¼ ë‹¤ë¥´ê² ì§€ë§Œ Goì—ì„œëŠ” Lockì´ ê±¸ë¦° ìë¬¼ì‡ ì— ë‹¤ì‹œ ìê¸°ê°€ Lockì„ ê±¸ë ¤í•´ë„ Unlockì´ ë  ë•Œê¹Œì§€ëŠ” Lockì„ ê±¸ ìˆ˜ ì—†ë‹¤. ì¦‰ ì–´ë–¤ Mutexì— Lockì„ ê±´ ê²ƒì´ ìì‹ (Goroutine)ì´ë¼ í•´ë„ í•´ë‹¹ Mutexì— ë˜ ë‹¤ì‹œ Lockì„ ê±¸ë ¤í•˜ë©´ ê·¸ ì‘ì—…ì€ Mutexê°€ Unlock ë  ë•Œê¹Œì§€ ë¸”ë½ë˜ê³  ê²°ê³¼ì ìœ¼ë¡œëŠ” Deadlock ìƒíƒœê°€ ë˜ì–´ë²„ë¦°ë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;sync&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">var&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">scores&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">30&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Mutex&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">sync&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Mutex&lt;/span>&lt;span class="p">{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Lockì„ ê±´ ë’¤ ì•ˆì „í•˜ê²Œ topScoreë¥¼ êµ¬í•¨.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">func&lt;/span> &lt;span class="nf">GetTopScore&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">playerIndex&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">topScore&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Mutex&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Lock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">topScore&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">idx&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">score&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">scores&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">topScore&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">score&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">playerIndex&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">idx&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">topScore&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">score&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Mutex&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Unlock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// GetTopScoreëŠ” ì´ë¯¸ Lockì„ ì´ìš©í•´ thread safeí•˜ê²Œ ì‘ì—…í•˜ëŠ”ë°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ê·¸ê±¸ ì¸ì§€í•˜ì§€ ëª»í•˜ê³  ì‹¤ìˆ˜ë¡œ ê·¸ ë°–ì¸ Awardì—ì„œ Lockì„ ê±¸ì–´ë²„ë¦¼.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">func&lt;/span> &lt;span class="nf">Award&lt;/span>&lt;span class="p">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Mutex&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Lock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">playerIdx&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">topScore&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">GetTopScore&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Mutex&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Unlock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%dê°€ %dì˜ ì ìˆ˜ë¡œ ìš°ìŠ¹í–ˆìŠµë‹ˆë‹¤!&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">playerIdx&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">topScore&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Award&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// deadlock ë°œìƒ
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ìœ„ì˜ ì˜ˆì‹œì—ëŠ” thread-safeí•˜ê²Œ top scoreë¥¼ êµ¬í•˜ëŠ” &lt;code>GetTopScore&lt;/code> í•¨ìˆ˜ê°€ ì„ ì–¸ë˜ì–´ìˆë‹¤. í•˜ì§€ë§Œ &lt;code>Award&lt;/code> í•¨ìˆ˜ì—ì„œ ì´ë¯¸ &lt;code>GetTopScore&lt;/code>ëŠ” scoresì— ëŒ€í•´ &lt;code>thread-safe&lt;/code>í•¨ì—ë„ ë¶ˆêµ¬í•˜ê³  Lockì„ ê±¸ê³  &lt;code>GetTopScore&lt;/code>ë¥¼ ìˆ˜í–‰í•˜ë ¤í•˜ê¸° ë•Œë¬¸ì— ë°ë“œë½ì´ ë°œìƒí•œë‹¤. ì´ ê²½ìš°ì—ëŠ” &lt;strong>innerì¸ GetTopScore í˜¹ì€ outerì¸ Award ë‘˜ ì¤‘ í•œ ê³³ì—ì„œë§Œ Lock, Unlock ì‘ì—…ì„ ìˆ˜í–‰&lt;/strong>í•˜ë„ë¡ í•´ì£¼ì–´ì•¼í•œë‹¤.&lt;/p>
&lt;p>innerì—ì„œ Lock/Unlockì„ ë‹´ë‹¹í•˜ëŠ” ê²Œ ì˜³ì„ ì§€ outerì—ì„œ Lock/Unlockì„ ë‹´ë‹¹í•˜ëŠ” ê²Œ ì˜³ì„ ì§€ëŠ” ì˜ ëª¨ë¥´ê² ë‹¤. innerì—ì„œ Lock/Unlockì„ ë‹´ë‹¹í•˜ë©´ outerì—ì„œëŠ” ë°ë“œë½ìœ¼ë¡œ ì¸í•´ ì ˆëŒ€ Lock/Unlockì„ ëª»í•œë‹¤ëŠ” ë‹¨ì ì´ ìˆì§€ë§Œ, í•´ë‹¹ ì‘ì—…ì€ ì–¸ì œë‚˜ Atomicí•˜ê²Œ thread-safeí•˜ë‹¤ëŠ” ê²ƒì´ ë³´ì¥ëœë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤. ë°˜ë©´ outerì—ì„œ Lock/Unlockì„ ë‹´ë‹¹í•˜ë„ë¡í•˜ë©´ ë¹„êµì  ììœ ìì¬ë¡œ Lock/Unlockì„ ëª…ë ¹í•  ìˆ˜ ìˆëŠ” ë°˜ë©´ thread-safeí•´ì•¼í•  ë‚´ë¶€ ì‘ì—…ì´ unsafeí•´ì§ˆ ìˆ˜ë„ ìˆë‹¤. ì‹¤ìˆ˜ë¡œ Lock/Unlock ì‘ì—…ì„ ìŠì–´ë²„ë¦´ ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. í•˜ì§€ë§Œ ë¬´ì—‡ë³´ë‹¤ë„ &lt;strong>innerì—ì„œ Lock/Unlockì„ ë‹´ë‹¹í•  ì§€ outerì—ì„œ ë‹´ë‹¹í•  ì§€ë¥¼ ì •í™•íˆ ì •í•  ìˆ˜ ì—†ëŠ” ì´ìœ ëŠ” outerë„ ê²°êµ­ì—” ë˜ ë‹¤ë¥¸ outerì˜ innerê°€ ë  ìˆ˜ ìˆê¸° ë•Œë¬¸&lt;/strong>ì´ë¼ê³  ìƒê°í•œë‹¤.&lt;/p>
&lt;h3 id="cooperative-scheduling-ë°©ì‹ì—ì„œì˜-ë¬´í•œ-loop">Cooperative scheduling ë°©ì‹ì—ì„œì˜ ë¬´í•œ Loop&lt;/h3>
&lt;p>Goroutine schedulerê°€ &lt;strong>Goroutineì„ ìŠ¤ì¼€ì¥´ë§ í•˜ëŠ” ë°©ì‹ì€ Go 1.14 ì´ì „ê¹Œì§€ëŠ” Cooperative ë°©ì‹ì´ì—ˆìœ¼ë‚˜, Go 1.14 ë¶€í„°ëŠ” Preemptiveí•œ ë°©ì‹ìœ¼ë¡œ ë°”ë€Œì—ˆë‹¤&lt;/strong>ê³  í•œë‹¤. OSê°€ Go processì˜ threadë¥¼ ìŠ¤ì¼€ì¥´ í•˜ëŠ” ë°©ì‹ì€ OS ë§ˆë‹¤ ë‹¤ë¥´ê² ì§€ë§Œ ëŒ€ì²´ë¡œ preemptiveí•  ê²ƒì´ê³  ì—¬ê¸°ì„œ ì–˜ê¸°í•˜ë ¤ëŠ” ìŠ¤ì¼€ì¥´ëŸ¬ëŠ” Goroutineì„ ìŠ¤ì¼€ì¥´ë§í•˜ëŠ” Goroutine schedulerì„ì„ ì£¼ì˜í•˜ì.&lt;/p>
&lt;p>Goroutineì€ syscallì™€ mutex, channel, í•¨ìˆ˜ ì½œ ë“±ìœ¼ë¡œ ì¸í•´ switch ë  ìˆ˜ ìˆëŠ”ë°, &lt;strong>cooperative ë°©ì‹ì„ ì´ìš©í•˜ëŠ” ê²½ìš°ì—ëŠ” ì´ëŸ¬í•œ goroutine switch ì¡°ê±´ì— í•´ë‹¹í•˜ì§€ ì•ŠëŠ” ê²½ìš° ì„ì˜ë¡œ goroutine switch í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì§€ ì•ŠëŠ” í•œì€ ê°™ì€ ìŠ¤ë ˆë“œ ë‚´ì˜ ë‹¤ë¥¸ goroutineì€ ì ˆëŒ€ë¡œ ì‹¤í–‰ë  ìˆ˜ ì—†ë‹¤&lt;/strong>. preemption(ì„ ì ) ì¦‰ ë‹¤ë¥¸ goroutineì„ block ìƒíƒœë¡œ ë§Œë“¤ì–´ë²„ë¦¬ê³  ìì‹ ì´ CPUë¥¼ ì„ ì í•˜ëŠ” ê²ƒì´ ë¶ˆê°€ëŠ¥í–ˆê¸° ë•Œë¬¸ì´ë‹¤. í•˜ì§€ë§Œ Go 1.14ë¶€í„°ëŠ” ì•½ 10msë¥¼ ê¸°ì¤€ìœ¼ë¡œ preemptionì„ ìˆ˜í–‰í•˜ê³  ìˆë‹¤. Asynchronous preemptionì´ë¼ê³  ë¶€ë¥´ëŠ” ê²ƒ ê°™ì€ë°, ì •í™•íˆ ì™œ asynchronousì¸ì§€, ê¸°ì¡´ì˜ preemptive scheduleê³¼ëŠ” ë¬´ì—‡ì´ ë‹¤ë¥¸ì§€ëŠ” ì°¾ì•„ë´¤ìœ¼ë‚˜ ì œëŒ€ë¡œ ì„¤ëª…ë˜ì–´ìˆëŠ” ê³³ì„ ì°¾ì§€ ëª»í–ˆë‹¤.&lt;/p>
&lt;p>ì•ìœ¼ë¡œ ì´ì–´ì§€ëŠ” ë‚´ìš©ì€ &lt;em>ë°ë“œë½ì— ëŒ€í•œ ì˜ˆì‹œë¼ê¸° ë³´ë‹¤ëŠ” &amp;lsquo;cooperative ìŠ¤ì¼€ì¥´ë§ê³¼ preemptive ìŠ¤ì¼€ì¥´ë§ì˜ ì°¨ì´ë¡œ ì¸í•´ ë°ë“œë½ì´ ë°œìƒí•  ìˆ˜ë„ ìˆê³  ë°œìƒí•˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆêµ¬ë‚˜&amp;rsquo;ì— ëŒ€í•´ ì•Œì•„ë³´ëŠ” ì˜ˆì‹œ&lt;/em>ì´ë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">Foo&lt;/span>&lt;span class="p">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;No Deadlock. ë‚˜ë„ ì‹¤í–‰ë  ìˆ˜ ìˆì–´!&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="nf">Foo&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">dummy&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="c1">// ê·¸ëƒ¥ for ë¬¸ ì•ˆì—ì„œ dummy ì‘ì—…ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ ë³€ìˆ˜
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">dummy&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>for ë¬¸ ì•ˆì—ì„œëŠ” í•¨ìˆ˜ì½œë„ syscallë„ channel/mutexë„ ì•„ë‹Œ goroutine swtichì™€ ê´€ë ¨ ì—†ëŠ” &lt;code>dummy += 1&lt;/code> ì‘ì—…ë§Œì„ ìˆ˜í–‰í•˜ê³  ìˆë‹¤. ì´ ê²½ìš° &lt;code>go Foo()&lt;/code>ë¥¼ í†µí•´ goroutineì„ ìƒì„±í•˜ê¸´ í•˜ì§€ë§Œ ê·¸ goroutineì€ ë°”ë¡œ ì‹¤í–‰ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ëŒ€ê¸° ìƒíƒœì´ë©° ë§Œì•½ ìŠ¤ë ˆë“œê°€ í•˜ë‚˜ë¼ë©´ cooperative ìŠ¤ì¼€ì¥´ë§ìœ¼ë¡œëŠ” Fooë¼ëŠ” goroutineì´ ì‹¤í–‰ë  ìˆ˜ê°€ ì—†ì„ ê²ƒì´ë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Go ë²„ì „ &amp;gt;= 1.14 ì¼ ë•Œì—ë„ Deadlock ë°œìƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ &lt;span class="nv">GOMAXPROCS&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> &lt;span class="nv">GODEBUG&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">asyncpreemptoff&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> go run main.go
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>GOMAXPROCS=1&lt;/code> - Go í”„ë¡œê·¸ë¨ì´ ì‚¬ìš©í•  ìµœëŒ€ OS Thread ê°œìˆ˜ë¥¼ 1ê°œë¡œ ì œí•œí•¨ìœ¼ë¡œì¨ ì—¬ëŸ¬ ìŠ¤ë ˆë“œì—ì„œ Goroutineì´ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ ë°©ì§€. (ë°ë“œë½ì„ ì•¼ê¸°í•´ë³´ë ¤ëŠ” ì¡°ê±´)&lt;/li>
&lt;li>&lt;code>GODEBUG=asyncpreemptoff=1&lt;/code> - Go 1.14ë¶€í„° ì ìš©ëœ Asynchronous preemptive schedulingì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì˜µì…˜&lt;/li>
&lt;/ul>
&lt;p>ì´ ê²½ìš° Go ë²„ì „ì´ 1.14 ì´ìƒì´ë¼ë©´ FooëŠ” ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Go ë²„ì „ &amp;gt;= 1.14ì¸ ê²½ìš° async preemptionìœ¼ë¡œ ì¸í•´ Deadlock ë°œìƒ X&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ &lt;span class="nv">GOMAXPROCS&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> go run main.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">No Deadlock. ë‚˜ë„ ì‹¤í–‰ë  ìˆ˜ ìˆì–´!
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>í•˜ì§€ë§Œ asyncpreemptoff ì˜µì…˜ì„ ìƒëµí•˜ë©´ ê¸°ë³¸ì ìœ¼ë¡œ ì„ ì í˜• ìŠ¤ì¼€ì¥´ë§ì´ ì§€ì›ë˜ë¯€ë¡œ ì´ ê²½ìš°ì—” Deadlockì´ ë°œìƒí•˜ì§€ ì•Šê³  Foo() í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ &amp;ldquo;No Deadlock. ë‚˜ë„ ì‹¤í–‰ë  ìˆ˜ ìˆì–´!&amp;rdquo; ë¼ëŠ” Stdoutì„ í†µí•´ ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p>
&lt;h4 id="pprofë¥¼-ì´ìš©í•œ-goroutine-schedule-ì‹œê°í™”">pprofë¥¼ ì´ìš©í•œ goroutine schedule ì‹œê°í™”&lt;/h4>
&lt;p>í•˜ì§€ë§Œ ì •ë§ë¡œ async preemptionì´ ë™ì‘í–ˆê¸° ë•Œë¬¸ì— ë°ë“œë½ì— ë¹ ì§€ì§€ ì•Šì€ ê²ƒì¸ì§€ ë‹¤ë¥¸ ì´ìœ  ë•Œë¬¸ì¸ì§€ëŠ” ê·¸ë‹¥ ì§ê´€ì ìœ¼ë¡œ ì™€ë‹¿ì§€ ì•ŠëŠ”ë‹¤. ê·¸ë˜ì„œ ëª‡ëª‡ ì™¸êµ­ ë¸”ë¡œê·¸ì˜ ê¸€ì—ì„œ ë´¤ë˜ &lt;code>pprof&lt;/code>ë¼ëŠ” ë„êµ¬ë¥¼ ì‚¬ìš©í•´ë´¤ê³ , ì²˜ìŒì—” ì‚¬ìš©ë²•ì´ ë‹¤ì†Œ ì–´ë ¤ì› ì§€ë§Œ ì¡°ê¸ˆ ìµìˆ™í•´ì§€ë‹ˆ ë„ˆë¬´ë‚˜ë„ í¸ë¦¬í–ˆë‹¤.
&lt;code>pprof&lt;/code>ëŠ” &lt;code>net/http&lt;/code> íŒ¨í‚¤ì§€ í•˜ìœ„ì— ì¡´ì¬í•˜ê³ , Goroutine scheduling, syscall log, CPU ì‚¬ìš© ë“±ì„ ì‹œê°í™”í•´ì„œ ë³´ì—¬ì£¼ëŠ” ê°„í¸í•œ ë””ë²„ê¹… ë„êµ¬ì´ë‹¤.
ìš”ì²­ì„ ë‚ ë¦¬ë©´ ìš”ì²­ ì´í›„ Nì´ˆ ê°„ì˜ goroutine schedulingì— ëŒ€í•œ ì •ë³´ë¥¼ ê¸°ë¡í•´ ë³´ì—¬ì£¼ëŠ” ê¸°ëŠ¥ì„ ì´ìš©í•´ë³´ì•˜ë‹¤.&lt;/p>
&lt;p>&lt;img src="https://umi0410.github.io/blog/golang/go-deadlock/pprof-debugging-1.png"
width="547"
height="502"
srcset="https://umi0410.github.io/blog/golang/go-deadlock/pprof-debugging-1_hu27a13bf8dcdafb0aaff224765e3a83ab_59369_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/golang/go-deadlock/pprof-debugging-1_hu27a13bf8dcdafb0aaff224765e3a83ab_59369_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="pprof-debugging-1.png"
class="gallery-image"
data-flex-grow="108"
data-flex-basis="261px"
>&lt;/p>
&lt;p>End Stack Traceë¥¼ í†µí•´ ì–´ë–¤ ì‘ì—…ìœ¼ë¡œ ì¸í•´ goroutineì´ ì ì‹œ ì¤‘ë‹¨ë˜ê³  CPUë¥¼ ë‹¤ë¥¸ goroutineì—ê²Œ ì–‘ë³´í•˜ê²Œ ë˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤. ë†€ëê²Œë„ dummyì— ëŒ€í•œ ë¬´í•œ ë£¨í”„ ì§„í–‰ ë„ì¤‘ ì²˜ìŒìœ¼ë¡œ &lt;strong>async preemptionì´ ë°œìƒí•œ ë’¤ ì´ì–´ì„œ Foo í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ëŠ” goroutineì´ CPUë¥¼ ì ìœ &lt;/strong>í•˜ê²Œ ëœë‹¤ëŠ” ê²ƒì„ ì‹œê°ì ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p>
&lt;p>Wall Durationì€ í•´ë‹¹ ê³ ë£¨í‹´ ë¸”ëŸ­ì„ ìˆ˜í–‰í•œ ì‹œê°„ìœ¼ë¡œ ë³´ì—¬ì§€ê³  ì•½ 10msë¥¼ ê¸°ì¤€ìœ¼ë¡œ preemptiveí•˜ê²Œ switchê°€ ì¼ì–´ë‚  ìˆ˜ ìˆë‹¤ëŠ” ì—¬ëŸ¬ ë¸”ë¡œê·¸ì˜ ê¸€ë“¤ê³¼ ìœ ì‚¬í•˜ê²Œ 15,021,904ns, ì¦‰ ì•½ 15msë§Œì— asyncPreemptë¼ëŠ” ì´ë²¤íŠ¸ë¡œ ì¸í•´ goroutine switchê°€ ì¼ì–´ë‚¬ë‹¤.
cooperative ìŠ¤ì¼€ì¥´ë§ë§Œì„ ì´ìš©í•˜ëŠ” ê²½ìš°ì—ëŠ” ë°ë“œë½ìœ¼ë¡œ ì¸í•´ í•œ ë²ˆë„ Fooë¥¼ ì‹¤í–‰í•˜ëŠ” goroutineì´ ìˆ˜í–‰ë˜ì§€ ëª»í•œë‹¤ëŠ” ê²ƒë„ ì‹œê°í™”í•´ì„œ ì œê³µí•´ë³´ê³ ì‹¶ì—ˆì§€ë§Œ, ë‹¹ì—°í•˜ê²Œë„ ê·¸ ë°ë“œë½ìœ¼ë¡œ ì¸í•´ ì¼ì • ê¸°ê°„ë™ì•ˆ runtimeì„ ê´€ì°°í•œ ë’¤ ê·¸ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” goroutine ì¡°ì°¨ ì‹¤í–‰í•  ìˆ˜ ì—†ì–´ ê·¸ ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ì—†ì—ˆë‹¤!&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-dockerfile" data-lang="dockerfile">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Goì˜ ë²„ì „ì„ 1.13ìœ¼ë¡œ ì œí•œí•´ë³¸ë‹¤.&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">FROM&lt;/span>&lt;span class="s"> golang:1.13&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">WORKDIR&lt;/span>&lt;span class="s"> /app&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">COPY&lt;/span> . .&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">ENTRYPOINT&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;go&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">CMD&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;run&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;main.go&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ docker build . -t tmp &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> docker run -it --rm -e &lt;span class="nv">GOMAXPROCS&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> tmp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ê·¸ë ‡ë‹¤ë©´ ì •ë§ Goì˜ 1.14 ì´ì „ ë²„ì „ì€ Preemptiveí•œ ë°©ì‹ì´ ì•„ë‹ˆë¼ Cooperativeí•œ ë°©ì‹ì„ ì´ìš©í•˜ê³ , ì´ ê²½ìš° ë°ë“œë½ì´ ë°œìƒí• ê¹Œ? ì´ì „ ê¸€ë“¤ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ Dockerë¥¼ ì´ìš©í•´ ê°„í¸í•˜ê²Œ Goì˜ ë²„ì „ì„ ë³€ê²½í•´ì„œ ì‹¤í–‰í•´ë³´ì. golang:1.13 ì´ë¯¸ì§€ë¥¼ ì´ìš©í•´ë³´ì•˜ë‹¤.&lt;/p>
&lt;p>1.13 ë²„ì „ ì´í•˜ë¡œëŠ” &lt;code>GODEBUG=asyncpreemptoff=1&lt;/code> ì˜µì…˜ì„ ì„¤ì •í•˜ì§€ ì•Šì•„ë„ cooperativeí•œ ìŠ¤ì¼€ì¥´ë§ë§Œì„ ì§€ì›í•˜ë¯€ë¡œ í”„ë¡œê·¸ë¨ì´ ë°ë“œë½ ìƒíƒœì— ë¹ ì ¸ Foo()ê°€ ì‹¤í–‰ë˜ì§€ ëª»í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.&lt;/p>
&lt;h4 id="ì°¸ê³ -ì‚¬í•­-gomaxprocs1-ì˜µì…˜ì„-ì£¼ëŠ”-ì´ìœ ëŠ”">ì°¸ê³  ì‚¬í•­) GOMAXPROCS=1 ì˜µì…˜ì„ ì£¼ëŠ” ì´ìœ ëŠ”?&lt;/h4>
&lt;blockquote>
&lt;p>The GOMAXPROCS variable limits the number of operating system threads that can execute user-level Go code simultaneously. - go rutime package ë¬¸ì„œ -&lt;/p>
&lt;/blockquote>
&lt;p>&lt;code>GOMAXPROCS&lt;/code>ëŠ” &lt;strong>Go í”„ë¡œê·¸ë¨ì´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìµœëŒ€ì˜ OS ìŠ¤ë ˆë“œ ê°œìˆ˜&lt;/strong>ë¥¼ ì˜ë¯¸í•œë‹¤. ë§Œì•½ OS ìŠ¤ë ˆë“œê°€ 2ê°œ ì´ìƒìœ¼ë¡œ ìƒì„±ëœë‹¤ë©´ ìœ„ì˜ ê²½ìš° main goroutineê³¼ í•¨ìˆ˜ Fooë¥¼ ì‹¤í–‰í•˜ëŠ” Goroutineì´ ì„œë¡œ ë‹¤ë¥¸ ìŠ¤ë ˆë“œì— ë°°ì¹˜ë  ê²ƒì´ê³ , ê·¸ ê²½ìš° &lt;strong>Goì˜ ìŠ¤ì¼€ì¥´ëŸ¬ê°€ Cooperativeí•œ ë°©ì‹ì„ ì´ìš©í•œë‹¤í•´ë„ OS ìŠ¤ì¼€ì¥´ëŸ¬ê°€ Preemptiveí•˜ê²Œ ê°ê°ì˜ Go ìŠ¤ë ˆë“œ(OS Level)ë¥¼ ìŠ¤ì¼€ì¥´&lt;/strong>í•˜ê¸° ë•Œë¬¸ì— Foo goroutineë„ ì‹¤í–‰ë  ìˆ˜ ìˆëŠ” ê¸°íšŒê°€ ì£¼ì–´ì§„ë‹¤. ì´ ê²½ìš°ì—ëŠ” ë°ë“œë½ì´ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ &lt;strong>ìš°ë¦¬ëŠ” ë°ë“œë½ì„ ë°œìƒì‹œì¼œë³´ê³ ì GOMAXPROCSë¥¼ 1ë¡œ ì œí•œ&lt;/strong>í•œë‹¤.&lt;/p>
&lt;h2 id="ë§ˆì¹˜ë©°">ë§ˆì¹˜ë©°&lt;/h2>
&lt;p>Goë¥¼ ì´ìš©í•´ ì‹¤ì œ í”„ë¡œê·¸ë¨ì„ ì§œë³´ë©° ì–´ë–¤ ê²½ìš°ì— Deadlockì´ ë°œìƒí•  ìˆ˜ ìˆëŠ”ì§€ ì•Œì•„ë³´ì•˜ë‹¤. ì´ ê¸€ì—ì„  ì„œë¡œ ê°™ì€ Mutexë¥¼ ì´ìš©í•˜ëŠ” ê²½ìš°ë¥¼ ì˜ˆì‹œë¡œ ë“¤ì—ˆì§€ë§Œ ì„œë¡œ ë‹¤ë¥¸ ë‘ Mutexë¥¼ í†µí•´ ì„œë¡œì˜ ì‘ì—…ì„ ê¸°ë‹¤ë¦¬ëŠ” ê²½ìš°ì˜ Deadlockë„ ê±°ì˜ ìœ ì‚¬í•˜ë©° ì¼ë°˜ì ìœ¼ë¡œ ë§í•˜ëŠ” Deadlockì— ê°€ì¥ ê°€ê¹Œìš´ ê²½ìš°ì´ê¸´í•  ê²ƒì´ë‹¤. ê·¸ë˜ë„ Goë¡œ ê°œë°œì„ í•˜ë©´ì„œ ì•„ì§ ì„œë¡œ ë‹¤ë¥¸ Mutexë¥¼ ì´ìš©í–ˆë˜ ê²½ìš°ê°€ ë”±íˆ ì—†ì—ˆê¸°ì— ê°™ì€ Mutexì— ì¤‘ì²©ìœ¼ë¡œ Lockì„ ê±¸ì—ˆë˜ ê²½ìš°ë¥¼ ì˜ˆì‹œë¡œ ë“¤ì–´ë³´ì•˜ë‹¤.&lt;/p>
&lt;p>&lt;code>Channel&lt;/code>ì´ë‚˜ &lt;code>Cooperative scheduling&lt;/code>ì˜ ê²½ìš°ëŠ” ì–´ëŠ ì •ë„ Goì— í•œì •ì ì¸ ë‚´ìš©ì´ê³  íŠ¹íˆë‚˜ ìŠ¤ì¼€ì¥´ë§ì€ ëŸ°íƒ€ì„ì´ë‚˜ ê³ ë£¨í‹´ ìŠ¤ì¼€ì¥´ ë°©ì‹ê¹Œì§€ ë‚´ë ¤ê°€ëŠ” ì„¸ë¶€ì ì¸ ë‚´ìš©ì´ê¸´í•˜ì§€ë§Œ Goì— íŠ¹íˆ ê´€ì‹¬ ìˆìœ¼ì‹  ë¶„ë“¤ê»˜ëŠ” ë‚˜ë¦„ ì¬ë¯¸ìˆëŠ” ë‚´ìš©ì´ ë˜ì§€ ì•Šì•˜ì„ê¹Œì‹¶ë‹¤.&lt;/p>
&lt;p>ê·¸ë¦¬ê³  ì´ì „ ê¸€ì—ì„  &lt;code>testing&lt;/code>ì˜ &lt;code>benchmark&lt;/code>ë¥¼ ì´ìš©í•´ ì¢€ ë” ì •í™•í•˜ê³  í¸ë¦¬í•œ ë²¤ì¹˜ë§ˆí‚¹ì„ ë„ì…í•´ë´¤ë‹¤ëŠ” ì ê³¼
ì´ë²ˆì—” ì¶”ê°€ì ìœ¼ë¡œ &lt;code>pprof&lt;/code>ë¥¼ ì´ìš©í•´ &lt;code>goroutine ìŠ¤ì¼€ì¥´ë§&lt;/code>ì„ ì‹œê°í™”í•´ë´¤ë‹¤ëŠ” ì ì—ì„œ Golangìœ¼ë¡œ ì ìš©í•´ë³´ëŠ” ì»´í“¨í„° ì‚¬ì´ì–¸ìŠ¤ë¼ëŠ” ì´ ì‹œë¦¬ì¦ˆë¥¼ ì²˜ìŒ ì‹œì‘í–ˆì„ ë•Œì— ë¹„í•´ ì»´í“¨í„° ì‚¬ì´ì–¸ìŠ¤ ë¿ë§Œ ì•„ë‹ˆë¼ ë””ë²„ê¹… ê¸°ìˆ ì´ë‚˜ ìŠ¤ì¼€ì¥´ë§ ë°©ì‹ ë“±ë“± ë‹¤ì–‘í•œ ì£¼ì œì— ëŒ€í•´ì„œë„ ê³µë¶€í•´ë³´ê³  ì ìš©í•´ë³¼ ìˆ˜ ìˆì—ˆë˜ ê²ƒ ê°™ì•„ ë¿Œë“¯í•˜ë‹¤.
ë‹¤ì†Œ Goë§Œì˜ ì§€ì—½ì ì¸ ë‚´ìš©ìœ¼ë¡œ ì—¬ê²¨ì§ˆ ìˆ˜ë„ ìˆê² ì§€ë§Œ ì¶”í›„ì— ë‚´ê°€ ì–´ë–¤ ì–¸ì–´ë¥¼ ê³µë¶€í•˜ë“  ì–´ë–¤ ê¸°ìˆ ì„ ê³µë¶€í•˜ë“  ì´ëŸ¬í•œ ê²½í—˜ë“¤ì„ ì–¼ë§ˆë“ ì§€ ë…¹ì—¬ë‚¼ ìˆ˜ ìˆì„ ê²ƒì´ë¼ ìƒê°í•œë‹¤!!&lt;/p>
&lt;h2 id="ì°¸ê³ ">ì°¸ê³ &lt;/h2>
&lt;ul>
&lt;li>
&lt;p>Go: How are Deadlocks Triggered? &lt;a class="link" href="https://medium.com/a-journey-with-go/go-how-are-deadlocks-triggered-2305504ac019" target="_blank" rel="noopener"
>https://medium.com/a-journey-with-go/go-how-are-deadlocks-triggered-2305504ac019&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Go: What Does a Goroutine Switch Actually Involve? &lt;a class="link" href="https://medium.com/a-journey-with-go/go-what-does-a-goroutine-switch-actually-involve-394c202dddb7" target="_blank" rel="noopener"
>https://medium.com/a-journey-with-go/go-what-does-a-goroutine-switch-actually-involve-394c202dddb7&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Goroutine and Preemption &lt;a class="link" href="https://medium.com/a-journey-with-go/go-goroutine-and-preemption-d6bc2aa2f4b7" target="_blank" rel="noopener"
>https://medium.com/a-journey-with-go/go-goroutine-and-preemption-d6bc2aa2f4b7&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Go: Asynchronous Preemption &lt;a class="link" href="https://medium.com/a-journey-with-go/go-asynchronous-preemption-b5194227371c" target="_blank" rel="noopener"
>https://medium.com/a-journey-with-go/go-asynchronous-preemption-b5194227371c&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ë°ë“œë½ ì •ì˜&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://namu.wiki/w/%EB%8D%B0%EB%93%9C%EB%9D%BD?from=Deadlock" target="_blank" rel="noopener"
>https://namu.wiki/w/%EB%8D%B0%EB%93%9C%EB%9D%BD?from=Deadlock&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://ko.wikipedia.org/wiki/%EA%B5%90%EC%B0%A9_%EC%83%81%ED%83%9C" target="_blank" rel="noopener"
>https://ko.wikipedia.org/wiki/%EA%B5%90%EC%B0%A9_%EC%83%81%ED%83%9C&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Go runtime documentation &lt;a class="link" href="https://golang.org/pkg/runtime/" target="_blank" rel="noopener"
>https://golang.org/pkg/runtime/&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul></description></item><item><title>Go ì–¸ì–´ë¡œ ì ìš©í•´ë³´ëŠ” Computer Science - Cache</title><link>https://umi0410.github.io/blog/golang/go-cpu-cache/</link><pubDate>Wed, 27 Jan 2021 15:25:54 +0900</pubDate><guid>https://umi0410.github.io/blog/golang/go-cpu-cache/</guid><description>&lt;h2 id="ì‹œì‘í•˜ë©°">ì‹œì‘í•˜ë©°&lt;/h2>
&lt;p>ì €ë²ˆ í•™ê¸°ì— &lt;code>ì»´í“¨í„° êµ¬ì¡°&lt;/code>ë¥¼ ìˆ˜ê°•í•˜ë©´ì„œ ê°„ê³¼í•˜ê³  ìˆë˜ ë¡œìš° ë ˆë²¨ì˜ ì§€ì‹ì—ë„ í¥ë¯¸ê°€ ìƒê²¼ì—ˆë‹¤. ê·¸ ì¤‘ CPUì™€ Memory, Diskì˜ ì—­í• ì— ëŒ€í•´ ì•Œì•„ë³¼ ìˆ˜ ìˆì—ˆê³  &lt;strong>ìºì‹œëŠ” CPUì™€ Memory ì‚¬ì´ì— ìœ„ì¹˜í•´ ë©”ëª¨ë¦¬ ëŒ€ì‹  ë¹ ë¥´ê²Œ CPUì—ê²Œ ë°ì´í„°ë¥¼ ì œê³µí•˜ëŠ” ë…€ì„&lt;/strong>ì´ë¼ê³  ë°°ì› ë‹¤.&lt;/p>
&lt;p>ì´ì „ì—ëŠ” ì£¼ë¡œ ìºì‹œë¼ê³  í•˜ë©´ ì£¼ë¡œ CDNê³¼ ê°™ì€ ë„¤íŠ¸ì›Œí¬ì—ì„œ ì“°ì´ëŠ” ìºì‹œë“¤ë°–ì— ëª°ëë‹¤. ê·¸ë ‡ë‹¤ë³´ë‹ˆ L1 ìºì‹œ, L2 ìºì‹œ ê°™ì€ ì–˜ê¸°ë¥¼ ë“¤ìœ¼ë©´ OSI 7ê³„ì¸µê³¼ ì—°ê´€ ì§€ì–´ &amp;lsquo;ìŒ..? L2 ìºì‹œëŠ” ìŠ¤ìœ„ì¹˜ì—ì„œ ì“°ëŠ” ìºì‹œì¸ê°€..?&amp;rsquo; ë¼ëŠ” ìƒìƒì„ í•˜ê³¤í–ˆë‹¤.&lt;/p>
&lt;p>ì´ë²ˆì—ëŠ” Goë¥¼ í†µí•´ ë°°ì—´ì— ì—¬ëŸ¬ ì°¨ë¡€ ì ‘ê·¼í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ë§Œë“¤ì–´ë³´ê³  ë²¤ì¹˜ë§ˆí‚¹ì„ í†µí•´ ìºì‹œë¼ëŠ” ë…€ì„ì´ ì–´ë–¤ íš¨ê³¼ë¥¼ ê°€ì ¸ë‹¤ì£¼ëŠ”ì§€ ì§ì ‘ í™•ì¸í•´ë³´ë ¤í•œë‹¤.&lt;/p>
&lt;h2 id="ìºì‹œë€">ìºì‹œë€&lt;/h2>
&lt;p>ìºì‹œëŠ” ì•„ì£¼ ë‹¤ì–‘í•œ ë¬¸ë§¥ì—ì„œ ì‚¬ìš©ëœë‹¤. ê³µí†µì ìœ¼ë¡œ &amp;ldquo;ì‚¬ìš©ìê°€ ìš”ì²­í•  ê²ƒ ê°™ì€ ë°ì´í„°ë¥¼ ì‘ê³  ë¹ ë¥¸ ì €ì¥ì†Œì— ì €ì¥í•´ë†“ìŒìœ¼ë¡œì¨ ì¢€ ë” ë¹¨ë¦¬ í•´ë‹¹ ë°ì´í„°ë¥¼ ì œê³µí•œë‹¤&amp;quot;ëŠ” ëª©ì ì„ ê°–ëŠ”ë‹¤. CDN, DB, REST API, Memory, CPU ë“±ë“± ë‹¤ì–‘í•œ ê³³ì—ì„œ ì“°ì¼ ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤. ê·¸ ì¤‘ ì´ë²ˆì—ëŠ” &lt;strong>CPUì™€ ë©”ëª¨ë¦¬ ì‚¬ì´ì˜ ìºì‹œ&lt;/strong>ì— ëŒ€í•´ ì•Œì•„ë³´ê² ë‹¤.&lt;/p>
&lt;p>CPUì™€ ë©”ëª¨ë¦¬ ì‚¬ì´ì˜ ìºì‹œëŠ” &lt;strong>ë©”ëª¨ë¦¬ì˜ ë°ì´í„°ë¥¼ ì–»ê¸° ìœ„í•´ ë©”ëª¨ë¦¬ì— ì§ì ‘ ì ‘ê·¼í•˜ì§€ ì•Šê³  ìºì‹œë¼ëŠ” ë¹ ë¥¸ ì €ì¥ì†Œë¥¼ ì´ìš©í•´ í•´ë‹¹ ë°ì´í„°ë¥¼ ì–»ê²Œë”&lt;/strong>í•´ì¤€ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë³€ìˆ˜ a=10 ì´ë¼ëŠ” ë°ì´í„°ê°€ ë©”ëª¨ë¦¬ì— ì¡´ì¬í•œë‹¤í•´ë„ aì˜ ê°’ì„ ì–»ê¸° ìœ„í•´ ë©”ëª¨ë¦¬ì— ì§ì ‘ ì ‘ê·¼í•˜ê¸° ë³´ë‹¤ëŠ” ê°€ê¹Œìš°ë©´ì„œ ë¹ ë¥´ê²Œ ì´ìš© ê°€ëŠ¥í•œ ìºì‹œì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ë„ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ì‚¬ì‹¤ ìºì‹œì˜ ê°œë…ì ì¸ ì¸¡ë©´ì—ì„œ ë³´ë©´ ë©”ëª¨ë¦¬ ë˜í•œ ë””ìŠ¤í¬ ëŒ€ì‹  ë¹ ë¥´ê²Œ ê°’ì„ ì „ë‹¬í•´ì£¼ê¸° ìœ„í•œ ê²½ìš°ì¼ ìˆ˜ ìˆìœ¼ë‹ˆ ìºì‹œ ê¸°ëŠ¥ì„ í•œë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  CPUì™€ ë©”ëª¨ë¦¬ ì‚¬ì´ì— ì •ë§ ìºì‹œë¼ëŠ” ì´ë¦„ì„ ê°–ëŠ” ë…€ì„ë“¤ì€ í”„ë¡œì„¸ì„œ ì†ì— ìˆëŠ” L1 ìºì‹œ, í”„ë¡œì„¸ì„œ ì˜†ì— ìˆëŠ” L2 ìºì‹œ, í”„ë¡œì„¸ì„œë“¤ì´ ê³µìœ í•˜ëŠ” L3 ìºì‹œê°€ ìˆê¸´ í•˜ì§€ë§Œ ì´ëŠ” ì‹œëŒ€ê°€ ì§€ë‚˜ë©´ì„œ ì–¼ë§ˆë“ ì§€ ë³€í•  ìˆ˜ ìˆëŠ” ë‚´ìš©ë“¤ì´ê¸° ë•Œë¬¸ì— ì–´ë–¤ ìºì‹œê°€ ì–´ë””ì— ìˆê³  ëˆ„êµ¬ë‘ ëˆ„ê°€ ê³µìœ í•˜ëŠ”ì§€ì™€ ê°™ì€ ì„¸ë¶€ ë‚´ìš©ì€ í¬ê²Œ ì¤‘ìš”í•˜ì§„ ì•Šì„ ê²ƒ ê°™ë‹¤.&lt;/p>
&lt;p>ë¬¼ë¦¬ì ì¸ í¬ê¸°ë‚˜ ê±°ë¦¬ëŠ” ì†ë„ì™€ ë°˜ë¹„ë¡€í•  ìˆ˜ ë°–ì— ì—†ë‹¤. ê±°ë¦¬ê°€ ë©€ë©´ ì •ë³´ê°€ ì „ë‹¬ë˜ëŠ” ì†ë„ê°€ ëŠë ¤ì§€ê³  í¬ê¸°ê°€ í¬ë©´ ì—¬ëŸ¬ Muxë‚˜ Gateë¥¼ ì´ìš©í•œë‹¤ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— ëŠë ¤ì§„ë‹¤. ê·¸ë ‡ê¸°ë•Œë¬¸ì— ìºì‹œëŠ” ì‘ê³  ê°€ê¹Œì›Œì•¼í•œë‹¤. ë°ì´í„°ë¥¼ ìš”ì²­í•˜ëŠ” ë…€ì„ì€ CPUì´ê¸° ë•Œë¬¸ì— ìºì‹œëŠ” CPU ì† í˜¹ì€ ê·¸ ê·¼ì²˜ì— ìœ„ì¹˜í•œë‹¤. ë˜í•œ ì‘ì•„ì•¼í•˜ê¸°ë•Œë¬¸ì— ëª¨ë“  ì •ë³´ë¥¼ ë‹´ì„ ìˆ˜ ì—†ê³ , ì‚¬ìš©ìê°€ ìš”ì²­í• ë²•í•œ ë°ì´í„°ë§Œì„ ë‹´ì•„ì•¼í•œë‹¤. ì´ ë•Œ ì–´ë–»ê²Œ ì‚¬ìš©ìê°€ ìš”ì²­í•  ë²•í•œ ë°ì´í„°ë¥¼ ì •í• ê¹Œ? ì´ëŠ” &lt;code>ê³µê°„ ì§€ì—­ì„±&lt;/code>ê³¼ &lt;code>ì‹œê°„ ì§€ì—­ì„±&lt;/code>ì´ë¼ëŠ” ì¤‘ìš”í•œ ë‘ ê°€ì§€ ì„±ì§ˆì„ ê¸°ë°˜ìœ¼ë¡œ í•œë‹¤.&lt;/p>
&lt;p>ì´ì™¸ì—ë„ íƒœê·¸ë‚˜ ì¶©ëŒ ê°™ì€ ê°œë…ë“¤ì´ ìˆê¸´í•˜ì§€ë§Œ ì‹¤ì œë¡œ ë²¤ì¹˜ë§ˆí‚¹í•´ë³´ê¸°ë„ ì‰½ì§€ ì•Šê³  ë‹¤ì†Œ ì§€ì—½ì ì¸ ë‚´ìš©ì´ë¼ ê°„ë‹¨íˆë§Œ ì •ë¦¬í•´ë³´ë©´ íƒœê·¸ ì—†ì´ ì£¼ì†Œê°’ì„ ëª¨ë“ˆëŸ¬(ë‚˜ë¨¸ì§€)ì—°ì‚°í•´ì„œ cache line indexë¥¼ ê²°ì •í•˜ê³  ê·¸ê²ƒë§Œì„ ì´ìš©í•´ ë°ì´í„°ë¥¼ ì €ì¥í•˜ë©´ í•œ line ë‚´ì— ì €ì¥í•  ì›Œë“œ(Word)ì— ëŒ€í•œ ì¶©ëŒì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤. cache lineì´ 20ê°œì¸ ìºì‹œëŠ” 0ë²ˆì§€ì™€ 20ë²ˆì§€ê°€ ê°™ì€ lineì´ë¯€ë¡œ ì¶©ëŒì´ ë°œìƒí•´ ê³„ì†í•´ì„œ ê°™ì€ lineì— ì„œë¡œì˜ ë°ì´í„°ê°€ ë²ˆê°ˆì•„ ì €ì¥ë  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. í•˜ì§€ë§Œ íƒœê·¸ë¥¼ ì´ìš©í•˜ë©´ cache line ìˆ˜ëŠ” ì¤„ì–´ë“¤ë”ë¼ë„ í•œ lineë‚´ì— ì—¬ëŸ¬ íƒœê·¸ì˜ ì •ë³´ë¥¼ ì €ì¥í•  ìˆ˜ ìˆê²Œë˜ì–´ cache lineì´ 10ê°œì¸ cacheì˜ í•œ lineì— 0ë²ˆì§€ì™€ 20ë²ˆì§€ì˜ ë°ì´í„°ê°€ ë‹¤ë¥¸ íƒœê·¸ë¡œ ì €ì¥ë˜ì–´ ë¶ˆí•„ìš”í•œ ì¶©ëŒì„ ë°©ì§€í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ìˆë‹¤. ê°„ë‹¨íˆ ì„¤ëª…í•˜ê¸°ëŠ” í˜ë“  ë‚´ìš©ì´ë¼ ì¢€ ë” ìì„¸íˆ ì•Œê³ ì‹¶ë‹¤ë©´ &lt;code>Direct mapped cache&lt;/code>ë‚˜ &lt;code>Fully associative cache&lt;/code> ë“±ìœ¼ë¡œ ê²€ìƒ‰í•´ë³´ê¸°ë¥¼ ê¶Œì¥í•œë‹¤.&lt;/p>
&lt;h2 id="spatial-locality">Spatial locality&lt;/h2>
&lt;p>&lt;code>Spatial locality(ê³µê°„ ì§€ì—­ì„±)&lt;/code>ì´ë€ ì§€ê¸ˆ &lt;strong>ìš”ì²­ ë°›ì€ ë°ì´í„°ì™€&lt;/strong> &lt;strong>ê°€ê¹Œìš´ ê³³ì— ìœ„ì¹˜í•œ ë°ì´í„°ëŠ” ë†’ì€ í™•ë¥ ë¡œ ë‹¤ì‹œ ìš”ì²­ ë°›ê²Œ ëœë‹¤&lt;/strong>ëŠ” ì„±ì§ˆì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ 100ë²ˆì§€ì˜ a=10ê³¼ 108ë²ˆì§€ì˜ b=20ì´ ì¡´ì¬í•  ë•Œ ë³€ìˆ˜ aë¥¼ ìš”ì²­í•˜ë©´ ì´í›„ aì™€ ê°€ê¹Œìš´ ì£¼ì†Œì— ì €ì¥ëœ b ë˜í•œ ë†’ì€ í™•ë¥ ë¡œ ìš”ì²­ëœë‹¤ëŠ” ê²ƒì´ë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">a&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">20&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">c&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">30&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;a: %p\nb: %p\nc: %p\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">Output:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">a: 0xc000100010
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">b: 0xc000100018
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">c: 0xc000100020
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>a, b, cì˜ í¬ê¸°ëŠ” 8ë°”ì´íŠ¸ë¡œ ì£¼ì†Œê°’ ë˜í•œ 8ë°”ì´íŠ¸ê°€ ì°¨ì´ë‚œë‹¤. (16ì§„ë²•ì´ê¸°ì— 20ê³¼ 18ì˜ ì°¨ì´ëŠ” 8ì´ë‹¤.) ì¦‰ ëŒ€ì²´ë¡œ &lt;strong>ë¹„ìŠ·í•œ ì‹œê¸°ì— í• ë‹¹ëœ ë³€ìˆ˜ëŠ” ê·¼ì ‘í•œ ë©”ëª¨ë¦¬ ì£¼ì†Œ&lt;/strong>ë¥¼ ê°–ê²Œ ëœë‹¤. ìš°ë¦¬ëŠ” ë¹„ìŠ·í•œ ì‹œê¸°ì— í• ë‹¹í•œ ë³€ìˆ˜ í˜¹ì€ ì—°ì†ëœ ë°°ì—´ ìš”ì†Œì— ìì£¼ ë¹ ë¥¸ ì‹œì¼ ë‚´ì— ì ‘ê·¼ì„ í•˜ì§€ ë§¨ ìœ„ì—ì„œ ì„ ì–¸í•œ ë³€ìˆ˜ì™€ ì € ë©€ë¦¬ ë§¨ ë°‘ì—ì„œ ì„ ì–¸í•œ ë³€ìˆ˜ë¥¼ ë§ˆêµ¬ì¡ì´ë¡œ ì™”ë‹¤ ê°”ë‹¤ í•˜ë©´ì„œ ì‘ì—…ì„ í•˜ì§€ ì•ŠëŠ” í¸ì´ê¸° ë•Œë¬¸ì— ê³µê°„ ì§€ì—­ì„±ì„ ê·¼ê±°ë¡œí•œ ìºì‹œê°€ íš¨ë ¥ì„ ê°–ê²Œ ëœë‹¤. ë§Œì•½ ê³µê°„ì ìœ¼ë¡œ ë¨¼ ë§¨ ìœ„ì˜ ë³€ìˆ˜ì™€ ë§¨ ì•„ë˜ì˜ ë³€ìˆ˜ë¥¼ ìì£¼ ë²ˆê°ˆì•„ê°€ë©° ì ‘ê·¼í•œë‹¤ë©´ ê·¸ê²ƒì€ ì‹œê°„ì§€ì—­ì„±ì„ ë„ëŠ” ê²½ìš°ì´ë‹¤.&lt;/p>
&lt;h2 id="temporal-locality">Temporal locality&lt;/h2>
&lt;p>&lt;code>Temporal locality(ì‹œê°„ ì§€ì—­ì„±)&lt;/code>ì´ë€ &lt;strong>ìµœê·¼ì— ìš”ì²­í–ˆë˜ ë°ì´í„°ëŠ” ë†’ì€ í™•ë¥ ë¡œ ë‹¤ì‹œ ìš”ì²­ ë°›ê²Œ ëœë‹¤&lt;/strong>ëŠ” ì„±ì§ˆì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ 100ë²ˆì§€ì˜ a=10ê³¼ 9999ë²ˆì§€ì˜ b=20ì€ ì„œë¡œ ì£¼ì†Œì ì¸ ê±°ë¦¬ëŠ” ë©€ì§€ë§Œ ë‘˜ ë‹¤ ìµœê·¼ì— í˜¸ì¶œëë‹¤ë©´ ìºì‹œì— ì ì¬í•˜ê² ë‹¤ëŠ” ê²ƒì´ë‹¤. ìºì‹œëŠ” ì£¼ë¡œ ì§ì‚¬ê°í˜• í˜•íƒœë¡œ ìƒê²¼ìœ¼ë©° &lt;strong>ê°€ë¡œ(í–‰)ëŠ” ì—°ì†ëœ ì£¼ì†Œì˜ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ê³µê°„ ì§€ì—­ì„±, ì„¸ë¡œ(ì—´)ëŠ” ìµœê·¼ì— í˜¸ì¶œëœ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ì‹œê°„ ì§€ì—­ì„±&lt;/strong>ì„ ë‹´ë‹¹í•œë‹¤.&lt;/p>
&lt;h2 id="ë‘-ì§€ì—­ì„±-ë¹„êµ">ë‘ ì§€ì—­ì„± ë¹„êµ&lt;/h2>
&lt;p>12ì¹¸ì˜ ìºì‹œê°€ ìˆë‹¤ê³  ê°€ì •í•˜ì. ê°€ë¡œë¡œ 4ì¹¸ ì„¸ë¡œë¡œ 3ì¹¸ ì¡´ì¬í•œë‹¤ë©´ ê³µê°„/ì‹œê°„ ì§€ì—­ì„±ì˜ ê· í˜•ì´ ì¡íŒ ìºì‹œë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.(ê²½ìš°ì— ë”°ë¼ ë‹¤ë¥´ê² ì§€ë§Œ)&lt;/p>
&lt;p>&lt;img src="https://umi0410.github.io/blog/golang/go-cpu-cache/balanced-cache.png"
width="620"
height="107"
srcset="https://umi0410.github.io/blog/golang/go-cpu-cache/balanced-cache_hu49d8d624edd0378535d64f9a5c47e767_8216_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/golang/go-cpu-cache/balanced-cache_hu49d8d624edd0378535d64f9a5c47e767_8216_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="balanced-cache.png"
class="gallery-image"
data-flex-grow="579"
data-flex-basis="1390px"
>&lt;/p>
&lt;p>ì‹œê°„ ì§€ì—­ì„±ì€ ìµœê·¼ ë¶ˆë¦° ë°ì´í„°ëŠ” ë‹¤ì‹œ ë¶ˆë¦´ í™•ë¥ ì´ ë†’ë‹¤ëŠ” ê²ƒì´ê³  ì´ëŠ” ì—°ì†ëœ ê³µê°„ì´ ì•„ë‹Œ ë‹¤ì–‘í•œ ê³µê°„(ì£¼ì†Œ)ì˜ ë°ì´í„°ë¥¼ ìºì‹œì— ì €ì¥í•œë‹¤ëŠ” ë§ì´ê¸°ë„ í•˜ë‹¤. 0ë²ˆì§€ ë¶€ê·¼, 16ë²ˆì§€ ë¶€ê·¼, 24ë²ˆì§€ ë¶€ê·¼ì˜ ë‹¤ì–‘í•œ ê³µê°„ì˜ ë°ì´í„°ë¥¼ ì €ì¥í•  ìˆ˜ ìˆìœ¼ë©´ì„œ ê·¸ ë…€ì„ë“¤ê°„ì˜ ì£¼ë³€ ë°ì´í„°ë„ ì œê³µí•˜ëŠ” ê³µê°„ì§€ì—­ì„±ë„ ë§Œì¡±í•œë‹¤.&lt;/p>
&lt;p>ë‘ ê°€ì§€ ì§€ì—­ì„±ì— ì˜í•´ ë‹¤ì–‘í•œ ìºì‹œë“¤ì´ ë°ì´í„°ë¥¼ ì ì¬í•˜ê³  ì œê³µí•œë‹¤. ìš”ì ì€ ìºì‹œëŠ” ë¹ ë¥´ê²Œ ë™ì‘í•´ì•¼í•˜ê³  ê·¸ëŸ¬ê¸° ìœ„í•´ì„  í¬ê¸°ê°€ ì‘ê³  ê°€ê¹Œì›Œì•¼í•˜ë©° í¬ê¸°ê°€ ì‘ê¸° ë•Œë¬¸ì— ëª¨ë“  ë°ì´í„°ë¥¼ ë‹´ì„ ìˆ˜ ì—†ìœ¼ë‹ˆ ì•Œì§œ ë°ì´í„°ë§Œì„ ë‹´ì•„ì•¼í•˜ëŠ”ë° ê·¸ ì•Œì§œëŠ” ì§€ì—­ì„±ì„ ê¸°ë°˜ìœ¼ë¡œ ì„ ë³„ëœë‹¤ëŠ” ê²ƒì´ë‹¤. í¬ê¸°ê°€ í•œì •ì ì´ê¸° ë•Œë¬¸ì— í•œ ì§€ì—­ì„±ì„ í‚¤ìš°ë©´ í•œ ì§€ì—­ì„±ì€ ì‘ì•„ì§ˆ ìˆ˜ë°–ì— ì—†ë‹¤.&lt;/p>
&lt;h3 id="ê³µê°„-ì§€ì—­ì„±ì—-ì¹˜ìš°ì¹œ-ìºì‹œ-êµ¬ì¡°">ê³µê°„ ì§€ì—­ì„±ì— ì¹˜ìš°ì¹œ ìºì‹œ êµ¬ì¡°&lt;/h3>
&lt;p>&lt;img src="https://umi0410.github.io/blog/golang/go-cpu-cache/spatial-locality-biased-cache.png"
width="930"
height="110"
srcset="https://umi0410.github.io/blog/golang/go-cpu-cache/spatial-locality-biased-cache_hu038761de6193f1262a5c02c2aef3a97f_10262_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/golang/go-cpu-cache/spatial-locality-biased-cache_hu038761de6193f1262a5c02c2aef3a97f_10262_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="spatial-locality-biased-cache.png"
class="gallery-image"
data-flex-grow="845"
data-flex-basis="2029px"
>&lt;/p>
&lt;p>í•œì •ëœ í¬ê¸°ì˜ ìºì‹œ ì†ì—ì„œ ê³µê°„ì§€ì—­ì„±ì„ ê·¹ëŒ€í™”ì‹œì¼œë²„ë¦¬ë©´ ë‹¹ì—°íˆ ì¸ì ‘í•œ ê³µê°„ì˜ ìë£Œë§Œ ì´ìš©í•  ìˆ˜ ìˆê³ , ìµœê·¼ì— ë¶ˆë¦° ë°ì´í„°ë“¤ì€ ì•ˆì¤‘ì—ë„ ì—†ê³  ì¸ì ‘í•œ ê³µê°„ì˜ ë°ì´í„°ë§Œì„ ì €ì¥í•˜ê²Œ ëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë‹¤ìŒê³¼ ê°™ì€ ì‹œê°„ ì§€ì—­ì„±ì´ í•„ìš”í•œ ê²½ìš°ì— ì œëŒ€ë¡œ ê¸°ëŠ¥ì„ í•  ìˆ˜ ì—†ë‹¤.&lt;/p>
&lt;ol>
&lt;li>0~11ë²ˆì§€ ì‚¬ì´ì˜ ë°ì´í„°ê°€ í•œ ë²ˆ ì ‘ê·¼ â‡’ ìºì‹œì— 0~11ë²ˆì§€ ì ì¬&lt;/li>
&lt;li>ì´í›„ 12ë²ˆì§€ì˜ ë°ì´í„°ì— ì ‘ê·¼ â‡’ ìºì‹œì— ë°ì´í„°ê°€ ì—†ê¸°ë•Œë¬¸ì— 0~11ë²ˆì§€ì˜ ë°ì´í„° ëŒ€ì‹  12~23ë²ˆì§€ì˜ ë°ì´í„°ë¥¼ ìºì‹œì— ì ì¬&lt;/li>
&lt;li>ë‹¤ì‹œ ìµœê·¼ì— ì ‘ê·¼í–ˆë˜ ë°ì´í„°ì¸ 0ë²ˆì§€ì˜ ë°ì´í„°ì— ì ‘ê·¼ ì‹œë„
â‡’ 0ë²ˆ ë°ì´í„°ëŠ” ìµœê·¼ì— ì ‘ê·¼í–ˆë˜ ë°ì´í„°ì„ì—ë„ ì‹œê°„ ì§€ì—­ì„±ì´ í™œìš©ë˜ì§€ ëª»í•¨
â‡’ ìºì‹œì—ì„œ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ.&lt;/li>
&lt;/ol>
&lt;h3 id="ì‹œê°„-ì§€ì—­ì„±ì—-ì¹˜ìš°ì¹œ-ìºì‹œ-êµ¬ì¡°">ì‹œê°„ ì§€ì—­ì„±ì— ì¹˜ìš°ì¹œ ìºì‹œ êµ¬ì¡°&lt;/h3>
&lt;p>&lt;img src="https://umi0410.github.io/blog/golang/go-cpu-cache/temporal-locality-biased-cache.png"
width="312"
height="202"
srcset="https://umi0410.github.io/blog/golang/go-cpu-cache/temporal-locality-biased-cache_hu5d03129976ee7a9e19515a8e72953e35_8599_480x0_resize_box_3.png 480w, https://umi0410.github.io/blog/golang/go-cpu-cache/temporal-locality-biased-cache_hu5d03129976ee7a9e19515a8e72953e35_8599_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="temporal-locality-biased-cache.png"
class="gallery-image"
data-flex-grow="154"
data-flex-basis="370px"
>&lt;/p>
&lt;p>ìœ„ì˜ ê²½ìš° ìµœê·¼ì— í˜¸ì¶œëœ ë‹¤ì–‘í•œ ì£¼ì†Œì˜ ë°ì´í„°ë“¤ì„ ìºì‹œì— ì €ì¥í•´ì¤€ë‹¤. í•˜ì§€ë§Œ ìºì‹œì˜ í¬ê¸°ëŠ” í•œì •ë˜ì–´ìˆê¸° ë•Œë¬¸ì— ì„¸ë¡œê°€ ê¸¸ì–´ì§€ë©´ ê°€ë¡œëŠ” ì§§ì•„ì§„ë‹¤. ì¦‰ ìµœê·¼ ì ‘ê·¼ì„ ì‹œë„í•œ ë‹¤ì–‘í•œ ì£¼ì†Œì˜ ë°ì´í„°ë¥¼ ì €ì¥í•  ìˆ˜ ìˆì§€ë§Œ ê·¸ ë°ì´í„°ì˜ ì¸ê·¼ ë°ì´í„°ì— ëŒ€í•œ ì €ì¥ì€ ë§ì´ í•  ìˆ˜ ì—†ë‹¤ëŠ” ê²ƒì´ë‹¤.&lt;/p>
&lt;p>ì˜ˆë¥¼ ë“¤ì–´ ìœ„ì˜ ê·¸ë¦¼ê³¼ ê°™ì€ ê²½ìš° ìµœê·¼ 0, 3, 12, 18, 6, 20ë²ˆì§€ì˜ ë°ì´í„°ì— ì ‘ê·¼í–ˆê³  ì´í›„ì—ë„ í•´ë‹¹ ë²ˆì§€ì— ëŒ€í•œ ë°ì´í„°ë¥¼ ìºì‹œë¥¼ í†µí•´ ì´ìš©í•  ìˆ˜ ìˆë‹¤. ë°”ë¡œ ë‚´ê°€ ìµœê·¼ì— ì ‘ê·¼í–ˆë˜ ë°ì´í„°ì´ê¸°ë•Œë¬¸ì´ë‹¤. í•˜ì§€ë§Œ ë§Œì•½ 18ë²ˆì§€ì˜ ë°ì´í„°ì— ì ‘ê·¼í•œ ê²½ìš° ë†’ì€ í™•ë¥ ë¡œ ê³µê°„ì§€ì—­ì„±ì— ì˜ê±° 19, 20, 21, &amp;hellip; ë²ˆì§€ì˜ ë°ì´í„°ì— ì ‘ê·¼í•˜ê² ì§€ë§Œ, ì´ ì˜ˆì‹œëŠ” ì‹œê°„ì§€ì—­ì„±ì— ì¹˜ìš°ì³ì ¸ 19ë²ˆì§€ì˜ ë°ì´í„°ë§Œì„ ìºì‹œì—ì„œ ì œê³µë°›ì„ ìˆ˜ ìˆë‹¤.&lt;/p>
&lt;h2 id="í”„ë¡œê·¸ë¨ì„-í†µí•œ-ë²¤ì¹˜ë§ˆí‚¹">í”„ë¡œê·¸ë¨ì„ í†µí•œ ë²¤ì¹˜ë§ˆí‚¹&lt;/h2>
&lt;p>ì €ë²ˆì— Mutex, Semaphoreë¥¼ ì§ì ‘ ë²¤ì¹˜ë§ˆí‚¹í•´ë³´ë©´ì„œ Goì˜ ë‚´ì¥ ë²¤ì¹˜ë§ˆí¬ ê¸°ëŠ¥ì„ ì´ìš©í•˜ë©´ ì¢€ ë” í¸ë¦¬í•˜ê²Œ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤„ ìˆ˜ ìˆì„ ê²ƒ ê°™ì•˜ê¸°ì— ì´ë²ˆì— Goì˜ ë‚´ì¥ ë²¤ì¹˜ë§ˆí¬ ê¸°ëŠ¥ì„ ì´ìš©í•´ë´¤ë‹¤.&lt;/p>
&lt;p>&lt;strong>1000í–‰ 1000ì—´ì˜ 2ì°¨ì› intí˜• ë°°ì—´ì˜ ì–´ë– í•œ ìš”ì†Œì— ì ‘ê·¼í•´ì„œ +1 í•˜ëŠ” ì‘ì—…ì„ 1000íšŒ ìˆ˜í–‰í•˜ëŠ” ê²ƒì„ í•˜ë‚˜ì˜ ì‹¸ì´í´ë¡œ í•˜ëŠ” ë²¤ì¹˜ë§ˆí¬&lt;/strong>ë¥¼ ì‘ì„±í–ˆë‹¤. 2ì°¨ì› ë°°ì—´ì€ ê°€ë¡œë¡œëŠ” ì—°ì†ì ì¸ ì£¼ì†Œê°’ì„ ê°–ê¸°ì— ê³µê°„ ì§€ì—­ì„±ì„ í™œìš©í•  ìˆ˜ ìˆì§€ë§Œ ì„¸ë¡œë¡œëŠ” N * (intí˜• ìë£Œí˜•ì˜ í¬ê¸°)ì”© ì°¨ì´ ë‚˜ëŠ” ì£¼ì†Œê°’ì„ ê°–ê¸° ë•Œë¬¸ì— ê³µê°„ ì§€ì—­ì„±ì„ í™œìš©í•˜ê¸° í˜ë“¤ê³ , ìµœê·¼ ì ‘ê·¼í–ˆë˜ ì£¼ì†Œë¼ë©´ ì‹œê°„ ì§€ì—­ì„±ì€ í™œìš©í•  ìˆ˜ ìˆë‹¤.&lt;/p>
&lt;p>&lt;strong>ê³µê°„ ì§€ì—­ì„±&lt;/strong> (ê°€ë¡œë¡œ ì—°ì†ì ì¸ ë°ì´í„°)&lt;/p>
&lt;ul>
&lt;li>ê³µê°„ ì§€ì—­ì„±ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ê°€ë¡œë¡œ ì—°ì†ëœ ìš”ì†Œì— ì ‘ê·¼. ì¦‰ ì—°ì†ëœ ì£¼ì†Œë¥¼ ê°–ëŠ” 1000ê°œì˜ ìš”ì†Œì— ì ‘ê·¼&lt;/li>
&lt;li>ê³µê°„ ì§€ì—­ì„±ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš°ì—ëŠ” ì„¸ë¡œë¡œ ìš”ì†Œì— ì ‘ê·¼. ì¦‰ 1000 * int ìë£Œí˜•ì˜ í¬ê¸°ë§Œí¼ ì°¨ì´ë‚˜ëŠ” ì—°ì†ë˜ì§€ ì•Šì€ ì£¼ì†Œì˜ 1000ê°œì˜ ìš”ì†Œì— ì ‘ê·¼&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>ì‹œê°„ ì§€ì—­ì„±&lt;/strong> (ì—°ì†ì  ì£¼ì†Œì™€ ìƒê´€ì—†ì´ ìµœê·¼ì— ë¶ˆë¦° ë°ì´í„°)&lt;/p>
&lt;ul>
&lt;li>ì‹œê°„ ì§€ì—­ì„±ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ì£¼ì†Œê°’ì´ ê·¼ì ‘í•˜ì§„ ì•Šì§€ë§Œ 4ê°œ í˜¹ì€ 16ê°œì˜ ë°ì´í„°ì—ë§Œ ê³„ì†í•´ì„œ ì ‘ê·¼&lt;/li>
&lt;li>ì‹œê°„ ì§€ì—­ì„±ì„ ì‚¬ìš©í•˜ì§€ ì•Šì€ ê²½ìš°ì—ëŠ” ê³„ì†í•´ì„œ ì²˜ìŒ ì ‘ê·¼í•˜ëŠ” ë°ì´í„°ì—ë§Œ ì ‘ê·¼&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;testing&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">var&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Size&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">1000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">generateArray&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">[][]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">arr&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">([][]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">j&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">j&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">j&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">j&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">arr&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">BenchmarkSpatialLocality&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;ê³µê°„ì§€ì—­ì„± ì‚¬ìš©&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">arr&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">generateArray&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ResetTimer&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">n&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">n&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">N&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">n&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;ê³µê°„ì§€ì—­ì„± X&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">arr&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">generateArray&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ResetTimer&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">n&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">n&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">N&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">n&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">BenchmarkTemporalLocality&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;ì‹œê°„ ì§€ì—­ì„± ì ê·¹ ì‚¬ìš©. ìµœê·¼ ì ‘ê·¼í•œ ë°ì´í„° 4ê°œ.&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">arr&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">generateArray&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ResetTimer&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">n&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">n&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">N&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">n&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;ì‹œê°„ ì§€ì—­ì„± ì¡°ê¸ˆ ì‚¬ìš©. ìµœê·¼ ì ‘ê·¼í•œ ë°ì´í„° 16ê°œ.&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">arr&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">generateArray&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ResetTimer&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">n&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">n&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">N&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">n&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ì‚¬ì‹¤ ì™„ë²½í•˜ê²Œ ìƒˆë¡œìš´ ë°ì´í„°ëŠ” ì•„ë‹˜. ë²¤ì¹˜ë§ˆí‚¹í•˜ëŠ” ë™ì•ˆ ê³„ì†í•´ì„œ ë°˜ë³µë˜ê¸° ë•Œë¬¸ì—
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;ì‹œê°„ ì§€ì—­ì„± X. ìƒˆë¡œìš´ ë°ì´í„°ì—ë§Œ ì ‘ê·¼.&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">arr&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">generateArray&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ResetTimer&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">n&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">n&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">N&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">n&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">Size&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">goos&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">linux&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">goarch&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">amd64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">pkg&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">playground&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">unix&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">socket&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">cache&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">BenchmarkSpatialLocality&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">ê³µê°„ì§€ì—­ì„±_ì‚¬ìš©&lt;/span> &lt;span class="mi">50000&lt;/span> &lt;span class="mi">894&lt;/span> &lt;span class="nx">ns&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">op&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">BenchmarkSpatialLocality&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">ê³µê°„ì§€ì—­ì„±_X&lt;/span> &lt;span class="mi">50000&lt;/span> &lt;span class="mi">6561&lt;/span> &lt;span class="nx">ns&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">op&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">BenchmarkTemporalLocality&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">ì‹œê°„_ì§€ì—­ì„±_ì ê·¹_ì‚¬ìš©&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">_ìµœê·¼_ì ‘ê·¼í•œ_ë°ì´í„°_4ê°œ&lt;/span>&lt;span class="p">.&lt;/span> &lt;span class="mi">50000&lt;/span> &lt;span class="mi">1918&lt;/span> &lt;span class="nx">ns&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">op&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">BenchmarkTemporalLocality&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">ì‹œê°„_ì§€ì—­ì„±_ì¡°ê¸ˆ_ì‚¬ìš©&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">_ìµœê·¼_ì ‘ê·¼í•œ_ë°ì´í„°_16ê°œ&lt;/span>&lt;span class="p">.&lt;/span> &lt;span class="mi">50000&lt;/span> &lt;span class="mi">4153&lt;/span> &lt;span class="nx">ns&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">op&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">BenchmarkTemporalLocality&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">ì‹œê°„_ì§€ì—­ì„±_X&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">_ìƒˆë¡œìš´_ë°ì´í„°ì—ë§Œ_ì ‘ê·¼&lt;/span>&lt;span class="p">.&lt;/span> &lt;span class="mi">50000&lt;/span> &lt;span class="mi">6564&lt;/span> &lt;span class="nx">ns&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">op&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ë‹ˆ ê°„ë‹¨í•œ ë°°ì—´ ë‚´ì˜ ìš”ì†Œë“¤ì— ëŒ€í•œ ì—°ì‚°ì¸ë°ë„ ê½¤ë‚˜ ì°¨ì´ê°€ ì»¸ë‹¤.&lt;/p>
&lt;h2 id="ë§ˆì¹˜ë©°">ë§ˆì¹˜ë©°&lt;/h2>
&lt;p>ì €ë²ˆ í•™ê¸°ì— ì»´í“¨í„° êµ¬ì¡°ë¥¼ ìˆ˜ê°•í•˜ë©´ì„œ CPU-Memory ìºì‹œì˜ íš¨ê³¼ë¥¼ ì§ì ‘ ë°°ì—´ì— ëŒ€í•œ í”„ë¡œê·¸ë¨ì„ í†µí•´ ë³´ì—¬ì£¼ëŠ” ì˜ˆì‹œë¥¼ ë³´ê³  ì‹ ê¸°í–ˆë˜ ê¸°ì–µì´ ìˆì–´ì„œ ì´ë ‡ê²Œ ë²¤ì¹˜ë§ˆí‚¹ í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•´ë´¤ë‹¤. ë‹¤ë¥¸ CS ì£¼ìš” ì§€ì‹ë“¤ì— ë¹„í•´ ì–´ë ¤ìš¸ ê²ƒì€ ì—†ëŠ” í¸ì´ê³  ìš°ë¦¬ê°€ ì‰½ê²Œ ì ‘í•´ì˜¤ë˜ ë‚´ìš©ì´ë¼ ë” ì´í•´í•˜ê¸° ì‰½ì§€ ì•Šì•˜ì„ê¹Œ ì‹¶ë‹¤.&lt;/p>
&lt;h2 id="ì°¸ê³ ">ì°¸ê³ &lt;/h2>
&lt;ul>
&lt;li>ìºì‹œë€ - &lt;a class="link" href="https://ko.wikipedia.org/wiki/%EC%BA%90%EC%8B%9C" target="_blank" rel="noopener"
>https://ko.wikipedia.org/wiki/ìºì‹œ&lt;/a>&lt;/li>
&lt;li>ìºì‹œê°€ ë™ì‘í•˜ëŠ” ì•„ì£¼ êµ¬ì²´ì ì¸ ì›ë¦¬ - &lt;a class="link" href="https://parksb.github.io/article/29.html" target="_blank" rel="noopener"
>https://parksb.github.io/article/29.html&lt;/a>&lt;/li>
&lt;li>cache mapping - &lt;a class="link" href="https://m.blog.naver.com/jkssleeky/220478400046" target="_blank" rel="noopener"
>https://m.blog.naver.com/jkssleeky/220478400046&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Go ì–¸ì–´ë¡œ ì ìš©í•´ë³´ëŠ” Computer Science - Socket (Unix Domain Socket, Network/TCP/UDP Socket)</title><link>https://umi0410.github.io/blog/golang/go-socket/</link><pubDate>Sat, 13 Feb 2021 14:10:54 +0900</pubDate><guid>https://umi0410.github.io/blog/golang/go-socket/</guid><description>&lt;img src="https://umi0410.github.io/blog/golang/go-socket/server-client-socket.jpeg" alt="Featured image of post Go ì–¸ì–´ë¡œ ì ìš©í•´ë³´ëŠ” Computer Science - Socket (Unix Domain Socket, Network/TCP/UDP Socket)" />&lt;h2 id="ì‹œì‘í•˜ë©°">ì‹œì‘í•˜ë©°&lt;/h2>
&lt;p>ê°œë°œ ê³µë¶€ë¥¼ ì²˜ìŒ ì‹œì‘í•œ ì§€ ì–¸ì œ ì•ˆ ëì„ ë¬´ë µ, ì˜ê²½ ë³µë¬´ë¥¼ í•˜ë©° ìë°”ë¡œ TCP Socketì„ ì´ìš©í•´ ì˜† ì»´í“¨í„°ì™€ ì±„íŒ…ì„ í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ë§Œë“¤ì–´ ë³´ëŠ” ê²ƒì„ ì‹œì‘ìœ¼ë¡œ dockerë‚˜ mysqlê³¼ ê°™ì€ ë‹¤ì–‘í•œ ì˜¤í”ˆì†ŒìŠ¤ë“¤ì„ ì´ìš©í•´ë³´ë©´ì„œë‚˜ ë„¤íŠ¸ì›Œí¬ë¥¼ ê³µë¶€í•˜ë©´ì„œ ë‹¤ì–‘í•˜ê²Œ ë“¤ì–´ì™”ë˜ &lt;code>ì†Œì¼“&lt;/code>ì´ì§€ë§Œ ì •í™•íˆ ì–´ë–¤ ì—­í• ì„ í•˜ëŠ”ì§€ ì–´ë–¤ ì¢…ë¥˜ê°€ ìˆëŠ”ì§€ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ ì•Œì§€ ëª»í–ˆë‹¤.&lt;/p>
&lt;p>ì˜¤ëŠ˜ì€ ê·¸ë ‡ê²Œ ì•Œì­ë‹¬ì­í•œ ì¡´ì¬ì˜€ë˜ ì†Œì¼“ì„ í¬ê²Œ &lt;strong>&lt;code>Unix Domain Socket&lt;/code>ì™€ &lt;code>Network Socket&lt;/code> ë‘ ê°€ì§€ë¡œ ë‚˜ëˆ  ì •ë¦¬í•´ë³´ê³  Unix Domain Socketê³¼ TCPë¥¼ ì‚¬ìš©í•˜ëŠ” Network Socketì„ ë²¤ì¹˜ë§ˆí¬í•´ë³´ê³  ì–´ë–¤ ì°¨ì´ê°€ ìˆëŠ”ì§€ í™•ì¸&lt;/strong>í•´ë³´ë„ë¡ í•˜ê² ë‹¤. ì£¼ë¡œ ë‚´ê°€ ì†Œì¼“ì„ ì ‘í–ˆë˜ ìë£Œë‚˜ ì´ìŠˆ ìƒí™©ì—ì„œëŠ” UDPë³´ë‹¤ëŠ” TCPê°€ ë§ì´ ë“±ì¥í–ˆì—ˆê¸° ë•Œë¬¸ì— &lt;strong>UDPì— ëŒ€í•œ ë‚´ìš©ì€ ê±°ì˜ ì œì™¸í•  ê²ƒì´ë¯€ë¡œ ëŒ€ë¶€ë¶„ì´ Network socketê³¼ Unix domain socket ê°ê°ì˜ stream(network socketì—ì„  tcpë¥¼ ì´ìš©í•˜ëŠ” ê²½ìš°ì— í•´ë‹¹) type socket&lt;/strong>ì— ê´€ë ¨í•œ ë‚´ìš©ì¼ ê²ƒì´ë‹¤.&lt;/p>
&lt;h2 id="socket-ì´ë€">Socket ì´ë€&lt;/h2>
&lt;p>ì†Œì¼“ì€ ì–´ë– í•œ í†µì‹ ì—ì„œì˜ Endpoint(ëì ) ì—­í• ì„ í•œë‹¤. ëì ì´ ì—†ìœ¼ë©´ ì–´ë””ì™€ ì–´ë””ê°€ í†µì‹ í•˜ëŠ”ì§€ ì–´ë””ì— ë°ì´í„°ë¥¼ ì¨ì•¼í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ì—†ë‹¤.&lt;/p>
&lt;p>ì†Œì¼“ì„ ë§ˆì¹˜ ì „êµ¬ ì†Œì¼“ê³¼ ê°™ì´ ì†Œì¼“ì´ë¼ê³  ë¶€ë¥´ëŠ” ì´ìœ ëŠ” ì†Œì¼“ì— ì˜¬ë°”ë¥´ê²Œ ë°ì´í„°ë¥¼ ì ê¸°ë§Œ í•˜ë©´ í†µì‹ ì„ ìœ„í•œ ì„¸ë¶€ì ì¸ ë™ì‘ì€ ì†Œì¼“ì´ ì•Œì•„ì„œ ìˆ˜í–‰í•˜ê¸° ë•Œë¬¸ì´ë‹¤. ë”°ë¼ì„œ ìš°ë¦¬ëŠ” í†µì‹ ì„ í•˜ê¸° ìœ„í•œ Socketì„ ì˜¬ë°”ë¥´ê²Œ ìƒì„±í•˜ê³ , ê·¸ ê³³ì— ë°ì´í„°ë¥¼ ì˜¬ë°”ë¥´ê²Œ ì ê±°ë‚˜ ê·¸ê³³ì˜ ë°ì´í„°ë¥¼ ì˜¬ë°”ë¥´ê²Œ ì½ê¸°ë§Œ í•˜ë©´ ëœë‹¤. ì‹¤ì œ ë°ì´í„° ì „ì†¡ì€ ì†Œì¼“ì´ ì•Œì•„ì„œ ìˆ˜í–‰í•´ì¤€ë‹¤.&lt;/p>
&lt;p>ì†Œì¼“ì€ ê°™ì€ í˜¸ìŠ¤íŠ¸ ë‚´ì—ì„œ IPCë¥¼ ìœ„í•´ ì‚¬ìš©ë˜ëŠ” &lt;code>Unix domain socket&lt;/code>ê³¼ ë„¤íŠ¸ì›Œí¬ í†µì‹ ì„ í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” &lt;code>Network socket&lt;/code>ìœ¼ë¡œ ë¶„ë¥˜í•  ìˆ˜ ìˆë‹¤. ê°„í˜¹ unix domain socketê³¼ TCPë¥¼ ì´ìš©í•˜ëŠ” Network socket, UDPë¥¼ ì´ìš©í•˜ëŠ” Network socket ì´ë ‡ê²Œ ì„¸ ê°€ì§€ë¡œ ë¶„ë¥˜í•˜ëŠ” ê²½ìš°ë¥¼ ë³¸ ê²ƒ ê°™ì€ë° ì´ëŠ” ì˜ëª»ëœ ë¶„ë¥˜ë¼ê³  ìƒê°í•œë‹¤. Network socket ë¿ë§Œ ì•„ë‹ˆë¼ Unix domain socket ë˜í•œ stream(Network socketì˜ ê²½ìš° TCPë¥¼ ì´ìš©í•˜ëŠ” ê²½ìš°ì— í•´ë‹¹) íƒ€ì…ê³¼ datagram íƒ€ì…(Network socketì˜ ê²½ìš° UDPë¥¼ ì´ìš©í•˜ëŠ” ê²½ìš°ì— í•´ë‹¹)ìœ¼ë¡œ ì‚¬ìš©ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.&lt;/p>
&lt;h3 id="ì„œë²„-ì†Œì¼“ê³¼-í´ë¼ì´ì–¸íŠ¸-ì†Œì¼“">ì„œë²„ ì†Œì¼“ê³¼ í´ë¼ì´ì–¸íŠ¸ ì†Œì¼“&lt;/h3>
&lt;p>&lt;img src="https://umi0410.github.io/blog/golang/go-socket/server-client-socket.jpeg"
width="2146"
height="1000"
srcset="https://umi0410.github.io/blog/golang/go-socket/server-client-socket_huc5be35f5857cc34672b838b13057c03e_282874_480x0_resize_q75_box.jpeg 480w, https://umi0410.github.io/blog/golang/go-socket/server-client-socket_huc5be35f5857cc34672b838b13057c03e_282874_1024x0_resize_q75_box.jpeg 1024w"
loading="lazy"
alt="server-client-socket.jpeg"
class="gallery-image"
data-flex-grow="214"
data-flex-basis="515px"
>&lt;/p>
&lt;p>ì†Œì¼“ì„ ì—­í• ì˜ ì¸¡ë©´ì—ì„œ ë¶„ë¥˜í•œë‹¤ë©´ ì„œë²„ ì†Œì¼“ê³¼ í´ë¼ì´ì–¸íŠ¸ ì†Œì¼“ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤. ë™ì¼í•œ êµ¬ì¡°ì˜ ì†Œì¼“ì´ì§€ë§Œ ìƒì„±ë˜ëŠ” ì‹œê¸°ë‚˜ ì—­í• ì´ ë‹¤ë¥¼ ë¿ì´ë‹¤.&lt;/p>
&lt;ul>
&lt;li>&lt;strong>ì„œë²„ ì†Œì¼“&lt;/strong> - í´ë¼ì´ì–¸íŠ¸ ì†Œì¼“ì˜ ì—°ê²° ìš”ì²­ì„ ë°›ì•„ë“¤ì´ê¸°ë§Œ í•  ë¿. ì‹¤ì œ ì„œë²„ ì¸¡ì—ì„œì˜ ë°ì´í„°ì˜ ì†¡ìˆ˜ì‹ ì€ ì„œë²„ ì†Œì¼“ì´ í´ë¼ì´ì–¸íŠ¸ ì†Œì¼“ì˜ ì—°ê²° ìš”ì²­ì„ ìˆ˜ë½í•˜ë©´ì„œ ìƒˆë¡œ ë§Œë“¤ì–´ì§€ëŠ” ì†Œì¼“ì„ í†µí•´ ìˆ˜í–‰.&lt;/li>
&lt;li>&lt;strong>í´ë¼ì´ì–¸íŠ¸ ì†Œì¼“&lt;/strong> - í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì™€ í†µì‹ í•˜ê³ ì í•  ë•Œ ìƒì„±í•˜ëŠ” ì†Œì¼“. í´ë¼ì´ì–¸íŠ¸ëŠ” ì‹¤ì œ ë°ì´í„° ì†¡ìˆ˜ì‹ ë„ ì´ ì†Œì¼“ì„ í†µí•´ ìˆ˜í–‰.&lt;/li>
&lt;/ul>
&lt;p>ì„œë²„ ì†Œì¼“ê³¼ í´ë¼ì´ì–¸íŠ¸ ì†Œì¼“ì´ ë‹¨ìˆœí•œê²Œ 1:Nìœ¼ë¡œë§Œ í†µì‹ í•˜ë©´ ì´ë ‡ê²Œ ì„œë²„ ì†Œì¼“ì´ í´ë¼ì´ì–¸íŠ¸ ì†Œì¼“ì˜ ìš”ì²­ì„ ìˆ˜ë½í•œ ë’¤ ìƒˆë¡œ ì†Œì¼“ì„ ë§Œë“¤ í•„ìš” ì—†ì§€ ì•Šì„ê¹Œì‹¶ì§€ë§Œ ê·¸ë ‡ê²Œ ë˜ë©´ ì„œë²„ê°€ ê° í´ë¼ì´ì–¸íŠ¸ì™€ í†µì‹ í•  ë•Œ í•˜ë‚˜ì˜ ì†Œì¼“ì„ ì´ìš©í•˜ë¯€ë¡œ ì˜¬ë°”ë¥´ê²Œ ì›í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ì™€ í†µì‹ í•  ìˆ˜ ì—†ì„í…Œë‹ˆ ì¢‹ì€ ë°©ì‹ì´ ì•„ë‹ ê²ƒì´ë‹¤.&lt;/p>
&lt;p>ê·¸ë ‡ë‹¤ë©´ ê³¼ì—° &lt;strong>ì •ë§ ì„œë²„ì—ì„œëŠ” ì—°ê²°ì„ accept í•œ ë’¤ ì†Œì¼“ì„ ìƒˆë¡œ ìƒì„±í• ê¹Œ?&lt;/strong> í™•ì¸í•´ë³´ì.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;log&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;net&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;os&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;time&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">var&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">network&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;tcp&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">address&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;0.0.0.0:8080&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Remove&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">address&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">socket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">net&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Listen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">network&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">address&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Fatal&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">connectedSocket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">socket&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Accept&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Fatal&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">connectedSocket&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Write&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="nb">byte&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;pong\n&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Second&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">connectedSocket&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ê°„ë‹¨í•˜ê²Œ TCP í†µì‹ í”„ë¡œê·¸ë¨ì„ í•˜ë‚˜ ë§Œë“¤ì–´ë´¤ë‹¤. ë‹¨ìˆœíˆ 1ì´ˆ ê°„ê²©ìœ¼ë¡œ pongì„ 5ë²ˆ ì¶œë ¥í•œ ë’¤ ì—°ê²°ì„ ëŠëŠ” í”„ë¡œê·¸ë¨ì´ë‹¤.&lt;/p>
&lt;p>&lt;strong>ìš”ì²­ ì „&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ netstat --tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Active Internet connections &lt;span class="o">(&lt;/span>w/o servers&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Proto Recv-Q Send-Q Local Address Foreign Address State
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcp &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> ip-172-31-34-13.ap-:ssh 124.50.93.166:60082 ESTABLISHED
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcp &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> ip-172-31-34-13.ap-:ssh 124.50.93.166:60084 ESTABLISHED
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcp &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> ip-172-31-34-13.ap-:ssh 124.50.93.166:60078 ESTABLISHED
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>ìš”ì²­ ìˆ˜ë½ í›„ í†µì‹  ì¤‘&lt;/strong> - ì†Œì¼“ì´ í•˜ë‚˜ ìƒì„±ë˜ì–´ ESTABLISHED ìƒíƒœ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ netstat --tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Active Internet connections &lt;span class="o">(&lt;/span>w/o servers&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Proto Recv-Q Send-Q Local Address Foreign Address State
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcp &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> ip-172-31-34-13.ap-:ssh 124.50.93.166:60082 ESTABLISHED
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcp &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> ip-172-31-34-13.ap-:ssh 124.50.93.166:60084 ESTABLISHED
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcp &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> ip-172-31-34-13.ap-:ssh 124.50.93.166:60078 ESTABLISHED
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcp6 &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> ip-172-31-34-1:http-alt 124.50.93.166:42434 ESTABLISHED
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>í†µì‹  ì¢…ë£Œ&lt;/strong> - ìƒì„±ë˜ì—ˆë˜ ì†Œì¼“ì´ TIME_WAIT ìƒíƒœ. ì ì‹œ í›„ ì‚¬ë¼ì§„ë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ netstat --tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Active Internet connections &lt;span class="o">(&lt;/span>w/o servers&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Proto Recv-Q Send-Q Local Address Foreign Address State
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcp &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> ip-172-31-34-13.ap-:ssh 124.50.93.166:60082 ESTABLISHED
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcp &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> ip-172-31-34-13.ap-:ssh 124.50.93.166:60084 ESTABLISHED
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcp &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> ip-172-31-34-13.ap-:ssh 124.50.93.166:60078 ESTABLISHED
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcp6 &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> ip-172-31-34-1:http-alt 124.50.93.166:42434 TIME_WAIT
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>ê¹”ë”í•œ ë„¤íŠ¸ì›Œí¬ ì •ë³´ë¥¼ ë³´ê¸° ìœ„í•´ ìˆœìˆ˜í•œ AWS EC2 t2.micro ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ì‘ì—…í•´ë³´ì•˜ë‹¤. ë§¨ ìœ„ 3ì¤„ì— ë‚˜ì˜¨ ì†Œì¼“ ì •ë³´ëŠ” ssh ì ‘ì†ìœ¼ë¡œ ì¸í•œ ì†Œì¼“ ì •ë³´ì´ë‹¤.&lt;/p>
&lt;p>ë˜í•œ ì„œë²„ ì†Œì¼“ì€ ì¶œë ¥ë˜ì§€ ì•Šì•˜ëŠ”ë° ì´ëŠ” ìš°ë¦¬ëŠ” í‰ì†Œì— listen ì¤‘ì¸ í¬íŠ¸ë‚˜ ì„œë²„ ì†Œì¼“ì„ ë³´ê¸° ìœ„í•´ netstatì— -l ì˜µì…˜ì„ ì „ë‹¬í•œ ë°˜ë©´ ì´ë²ˆì—” &amp;ndash;tcp ì˜µì…˜ì„ í†µí•´ listen ì¤‘ì¸ ì„œë²„ ì†Œì¼“ì´ ì•„ë‹Œ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ìˆ˜ë½í•œ ë’¤ ìƒì„±ë˜ëŠ” ì†Œì¼“ì„ ë³´ë ¤í•˜ê³ ìˆê¸° ë•Œë¬¸ì´ë‹¤.&lt;/p>
&lt;/blockquote>
&lt;p>4ë²ˆ ì§¸ ì¤„ì˜ ì†Œì¼“ ì •ë³´ê°€ ë°”ë¡œ ìš°ë¦¬ê°€ ìƒê°í•˜ëŠ” ì„œë²„ ì†Œì¼“ì´ clientì˜ ì—°ê²° ìš”ì²­ì„ accept í›„ ìƒì„±í•˜ëŠ” socketì´ë‹¤. í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ accept í›„ì— ìƒˆë¡œìš´ ì†Œì¼“ì´ ìƒì„±ë˜ë©° í†µì‹  ì¢…ë£Œ í›„ ì ì‹œ ê¸°ë‹¤ë¦° ë’¤ ì‚¬ë¼ì§„ë‹¤.&lt;/p>
&lt;h3 id="network-socket">Network Socket&lt;/h3>
&lt;p>&lt;code>Network socket&lt;/code>ì€ ë„¤íŠ¸ì›Œí¬ í†µì‹ ì´ í•„ìš”í•œ ì‘ì—…ì„ ìˆ˜í–‰í•  ë•Œ ì´ìš©í•˜ëŠ” ì†Œì¼“ì˜ í•œ ì¢…ë¥˜ë¡œ ë‹¤ì‹œ ë™ì‘ ë°©ì‹ì— ë”°ë¼ TCP í”„ë¡œí† ì½œì„ ì´ìš©í•˜ëŠ” stream socketê³¼ UDP í”„ë¡œí† ì½œì„ ì´ìš©í•˜ëŠ” datagram socketìœ¼ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤. ì‚¬ìš©ìëŠ” socketì— ë°ì´í„°ë¥¼ ì ê¸°ë§Œ í•˜ë©´ ë„¤íŠ¸ì›Œí¬ì™€ ê´€ë ¨ëœ ì‘ì—…ì€ socketì´ ì•Œì•„ì„œ ìˆ˜í–‰í•´ì¤€ë‹¤. ì½ì„ ë•Œì—ë„ ë§ˆì°¬ê°€ì§€ì´ë‹¤.&lt;/p>
&lt;p>TCP socketì´ë¼ê³  ë¶€ë¥´ëŠ” ì‚¬ëŒë„ ìˆê³  stream socket, TCP/IP socketì´ë¼ ë¶€ë¥´ëŠ” ì‚¬ëŒë„ ìˆëŠ” ê²ƒ ê°™ë‹¤. ì •í™•í•œ ëª…ì¹­ì€ ëª¨ë¥´ê² ì§€ë§Œ ì‚¬ìš©í•˜ê±°ë‚˜ ì´í•´í•˜ëŠ” ë°ì—ëŠ” ë¬´ë¦¬ê°€ ì—†ì„ ê²ƒ ê°™ë‹¤.
TCPë¥¼ ì´ìš©í•˜ëŠ” stream typeì˜ Network socketê³¼ stream typeì˜ Unix domain socketì€ ì‚¬ìš© ë°©ë²•ì´ ë§¤ìš° ìœ ì‚¬í•˜ë‹¤. ë‘˜ ë‹¤ stream typeì´ê³ , ì†Œì¼“ì— ë°ì´í„°ë¥¼ ì ì€ ë’¤ì˜ ì‘ì—…ì€ ì†Œì¼“ì´ ì•Œì•„ì„œ ìˆ˜í–‰í•´ì£¼ê¸° ë•Œë¬¸ì´ë‹¤. ê°ê°ì˜ ì†Œì¼“ì„ ì´ìš©í•´ ì„œë²„ë¥¼ ë„ìš°ëŠ” ì‘ì—…ì€ ì¸ìì˜ ê°’ë§Œ ì¡°ê¸ˆ ë‹¬ë¼ì§ˆ ë¿ì´ë‹¤. ì´ëŠ” ê¸€ì˜ í•˜ë¶€ì˜ ì½”ë“œì—ì„œ í™•ì¸í•´ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p>
&lt;h4 id="socketê³¼-port">Socketê³¼ Port&lt;/h4>
&lt;p>Network socketì— ëŒ€í•´ì„œëŠ” socketê³¼ portì˜ êµ¬ë¶„ì´ë‚˜ ì—­í• ì´ ì• ë§¤í•˜ê²Œ ëŠê»´ì§ˆ ìˆ˜ ìˆë‹¤. í†µì‹ ì„ í•  ë•Œ IP ì£¼ì†Œë¥¼ ì´ìš©í•´ ëª©ì ì§€ì¸ Hostë¥¼ ì°¾ì„ ìˆ˜ëŠ” ìˆì§€ë§Œ ê·¸ Hostì˜ ì–´ë–¤ í”„ë¡œì„¸ìŠ¤ê³¼ í†µì‹ í•˜ë ¤ëŠ” ê²ƒì¸ì§€ëŠ” ì•Œ ìˆ˜ ì—†ë‹¤. ì˜¬ë°”ë¥¸ í”„ë¡œì„¸ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ìˆë„ë¡ í”„ë¡œì„¸ìŠ¤ì™€ ì–´ë– í•œ ìˆ«ìë¥¼ ë§¤í•‘ì‹œí‚¤ëŠ”ë° ì´ ìˆ«ìë¥¼ Port ë²ˆí˜¸ë¼ê³  í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ 123.123.123.123:8080ìœ¼ë¡œ ìš”ì²­ì„ ë³´ë‚´ëŠ” ê²ƒì€ 123.123.123.123ì˜ IP ì£¼ì†Œë¥¼ ê°–ëŠ” Hostì˜ 8080ë²ˆ í¬íŠ¸ì— ë§µí•‘ëœ í”„ë¡œì„¸ìŠ¤ì— ìš”ì²­ì„ ë³´ë‚´ëŠ” ê²ƒì´ë‹¤.&lt;/p>
&lt;p>ì´ ë•Œ Portì™€ í”„ë¡œì„¸ìŠ¤ë¥¼ ê·¸ëƒ¥ ì—°ê²°í•  ìˆ˜ëŠ” ì—†ê³  Socketì´ë¼ëŠ” ë…€ì„ì´ í•„ìš”í•˜ë‹¤. Socketì€ ì‹¤ì§ˆì ìœ¼ë¡œ ì–´ë–¤ í”„ë¡œì„¸ìŠ¤ë¥¼ ì–´ë–¤ í¬íŠ¸ì— ë§µí•‘ì‹œí‚¬ì§€ì— ëŒ€í•œ ì •ë³´ê°€ í•„ìš”í•˜ê³  ë„¤íŠ¸ì›Œí¬ ì‘ì—…ì„ ì•Œì•„ì„œ ìˆ˜í–‰í•œë‹¤.&lt;/p>
&lt;p>ì¡°ê¸ˆ ë¹„ìœ ë¥¼ í•´ë³´ìë©´ íšŒì‚¬ë‚´ì— ì–´ë–¤ ë¶€ì„œê°€ ìˆê³  ì™¸ë¶€ì—ì„œ í•´ë‹¹ ë¶€ì„œì™€ ì‘ì—…í•˜ê¸° ìœ„í•´ì„  ì–´ë– í•œ ê³ ìœ í•œ ë¶€ì„œ ë²ˆí˜¸ê°€ í•„ìš”í•˜ê³ , ì´ë•Œ ì™¸ë¶€ì™€ í•´ë‹¹ ë¶€ì„œê°„ì— ì˜¤ê°€ëŠ” í†µì‹ ì„ ë‹´ë‹¹í•˜ëŠ” ë‹´ë‹¹ìê°€ ìˆì–´ì•¼í•˜ëŠ” ê²½ìš°ì— ë¹„ìœ í•´ ë³¼ ìˆ˜ ìˆë‹¤. &amp;ldquo;ì–´ë–¤ ë¶€ì„œ&amp;quot;ëŠ” í”„ë¡œì„¸ìŠ¤ì´ê³  &amp;ldquo;ê³ ìœ í•œ ë¶€ì„œ ë²ˆí˜¸&amp;quot;ëŠ” í¬íŠ¸ ë²ˆí˜¸, í†µì‹ ì„ ë‹´ë‹¹í•˜ëŠ” ë‹´ë‹¹ìëŠ” ì†Œì¼“ì— í•´ë‹¹í•œë‹¤.&lt;/p>
&lt;h3 id="unix-domain-socket">Unix Domain Socket&lt;/h3>
&lt;p>Unix Domain Socketì€ IPC(Inter-Process Communication, í”„ë¡œì„¸ìŠ¤ ê°„ í†µì‹ )ì˜ ì—¬ëŸ¬ ë°©ë²• ì¤‘ ê°€ì¥ ììœ ë¡œìš°ë©´ì„œ ì‚¬ìš©í•˜ëŠ” ë°ì— ìˆì–´ ì œí•œì´ ë³„ë¡œ ì—†ëŠ” ë°©ë²•ì´ë‹¤. ë„¤íŠ¸ì›Œí¬ ì†Œì¼“ê³¼ ë‹¬ë¦¬ ê°™ì€ í˜¸ìŠ¤íŠ¸ ë‚´ì˜ í”„ë¡œì„¸ìŠ¤ ê°„ í†µì‹ ì„ ë‹´ë‹¹í•˜ê¸° ë•Œë¬¸ì— ì•„ë¬´ëŸ° ë„¤íŠ¸ì›Œí¬ ì‘ì—…ì´ í•„ìš” ì—†ë‹¤. í•˜ì§€ë§Œ TCPë‚˜ UDPë¥¼ ì´ìš©í•˜ëŠ” Network socketì„ ì´ìš©í•  ë•Œì™€ ì¸ì ê°’ë§Œ ì¡°ê¸ˆ ë°”ê¾¸ì–´ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.&lt;/p>
&lt;h4 id="-ìƒìƒì˜-ë‚˜ë˜---ìš°ë¦¬ê°€-ì•Œê²Œ-ëª¨ë¥´ê²Œ-ê²ªì—ˆë˜-unix-domain-socketì˜-permissionì˜¤ë¥˜ì—-ëŒ€í•´">ğŸŒˆ ìƒìƒì˜ ë‚˜ë˜ - ìš°ë¦¬ê°€ ì•Œê²Œ ëª¨ë¥´ê²Œ ê²ªì—ˆë˜ Unix domain socketì˜ Permissionì˜¤ë¥˜ì— ëŒ€í•´&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ mysql
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">stat /var/lib/mysql/mysql.sock
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">stat: cannot stat &lt;span class="s1">&amp;#39;/var/lib/mysql/mysql.sock&amp;#39;&lt;/span>: Permission denied
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ docker
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker: Got permission denied &lt;span class="k">while&lt;/span> trying to connect to the Docker daemon socket at unix:///var/run/docker.sock
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ì£¼ë¡œ ìš°ë¦¬ê°€ &lt;code>MySQL&lt;/code>ì´ë‚˜ &lt;code>Docker&lt;/code>ë¥¼ &lt;code>localhost&lt;/code>ì—ì„œ ì‚¬ìš©í•  ë•Œ &lt;strong>unix socketì— ëŒ€í•œ permission ì—ëŸ¬&lt;/strong>ë¥¼ ê²ªì€ ì ì´ ìˆì„ ê²ƒì´ë‹¤. MySQLì´ë‚˜ Dockerë¥¼ ë¹„ë¡¯í•œ ë§ì€ ì˜¤í”ˆì†ŒìŠ¤ë“¤ì´ ì•„ë§ˆ ì„±ëŠ¥ìƒì˜ ì´ì ì„ ìœ„í•´ localhostì—ì„œ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•  ê²½ìš° Network socketì´ ì•„ë‹Œ Unix domain socketì„ ë§ì´ë“¤ ì´ìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ ì•Œê³ ìˆë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ì£¼ë¡œ MySQL ì„¤ì¹˜ ì´í›„ Remoteì—ì„œëŠ” ì ‘ì†ì´ ë˜ëŠ”ë° &lt;strong>localhostì—ì„œëŠ” ê¶Œí•œ ë¬¸ì œë¡œ ì ‘ì†ì´ ì•ˆëœë‹¤ê±°ë‚˜ Docker ì„¤ì¹˜ ì´í›„ ì‚¬ìš©ìë¥¼ docker groupì— ë„£ì–´ì£¼ëŠ” ê²½ìš°&lt;/strong>ê°€ ë§ì´ ìˆë‹¤.&lt;/p>
&lt;p>ì•„ë§ˆë„ ë„¤íŠ¸ì›Œí¬ í†µì‹ ì„ í†µí•´ ì„œë²„ ì†Œì¼“ì— ì ‘ê·¼í•˜ëŠ” ë„¤íŠ¸ì›Œí¬ ì†Œì¼“ê³¼ ë‹¬ë¦¬ unix domain socketì€ client processê°€ ì§ì ‘ serverì˜ socket fileì— ì ‘ê·¼í•˜ê¸° ë•Œë¬¸ì— ì´ë•Œ ì“°ê¸° ê¶Œí•œ ë•Œë¬¸ì— ê·¸ëŸ° ê¶Œí•œ ì˜¤ë¥˜ê°€ ìƒê¸°ëŠ” ê²ƒì´ ì•„ë‹ê¹Œë¼ëŠ” ìƒìƒì˜ ë‚˜ë˜ë¥¼ í¼ì³ë³¸ë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ubuntu ì‚¬ìš©ìë¡œ unix domain socket server í”„ë¡œì„¸ìŠ¤ë¥¼ ë„ìš´ ê²½ìš°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ubuntu ì‚¬ìš©ìë¡œëŠ” ì˜ ì ‘ì†ì´ ëœë‹¤.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ubuntu@ec2 $ go &lt;span class="nb">test&lt;/span> -v
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">===&lt;/span> RUN &lt;span class="nv">TestSocket&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">===&lt;/span> RUN TestSocket/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2021/02/13 12:59:06 &lt;span class="nv">pong&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">===&lt;/span> RUN TestSocket/unix
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2021/02/13 12:59:06 pong
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--- PASS: TestSocket &lt;span class="o">(&lt;/span>0.00s&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --- PASS: TestSocket/tcp &lt;span class="o">(&lt;/span>0.00s&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --- PASS: TestSocket/unix &lt;span class="o">(&lt;/span>0.00s&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PASS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ok uds 0.004s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># serverê°€ ìƒì„±í•œ unix domain socketì— write ê¶Œí•œì´ ì—†ëŠ”&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># guest1ì´ë¼ëŠ” ì‚¬ìš©ìë¡œëŠ” serverì™€ unix domain socketìœ¼ë¡œëŠ” í†µì‹ í•  ìˆ˜ ì—†ê³ ,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ì•ì„œ ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ì´ìš©í•˜ë©° ê²ªì—ˆë˜ ì—ëŸ¬ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ê¶Œí•œ ì´ìŠˆê°€ ë°œìƒí•œë‹¤.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># í•˜ì§€ë§Œ TCP ì†Œì¼“ì„ ì´ìš©í•œ ê²½ìš°ëŠ” ì›í™œíˆ ping-pong testê°€ ì„±ê³µí•œ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">guest1@ec2 $ go &lt;span class="nb">test&lt;/span> -v
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">===&lt;/span> RUN &lt;span class="nv">TestSocket&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">===&lt;/span> RUN TestSocket/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2021/02/13 12:59:01 &lt;span class="nv">pong&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">===&lt;/span> RUN TestSocket/unix
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> main_test.go:21:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Error Trace: main_test.go:21
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Error: Received unexpected error:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dial unix jinsu.sock: connect: permission denied
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Test: TestSocket/unix
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--- FAIL: TestSocket &lt;span class="o">(&lt;/span>0.00s&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --- PASS: TestSocket/tcp &lt;span class="o">(&lt;/span>0.00s&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --- FAIL: TestSocket/unix &lt;span class="o">(&lt;/span>0.00s&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># í•˜ì§€ë§Œ ì¬ë¯¸ìˆê²Œë„ guest1ë„ socketì— writeí•  ìˆ˜ ìˆë„ë¡ ê¶Œí•œì„ ìˆ˜ì •í•´ì£¼ë‹ˆ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># guest1ë„ unix domain socketìœ¼ë¡œ ë¬´ë¦¬ ì—†ì´ í†µì‹ ì´ ê°€ëŠ¥í–ˆë‹¤!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">guest1@ec2 $ sudo chmod &lt;span class="m">777&lt;/span> jinsu.sock
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">guest1@ec2 $ go &lt;span class="nb">test&lt;/span> -v
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">===&lt;/span> RUN &lt;span class="nv">TestSocket&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">===&lt;/span> RUN TestSocket/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2021/02/13 12:59:06 &lt;span class="nv">pong&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">===&lt;/span> RUN TestSocket/unix
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2021/02/13 12:59:06 pong
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--- PASS: TestSocket &lt;span class="o">(&lt;/span>0.00s&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --- PASS: TestSocket/tcp &lt;span class="o">(&lt;/span>0.00s&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --- PASS: TestSocket/unix &lt;span class="o">(&lt;/span>0.00s&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PASS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ok uds 0.004s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ë”°ë¼ì„œ ubuntu ì‚¬ìš©ìë¡œ TCP socketê³¼ Unix domain socket ë‘ ê°€ì§€ ë°©ë²•ìœ¼ë¡œ ì„œë²„ ì—­í• ì„ í•  ìˆ˜ ìˆëŠ” í”„ë¡œì„¸ìŠ¤ë¥¼ ë„ìš´ ë’¤ ubuntu ì‚¬ìš©ìì™€ guest1 ì‚¬ìš©ìë¡œ í†µì‹  í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ë³´ì•˜ë‹¤.&lt;/p>
&lt;p>ì„œë²„ê°€ ìƒì„±í•œ unix domain socketì€ &lt;code>srwxrwxr-x&lt;/code> ì˜ í˜•ì‹ê³¼ ê¶Œí•œì„ ê°–ê³  ìˆê¸° ë•Œë¬¸ì— guest1ì€ ì´ ì†Œì¼“ì— ëŒ€í•´ readì™€ execute ê¶Œí•œ ë¿ì´ê³ , writeëŠ” ë¶ˆê°€ëŠ¥í•˜ê¸°ì— unix domain socketì„ ì´ìš©í•´ì„œëŠ” í†µì‹ í•  ìˆ˜ ì—†ë‹¤. ë”°ë¼ì„œ ìš°ë¦¬ê°€ í‰ì†Œì— ì˜¤í”ˆì†ŒìŠ¤ë¥¼ localhostì—ì„œ ì´ìš©í•˜ë©´ì„œ ì¢…ì¢… ë§ì´í–ˆë˜ ì†Œì¼“ì— ëŒ€í•œ permission errorì„ ë§Œë‚˜ë³¼ ìˆ˜ ìˆì—ˆë‹¤! ë°˜ë©´ socketì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œì´ í•„ìš” ì—†ëŠ” TCPë¡œëŠ” í†µì‹ ì´ ê°€ëŠ¥í–ˆê³ , ë†€ëê²Œë„ guest1ì—ê²Œ ì†Œì¼“ íŒŒì¼ì— ëŒ€í•œ write ê¶Œí•œì„ ë¶€ì—¬í•´ì£¼ì Unix domain socketìœ¼ë¡œë„ í†µì‹ ì´ ê°€ëŠ¥í•´ì§„ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p>
&lt;p>&lt;strong>ìƒìƒì˜ ë‚˜ë˜ ì •ë¦¬: unix domain socketì„ í†µí•´ ì ‘ì†ì„ ì‹œë„í•  ë•Œì—ëŠ” unix domain socket fileì— ëŒ€í•œ ì ‘ê·¼ì„ í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ê°€ í•´ë‹¹ socket fileì— ëŒ€í•œ ì ì ˆí•œ permissionì„ ê°–ê³  ìˆì–´ì•¼í•œë‹¤.&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>ë˜í•œ êµ¬ê¸€ë§ ë„ì¤‘ ë³´ì•˜ë˜ ì¬ë¯¸ìˆëŠ” ì˜ˆì‹œëŠ” databaseë¥¼ í†µí•´ authentication/authorizationì„ ìˆ˜í–‰í•˜ëŠ” ì¼ë°˜ì ì¸ ì„œë¹„ìŠ¤ì™€ ë‹¬ë¦¬ Unix domain socketì„ ì´ìš©í•˜ëŠ” ê²½ìš°ì—ëŠ” linux user ì‹œìŠ¤í…œì„ ì´ìš©í•´ì„œë„ ê¶Œí•œ/ì¸ì¦ ê´€ë¦¬ë¥¼ ìˆ˜í–‰í•˜ëŠ” ê²½ìš°ë„ ì¡´ì¬í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ì—ˆë‹¤.&lt;/p>
&lt;/blockquote>
&lt;h2 id="ë²¤ì¹˜ë§ˆí‚¹-unix-domain-socket-vs-network-socket">ë²¤ì¹˜ë§ˆí‚¹ Unix domain socket vs Network socket&lt;/h2>
&lt;p>Unix domain socketê³¼ Network socketì˜ ì„±ëŠ¥ì„ ë¹„êµí•˜ëŠ” ë²¤ì¹˜ë§ˆí¬ë¥¼ ì‘ì„±í–ˆë‹¤.
ë‘ ê²½ìš° ëª¨ë‘ Stream typeì˜ socketì„ ì´ìš©í•˜ë„ë¡ í–ˆê³ , Network socketì˜ ê²½ìš°ëŠ” íŠ¹íˆë‚˜ ì´ ê²½ìš° TCP í”„ë¡œí† ì½œì„ ì´ìš©í•˜ê²Œ ëœë‹¤.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// main.go
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// í•œ í”„ë¡œì„¸ìŠ¤ ë‚´ì—ì„œ TCP Socketê³¼ Unix Domain Socket ë‘ ê°€ì§€ë¥¼ ì´ìš©í•´
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// í†µì‹ í•  ìˆ˜ ìˆëŠ” í”„ë¡œê·¸ë¨
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;errors&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;io&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;log&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;net&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;os&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;time&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="nf">RunTCPSocketServer&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="nf">RunUnixDomainSocketServer&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Dummy waiting...&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Minute&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">RunTCPSocketServer&lt;/span>&lt;span class="p">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Run TCPSocketServer...&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;tcp&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;0.0.0.0:8080&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">RunUnixDomainSocketServer&lt;/span>&lt;span class="p">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Run UnixDomainSocketServer...&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">serverSocketName&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="s">&amp;#34;jinsu.sock&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Remove&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">serverSocketName&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;unix&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">serverSocketName&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// TCP socketì„ ì´ìš©í•´ ì„œë²„ë¥¼ ë„ìš°ë“  Unix Domain Socketì„ ì´ìš©í•´ ì„œë²„ë¥¼ ë„ìš°ë“ 
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ê°„ë‹¨íˆ ì¸ì ê°’ë§Œ ë³€ê²½í•´ì„œ ì´ìš©í•  ìˆ˜ ìˆë‹¤!
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">func&lt;/span> &lt;span class="nf">run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">network&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">address&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">buf&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="kt">byte&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1024&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">socket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">net&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Listen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">network&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">address&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Fatal&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">connectedSocket&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">socket&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Accept&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Fatal&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">n&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">connectedSocket&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Read&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">buf&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">!&lt;/span>&lt;span class="nx">errors&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Is&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">io&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">EOF&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Fatal&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;[Error]&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">network&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Client sent:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">n&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">connectedSocket&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Write&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="nb">byte&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;pong&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">connectedSocket&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// main_test.go
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// tcp socketê³¼ unix domain socketì„ ì´ìš©í•´ ì„±ê³µì ìœ¼ë¡œ ì„œë²„ì™€ í†µì‹ ì´
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ì´ë£¨ì–´ì§€ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// tcpì™€ unix domain socketì˜ ì„±ëŠ¥ì„ ë¹„êµí•˜ëŠ” ë²¤ì¹˜ë§ˆí¬ ì½”ë“œ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;errors&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;github.com/stretchr/testify/assert&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;io&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;log&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;net&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;testing&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">TestSocket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">T&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">args&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">[][]&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[]&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="s">&amp;#34;tcp&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;0.0.0.0:8080&amp;#34;&lt;/span>&lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[]&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="s">&amp;#34;unix&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;jinsu.sock&amp;#34;&lt;/span>&lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">arg&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">t&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arg&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">T&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">conn&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">net&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Dial&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arg&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="nx">arg&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">assert&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NoError&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">buf&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="kt">byte&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1024&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">conn&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Write&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="nb">byte&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;ping&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Fatal&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">n&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">conn&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Read&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">buf&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">!&lt;/span> &lt;span class="nx">errors&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Is&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">io&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">EOF&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">string&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">buf&lt;/span>&lt;span class="p">[:&lt;/span>&lt;span class="nx">n&lt;/span>&lt;span class="p">]))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">BenchmarkSocket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">args&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">[][]&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[]&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="s">&amp;#34;tcp&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;0.0.0.0:8080&amp;#34;&lt;/span>&lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[]&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="s">&amp;#34;unix&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;jinsu.sock&amp;#34;&lt;/span>&lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">arg&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arg&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//log.Println(&amp;#34;Out&amp;#34;) // b.Nê³¼ ìƒê´€ ì—†ì´ argsì˜ ê¸¸ì´ì— ë”°ë¼ ì¶œë ¥ë¨.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">conn&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">net&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Dial&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arg&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="nx">arg&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">assert&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NoError&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">buf&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="kt">byte&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1024&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">N&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//log.Println(&amp;#34;In&amp;#34;) // b.Në§Œí¼ ìˆ˜í–‰ë¨
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">conn&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Write&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="nb">byte&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;ping&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">assert&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NoError&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">conn&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Read&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">buf&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">!&lt;/span>&lt;span class="nx">errors&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Is&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">io&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">EOF&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Fail&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ go &lt;span class="nb">test&lt;/span> -bench&lt;span class="o">=&lt;/span>. -benchtime&lt;span class="o">=&lt;/span>100000x
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">goos: linux
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">goarch: amd64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pkg: uds
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">BenchmarkSocket/tcp 100000 &lt;span class="m">104537&lt;/span> ns/op
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">BenchmarkSocket/unix 100000 &lt;span class="m">83456&lt;/span> ns/op
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PASS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ok uds 18.808s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>10000ë²ˆì˜ ping-pongì„ ìˆ˜í–‰í•˜ëŠ” ë²¤ì¹˜ë§ˆí¬ë¥¼ ìˆ˜í–‰í–ˆë‹¤.
ê·¸ ê²°ê³¼ &lt;strong>TCP socketì„ ì´ìš©í•  ê²½ìš°ëŠ” í•œ ë²ˆì˜ ping-pongì— ì•½ 104537ns, unix domain socketì„ ì´ìš©í•  ê²½ìš°ëŠ” í•œ ë²ˆì˜ ping-pongì— ì•½ 83456ns&lt;/strong>ê°€ ì†Œìš”ëœ ê²ƒì„ ë³´ì•„ &lt;strong>ì˜ˆìƒëŒ€ë¡œ ë„¤íŠ¸ì›Œí¬ í†µì‹ ì´ ì¼ì ˆ í•„ìš”í•˜ì§€ ì•Šì€ unix domain socketì´ ì¢€ ë” ì„±ëŠ¥ì´ ì¢‹ì€ ê²ƒìœ¼ë¡œ ë³´ì—¬ì¡Œë‹¤&lt;/strong>. ì‚¬ì „ì— ìë£Œ ì¡°ì‚¬ë¥¼ í•  ë•Œì—ëŠ” unix domain socketì´ tcp socketì„ ì´ìš©í•  ë•Œë³´ë‹¤ ì•½ 2ë°°ê°€ëŸ‰ ì„±ëŠ¥ì´ ìš°ì›”í•  ê²ƒì´ë¼ê³  ë“¤ì—ˆëŠ”ë°, ê·¸ë ‡ê²Œ ë§ì€ ì°¨ì´ê°€ ë‚˜ëŠ” ê²ƒ ê°™ì§€ëŠ” ì•Šë‹¤. í•˜ì§€ë§Œ ì–´ëŠ ì •ë„ ë°ì´í„°ì˜ í¬ê¸°ë‚˜ ë²„í¼ì˜ í¬ê¸°ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ë„ ìˆì„ ê²ƒ ê°™ê³  ë” ê¹Šì€ ì›ë¦¬ë“¤ì´ ì¡´ì¬í•  ê²ƒ ê°™ì•„ ë” ìì„¸íˆëŠ” ì¸¡ì •í•´ë³´ì§€ ëª»í–ˆë‹¤.&lt;/p>
&lt;h2 id="ë§ˆì¹˜ë©°">ë§ˆì¹˜ë©°&lt;/h2>
&lt;p>ì‚¬ì‹¤ ì´ë²ˆì— ë‹¤ë£¬ ì†Œì¼“ì´ë¼ëŠ” ì£¼ì œëŠ” Goë¡œ ì ìš©í•´ë³´ëŠ” Computer Scienceë¼ëŠ” ì´ ì‹œë¦¬ì¦ˆë¥¼ ì •ë¦¬í•´ë‚˜ê°€ë˜ ì´ˆê¸°ì— 2ë²ˆ ì§¸ ê¸€ë¡œ ì‹œë„í–ˆë˜ ì£¼ì œì˜€ëŠ”ë° ë‹¹ì‹œì—” Go benchmarkë„ ì²˜ìŒ ì‚¬ìš©í•´ë´¤ì—ˆê³  ë‚´ìš©ì´ ì–´ë ¤ì› ë˜ í„°ë¼ ë²¤ì¹˜ë§ˆí¬ë„ ì œëŒ€ë¡œ ë˜ì§€ ì•Šê³  ì •ë¦¬ë„ í•˜ê¸° í˜ë“¤ì–´ì„œ ì¤‘ë‹¨í–ˆë˜ ì£¼ì œì´ë‹¤. í•˜ì§€ë§Œ ì´ë²ˆì—” ê°™ì€ ë‚´ìš©ì— ëŒ€í•´ ë‘ ë²ˆì§¸ ì •ë¦¬í•´ì„œì¸ì§€ ì „ë³´ë‹¤ ë‚´ìš©ë„ ì˜ ì´í•´ëê³ , ë²¤ì¹˜ë§ˆí‚¹ ì½”ë“œì™€ ê²°ê³¼ë„ ê¹”ë”í•˜ê²Œ ë‚˜ì™”ë˜ ê²ƒ ê°™ì•„ ë¿Œë“¯í•˜ë‹¤.&lt;/p>
&lt;p>ê·¸ë¦¬ê³  ê·¸ ë™ì•ˆ ë„ì»¤ë‚˜ MySQL ê°™ì€ ì˜¤í”ˆì†ŒìŠ¤ë“¤ì„ ì‚¬ìš©í•˜ë©´ì„œ ê°„í˜¹ ì†Œì¼“ì— ëŒ€í•œ ì˜¤ë¥˜ë¥¼ ì ‘í•  ë•Œë‚˜ ì´ëŸ° ì €ëŸ° ê¸€ì—ì„œ ì†Œì¼“ ê´€ë ¨í•œ ë‚´ìš©ì´ ë“±ì¥í•  ë•Œ ì •í™•íˆ ì–´ë–¤ ì—­í• ì¸ì§€ ì´ìœ ê°€ ë­”ì§€ ìì„¸íˆ ì•Œì§€ ëª»í–ˆëŠ”ë° ì´ë²ˆ ê¸°íšŒë•ì— ì•ìœ¼ë¡œëŠ” ì¢€ ë” ì˜ ì´í•´í•´ë³¼ ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.&lt;/p>
&lt;h2 id="ì°¸ê³ ">ì°¸ê³ &lt;/h2>
&lt;ul>
&lt;li>
&lt;p>ì†Œì¼“ &lt;a class="link" href="http://www.ktword.co.kr/abbr_view.php?nav=&amp;amp;m_temp1=280&amp;amp;id=742" target="_blank" rel="noopener"
>http://www.ktword.co.kr/abbr_view.php?nav=&amp;m_temp1=280&amp;id=742&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ë„¤íŠ¸ì›Œí¬ ì†Œì¼“ &lt;a class="link" href="https://ko.wikipedia.org/wiki/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC_%EC%86%8C%EC%BC%93" target="_blank" rel="noopener"
>https://ko.wikipedia.org/wiki/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC_%EC%86%8C%EC%BC%93&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ì†Œì¼“ í”„ë¡œê·¸ë˜ë° &lt;a class="link" href="https://recipes4dev.tistory.com/153" target="_blank" rel="noopener"
>https://recipes4dev.tistory.com/153&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>UDS (Unix Domain Socket) &lt;a class="link" href="http://www.dreamy.pe.kr/zbxe/CodeClip/119393" target="_blank" rel="noopener"
>http://www.dreamy.pe.kr/zbxe/CodeClip/119393&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>[Linux/UDS/Unix Domain Socket] UDS &lt;a class="link" href="https://yaaam.tistory.com/entry/LinuxUDSUnix-Domain-Socket-UDS" target="_blank" rel="noopener"
>https://yaaam.tistory.com/entry/LinuxUDSUnix-Domain-Socket-UDS&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Unix file type &lt;a class="link" href="https://en.wikipedia.org/wiki/Unix_file_types" target="_blank" rel="noopener"
>https://en.wikipedia.org/wiki/Unix_file_types&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>C# - .NET Core Unix Domain Socket ì‚¬ìš© ì˜ˆì œ &lt;a class="link" href="https://www.sysnet.pe.kr/2/0/11963" target="_blank" rel="noopener"
>https://www.sysnet.pe.kr/2/0/11963&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Unix Domain Socket &lt;a class="link" href="https://www.joinc.co.kr/w/Site/system_programing/IPC/Unix_Domain_Socket" target="_blank" rel="noopener"
>https://www.joinc.co.kr/w/Site/system_programing/IPC/Unix_Domain_Socket&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Unix Domain Socket - UDP &lt;a class="link" href="https://www.joinc.co.kr/w/Site/system_programing/IPC/Unix_Domain_Socket_UDP" target="_blank" rel="noopener"
>https://www.joinc.co.kr/w/Site/system_programing/IPC/Unix_Domain_Socket_UDP&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>What is the difference between Unix sockets and TCP/IP sockets? &lt;a class="link" href="https://serverfault.com/questions/124517/what-is-the-difference-between-unix-sockets-and-tcp-ip-sockets" target="_blank" rel="noopener"
>https://serverfault.com/questions/124517/what-is-the-difference-between-unix-sockets-and-tcp-ip-sockets&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul></description></item></channel></rss>