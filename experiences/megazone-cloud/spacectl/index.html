<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.80.0"><meta name=description content="spacectl이라는 CLI 프로그램 개발기"><meta name=author content="umi0410"><link rel=icon href=https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/google/241/whale_1f40b.png type=image/png><title>SpaceONE CLI Client인 spacectl 설계 및 개발 :: Jinsu Playground</title><link href=/css/nucleus.css?1610373812 rel=stylesheet><link href=/css/fontawesome-all.min.css?1610373812 rel=stylesheet><link href=/css/hybrid.css?1610373812 rel=stylesheet><link href=/css/featherlight.min.css?1610373812 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1610373812 rel=stylesheet><link href=/css/auto-complete.css?1610373812 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1610373812 rel=stylesheet><link href=/css/theme.css?1610373812 rel=stylesheet><link href=/css/hugo-theme.css?1610373812 rel=stylesheet><link href=/css/theme-umi0410-blue.css?1610373812 rel=stylesheet><link href=/css/custom-umi0410.css?1610373812 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1610373812></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style></head><body data-url=/experiences/megazone-cloud/spacectl/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=https://umi0410.github.io><span style=font-weight:700;font-size:20px>Jinsu Playground</span></a></div><div id=profile-wrapper><style>#sidebar-profile-message{text-align:left;word-break:keep-all}p{margin-top:0;margin-bottom:0;margin-left:10px;font-size:16px}</style><a href=/><img src=/media/profile.png style=width:170px;margin-top:15px></a><div id=sidebar-profile-message><b>박진수 (umi0410)</b></br><p>Golang, Cloud services, MSA, 컨테이너와 자동화, 깔끔한 아키텍쳐에 관심이 많습니다.</p></div></div></div><div class=highlightable><ul class=topics><li data-nav-id=/portfolio/ title="About Jinsu Park (umi0410)" class=dd-item><a href=/portfolio/>Portfolio</a></li><li data-nav-id=/experiences/ title=Experiences class="dd-item
parent"><a href=/experiences/>Experiences</a><ul><li data-nav-id=/experiences/megazone-cloud/ title="메가존 클라우드 데브옵스 인턴 후기" class="dd-item
parent"><a href=/experiences/megazone-cloud/><b></b>Megazone Cloud DevOps</a><ul><li data-nav-id=/experiences/megazone-cloud/stargate-infra/ title="Stargate라는 인프라 구축기" class=dd-item><a href=/experiences/megazone-cloud/stargate-infra/><b></b>인프라 구축기</a></li><li data-nav-id=/experiences/megazone-cloud/ci-cd-pipeline/ title="Github Action, Spinnaker을 이용한 CI/CD 파이프라인 구축기" class=dd-item><a href=/experiences/megazone-cloud/ci-cd-pipeline/><b></b>CI/CD 파이프라인</a></li><li data-nav-id=/experiences/megazone-cloud/argo-poc/ title="Argo Project들에 대한 PoC(개념 증명) 진행" class=dd-item><a href=/experiences/megazone-cloud/argo-poc/><b></b>Argo Project PoC</a></li><li data-nav-id=/experiences/megazone-cloud/spaceone-helm/ title="SpaceONE Helm Chart 개발" class=dd-item><a href=/experiences/megazone-cloud/spaceone-helm/><b></b>Helm Chart 개발</a></li><li data-nav-id=/experiences/megazone-cloud/spacectl/ title="SpaceONE CLI Client인 spacectl 설계 및 개발" class="dd-item active"><a href=/experiences/megazone-cloud/spacectl/><b></b>CLI Client 설계.개발</a></li></ul></li></ul></li><li data-nav-id=/blog/ title=Blog class=dd-item><a href=/blog/>Blog</a><ul><li data-nav-id=/blog/aws/ title="Category: AWS" class=dd-item><a href=/blog/aws/>AWS</a><ul><li data-nav-id=/blog/aws/aws_eks_elb/ title="EKS K8s에서 ELB(ALB, NLB) 제대로 설정하며 사용하기" class=dd-item><a href=/blog/aws/aws_eks_elb/>EKS K8s에서 ELB(ALB, NLB) 제대로 설정하며 사용하기</a></li></ul></li><li data-nav-id=/blog/golang/ title=Golang class=dd-item><a href=/blog/golang/>Golang</a><ul><li data-nav-id=/blog/golang/go-vs-java-oop/ title="Go vs Java - Go에서의 객체 지향" class=dd-item><a href=/blog/golang/go-vs-java-oop/><b></b>Go vs Java - Go에서의 객체 지향</a></li><li data-nav-id=/blog/golang/golang-concurrent-pattern-pipeline/ title="Go의 Pipeline pattern. 언제 사용해야할까? - Golang concurrent patterns" class=dd-item><a href=/blog/golang/golang-concurrent-pattern-pipeline/><b></b>Go의 Pipeline pattern. 언제 사용해야할까?</a></li></ul></li></ul></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://github.com/umi0410><i class="fab fa-github"></i>Github</a></li></ul></section><section id=footer><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a>from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/umi0410/umi0410.github.io/edit/master/content/experiences/megazone-cloud/spacectl.md target=blank><i class="fas fa-code-branch"></i><span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/>About Jinsu Park (umi0410)</a> > <a href=/experiences/>Experiences</a> > <a href=/experiences/megazone-cloud/>메가존 클라우드 데브옵스 인턴 후기</a> > SpaceONE CLI Client인 spacectl 설계 및 개발</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#spacectl이란>spacectl이란?</a><ul><li><a href=#소개>소개</a></li><li><a href=#사용-예시>사용 예시</a></li></ul></li><li><a href=#설계를-하며-느낀-점>설계를 하며 느낀 점</a></li><li><a href=#개발하면서-느낀-점>개발하면서 느낀 점</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>SpaceONE CLI Client인 spacectl 설계 및 개발</h1><div class=wrapper><hr style=margin-top:20px;margin-bottom:20px></hr><b>Table of Contents</b><nav id=TableOfContents><ul><li><a href=#spacectl이란>spacectl이란?</a><ul><li><a href=#소개>소개</a></li><li><a href=#사용-예시>사용 예시</a></li></ul></li><li><a href=#설계를-하며-느낀-점>설계를 하며 느낀 점</a></li><li><a href=#개발하면서-느낀-점>개발하면서 느낀 점</a></li></ul></nav><hr style=margin-top:0;margin-bottom:0></hr></div><h2 id=spacectl이란>spacectl이란?</h2><h3 id=소개>소개</h3><p><a href=https://github.com/spaceone-dev/spacectl>spacectl</a> 은 저희팀이 개발하는 서비스인 SpaceONE의 <code>gRPC</code> API request를 CLI로
손쉽게 수행할 수 있도록 해주는 도구입니다. 파이썬을 통해 개발했고 <code>Click</code> 이라는 모듈로 CLI 환경을
손쉽게 사용할 수 있었고, <code>Jinja2</code>를 통해 상세한 Manifest 들에서 변수 치환, 분기 등을 수행할 수 있었습니다.</p><h3 id=사용-예시>사용 예시</h3><h4 id=a-simple-example>A simple example</h4><p>간단하게 <code>spacectl</code>이 어떤 식으로 이용되는 도구인지 예시를 보여드리겠습니다.
아래의 커맨드를 이용해 손쉽게 <code>SpaceONE</code>의 다양한 마이크로서비스들의 API를 이용할
수 있습니다.</p><pre><code>$ spacectl list domain
 domain_id           | name   | state   | plugin_id  ...
 domain-abc123abc    | umi0410| ENABLED |            ...
$ spacectl list server -p domain_id=domain-abc123abc
 server_id         | name    | provider ...
 server-abc123abc  | foo     | aws ...
</code></pre><h4 id=apply-command>apply command</h4><p><code>spacectl apply</code> command는 kubectl의 apply와 유사하게 없으면 만들고,
있으면 업데이트하고 혹은 단순히 어떤 API를 Execute하는 Task들의 플로우를 관리해주는
커맨드 입니다.</p><blockquote><p>아쉽게도 퇴사 전에 마무리를 짓지는 못했습니다. ㅜ.ㅜ
퇴사 전까지 진행한 작업은 일부 리소스에 대한 CRU(create, read, update),
대부분의 리소스에 대한 Excute(execute할 API를 설정)까지입니다.</p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#75715e># main.yaml</span>
<span style=color:#f92672>import</span>:
  - <span style=color:#ae81ff>mongo.yaml</span> <span style=color:#75715e># 개별 yaml file에서는 terraform/ansible과 같이 수행할 Task들을 정의</span>
  - <span style=color:#ae81ff>root_domain.yaml</span>
  - <span style=color:#ae81ff>repository.yaml</span>

<span style=color:#f92672>var</span>:
  <span style=color:#f92672>domain_name</span>: <span style=color:#ae81ff>root</span>
  <span style=color:#f92672>domain_owner</span>: <span style=color:#ae81ff>admin</span>
  <span style=color:#f92672>admin_username</span>: <span style=color:#ae81ff>admin</span>
  <span style=color:#f92672>admin_password</span>: <span style=color:#ae81ff>admin</span>

<span style=color:#ae81ff>$ spacectl apply main.yaml</span>
</code></pre></div><h2 id=설계를-하며-느낀-점>설계를 하며 느낀 점</h2><p>이 프로젝트에 대한 실제 개발 업무 이전에는 꽤나 설계 업무가 많았습니다.
저는 그 동안은 혼자 주로 개발을 해왔고, 실행력 좋게 시작은 하지만 설계는 충분하지 않은 채
성급하게 실행에 옮겼던 경험이 많습니다. 또한 학생이었고, 개발 경력이 길지 않았기에
사실상 &ldquo;개발 = 그때 그때 새로운 내용 공부"와 같은 느낌이었기에 애초에 설계를 하려해도 <em>&lsquo;뭐가
필요하고 뭐가 가능할 것이고 뭐가 힘들 것인가&rsquo;</em> 를 판단하기 어려웠습니다.</p><p>하지만 팀원들과 함께 개발하면서 밥 먹을 때, 회의 할 때 틈틈히 설계 방식과 요령에 대해
상의했고, 처음으로 설계를 어느 정도 굳힌 뒤 개발에 들어들어갔던 경험이었습니다.</p><p>인턴 기간 막바지에 이 설계에 참여하게 된 것은 정말 값진 경험이었다고 생각했습니다.
사실 단순히 데브옵스로서 일할 때는 남들과 의사소통할 일이 그리 많진 않았는데, 이 설계를
맡게 되면서 많은 회의와 대화를 하게되었습니다.
선배 개발자분들과 설계에 대해 잦은 회의를 하면서 제가 <strong>어떤 개발자가 되고싶은지</strong> 직접 느낄 수 있었던 것 같습니다.
그 배경에는 두 가지 충격이 있었습니다.</p><ol><li><em>&lsquo;내가 남의 생각을 잘 읽는 편은 아니었나보군&mldr;?'</em></li><li><em>&lsquo;선배 개발자분은 내가 개판으로 설명해도 어떻게 귀신같이 나보다 내 생각을 잘 읽으시지?'</em>
=> 마치 축구할 때 노련한 축구선수와 함께 뛰면서 저 행동을 귀신같이 예측하고서는 너무나도 잘 밀어주는 느낌을 받았습니다&mldr;</li></ol><p>제가 평소에 말을 잘하는 편이라고 생각했는데, 남의 생각을 이해하고 읽어내는 능력은 그리 뛰어나지많은
않구나라는 생각을 하게됐습니다. 설계 내용이 꽤나 추상적으로 구두로 진행되었기에 그랬을 수도 있겠지만,
큰 충격은 선배 개발자분의 <strong>노련함</strong>이었습니다.</p><p>후에 누군가 어떤 개발자가 되고싶냐, 협업할 때 어떤 노하우가 있느냐 이런 내용을 물어보면
자신있게 <strong>남의 생각을 잘 이해하고, 알아주는 사람</strong>과 관련해 대답할 수 있는 사람이 될 수 있었으면
좋겠습니다.</p><p>또한 설계 깊게 진행하기 전에 침착하게 자료 조사를
잘 해야한다는 것을 느꼈습니다.</p><p>하나 일화로 원래는 설정 파일에서 <code>${{ tasks.umi0410.output }}</code> 이런 식의 변수를 이용한
설정을 치환한 뒤 API를 수행해야할 때, 아마 template 언어들을 제가 원하는 대로 사용하기
힘들 것이라 생각하고, 하나하나 함수와 클래스를 만들어가곤했는데, 개발이 거의 완료되어갈쯤
<code>Jinja2</code>의 사용법을 다시 읽다보니 <code>spacectl</code>에 <code>Jinja2</code>를 적절히 사용할 수 있을 것 같았고,
정신이 번뜩 들어 몇 시간만에 수작업으로 짠 코드들을 덜어내고 Jinja2를 이용해 좀 더 깔끔하게
변수 치환 및 추가로 <code>Jinja2</code>의 built-in filter들을 이용할 수 있었습니다!</p><h2 id=개발하면서-느낀-점>개발하면서 느낀 점</h2><p>역시 개발은 남이 만든 패키지를 잘 사용해야한다는 것을 느꼈고, 그냥 복사 붙여넣기만 잘하면 된다는 의미가 아니라,
그런 것들을 빠르게 가져와서 적용시키고 부분 부분 커스터마이징하기 위해서는
기본기가 탄탄해야한다고 느꼈습니다. 물론 수작업으로 만드는 것도 좋을 수 있겠지만, 다양한 엣지케이스가 존재할 수 있고,
그 모든 작업들을 문서로 상세히 설명하는 것이 아니라면, 제작자인 제가 아닌 누군가가 그 기능을 이용하기는
힘들 것입니다. Jinja2를 이용한 템플릿 기능 제공이 이와 관련된 경험이 될 수 있겠습니다.</p><p>또한 남의 코드를 자세히 읽어보는 게 처음이었는데, 덕분에 파이썬 프로젝트를 수행할 때 어떤 식으로
디렉토리 스트럭쳐를 짜면 좋을 지 생각해볼 수 있었던 계기였던 것 같습니다.
제가 설계하고, 개발한 내용을 짧게나마 발표한 뒤 리뷰를 받고 수정을 하면 한층 더 코드의
구조와 사용이 간결하고 직관적으로 보인다는 느낌을 받을 수 있었습니다. 이렇게 다양한
가르침을 주신 <strong>저희 팀의 선배 개발자분들께 항상 감사드립니다.</strong></p><div class="notices info"><p>Megazone CloudOne 팀의 DevOps 인턴으로서 근무했던 내용에 대한 후기가 거의 끝났습니다.
끝으로 인턴 활동에 대한 종합적인 느낀점을 이어서 보시거나 다시 목차를 보고싶으신 분은 <a href=../>여기</a>를
클릭해주세요.</p></div><footer class=footline></footer></div><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"umi0410"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><div id=navigation><a class="nav nav-prev" href=/experiences/megazone-cloud/spaceone-helm/ title="SpaceONE Helm Chart 개발"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=/blog/ title=Blog style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1610373812></script><script src=/js/perfect-scrollbar.min.js?1610373812></script><script src=/js/perfect-scrollbar.jquery.min.js?1610373812></script><script src=/js/jquery.sticky.js?1610373812></script><script src=/js/featherlight.min.js?1610373812></script><script src=/js/highlight.pack.js?1610373812></script><script>hljs.initHighlightingOnLoad();</script><script src=/js/modernizr.custom-3.6.0.js?1610373812></script><script src=/js/learn.js?1610373812></script><script src=/js/hugo-learn.js?1610373812></script><script src=/mermaid/mermaid.js?1610373812></script><script>mermaid.initialize({startOnLoad:true});</script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-177403492-1','auto');ga('send','pageview');}</script></body></html>